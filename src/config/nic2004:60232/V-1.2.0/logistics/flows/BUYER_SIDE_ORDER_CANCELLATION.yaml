meta:
  domain: 'nic2004:60232'
  version: 1.2.0
  flowId: BUYER_SIDE_ORDER_CANCELLATION
transaction_data:
  transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
  latest_timestamp: '1970-01-01T00:00:00.000Z'
  bap_id: bap.example.com
  bap_uri: 'https://bap.example.com'
  bpp_id: bpp.example.com
  bpp_uri: 'https://bpp.example.com'
steps:
  - api: search
    action_id: search_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBjb25zdCBpbnB1dHMgPSBzZXNzaW9uRGF0YS51c2VyX2lucHV0czsKICBjb25zdCBUYXRNYXBwaW5nID0gewogICAgIkltbWVkaWF0ZSBEZWxpdmVyeSI6IHsKICAgICAgY29kZTogIlBUNjBNIiwKICAgICAgZGF5OiAwLAogICAgICBwaWNrdXBUaW1lOiAiUFQxNU0iLAogICAgICBvcmRlclByZXBUaW1lOiAiUFQxME0iLAogICAgfSwKICAgICJTYW1lIERheSBEZWxpdmVyeSI6IHsKICAgICAgY29kZTogIlBUNEgiLAogICAgICBkYXk6IDAsCiAgICAgIHBpY2t1cFRpbWU6ICJQVDFIIiwKICAgICAgb3JkZXJQcmVwVGltZTogIlBUMUgiLAogICAgfSwKICAgICJOZXh0IERheSBEZWxpdmVyeSI6IHsKICAgICAgY29kZTogIlAxRCIsCiAgICAgIGRheTogMSwKICAgICAgcGlja3VwVGltZTogIlBUNEgiLAogICAgICBvcmRlclByZXBUaW1lOiAiUFQ0SCIsCiAgICB9LAogICAgIlN0YW5kYXJkIERlbGl2ZXJ5IjogewogICAgICBjb2RlOiAiUDJEIiwKICAgICAgZGF5OiAyLAogICAgICBwaWNrdXBUaW1lOiAiUFQxMkgiLAogICAgICBvcmRlclByZXBUaW1lOiAiUFQxMkgiLAogICAgfSwKICAgICJFeHByZXNzIERlbGl2ZXJ5IjogewogICAgICBjb2RlOiAiUDNEIiwKICAgICAgZGF5OiAyLAogICAgICBwaWNrdXBUaW1lOiAiUDFEIiwKICAgICAgb3JkZXJQcmVwVGltZTogIlAxRCIsCiAgICB9LAogICAgIkluc3RhbnQgRGVsaXZlcnkiOiB7CiAgICAgIGNvZGU6ICJQVDEwTSIsCiAgICAgIGRheTogMCwKICAgICAgcGlja3VwVGltZTogIlBUMk0iLAogICAgICBvcmRlclByZXBUaW1lOiAiUFQyTSIsCiAgICB9LAogIH07CiAgY29uc29sZS5sb2coImluc2lkZSBzZWFyY2ggZ2VuZXJhdG9yIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEuY2F0ZWdvcnkpKTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5pbnRlbnQucHJvdmlkZXIudGltZS5zY2hlZHVsZS5ob2xpZGF5cyA9IFsKICAgIGdldEZ1dHVyZURhdGUoMTApLAogICAgZ2V0RnV0dXJlRGF0ZSgxNSksCiAgXTsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSBpbnB1dHMuY2l0eV9jb2RlOwoKCiAgaWYgKGlucHV0cz8uY2F0ZWdvcnkpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LmNhdGVnb3J5LmlkID0gaW5wdXRzLmNhdGVnb3J5OwogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5pbnRlbnQucGF5bWVudC50eXBlID0gaW5wdXRzLnBheW1lbnRUeXBlOwoKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LnByb3ZpZGVyLnRpbWUuZHVyYXRpb24gPQogICAgICBUYXRNYXBwaW5nW2lucHV0cz8uY2F0ZWdvcnldLm9yZGVyUHJlcFRpbWU7CiAgfQoKICBjb25zdCBkZWxpdmVyeUZ1bGZpbGxtZW50ID0gewogICAgdHlwZTogIkRlbGl2ZXJ5IiwKICAgIHN0YXJ0OiB7CiAgICAgIGxvY2F0aW9uOiB7CiAgICAgICAgZ3BzOiBpbnB1dHMuc3RhcnRfZ3BzLAogICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgIGFyZWFfY29kZTogaW5wdXRzLnN0YXJ0X2NvZGUKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBlbmQ6IHsKICAgICAgbG9jYXRpb246IHsKICAgICAgICBncHM6IGlucHV0cy5lbmRfZ3BzLAogICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgIGFyZWFfY29kZTogaW5wdXRzLmVuZF9jb2RlCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LmZ1bGZpbGxtZW50ID0gZGVsaXZlcnlGdWxmaWxsbWVudDsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5pbnRlbnRbIkBvbmRjL29yZy9wYXlsb2FkX2RldGFpbHMiXS5jYXRlZ29yeSA9CiAgICBpbnB1dHM/LnJldGFpbENhdGVnb3J5IHx8ICJHcm9jZXJ5IjsKCiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: search
          core_version: 1.2.0
          bap_id: biz.test.bitsila.com
          bap_uri: 'https://biz.test.bitsila.com/ecc/ondc/logistics-bap'
          transaction_id: LOG-3849-1001-1179-M7K1
          message_id: 7667caff-182a-41b7-bda9-d7bca33dd98f
          timestamp: '2024-04-08T11:53:11.349Z'
          ttl: PT30S
        message:
          intent:
            category:
              id: Immediate Delivery
            payment:
              type: ON-ORDER
            '@ondc/org/payload_details':
              weight:
                unit: kilogram
                value: 1
              value:
                currency: INR
                value: '388.5'
              dimensions:
                length:
                  unit: meter
                  value: 0.1
                breadth:
                  unit: meter
                  value: 0.1
                height:
                  unit: meter
                  value: 0.1
              category: F&B
            fulfillment:
              type: Delivery
              start:
                location:
                  id: '3849:4120'
                  gps: '12.916691283211073, 77.64782934951943'
                  address:
                    area_code: '560102'
              end:
                location:
                  gps: '12.9180305, 77.6372603'
                  address:
                    area_code: '560102'
            provider:
              time:
                days: '1,2,3,4,5,6,7'
                range:
                  start: '0700'
                  end: '2355'
                schedule:
                  holidays: []
                duration: PT15M
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        category_id: $.message.intent.category.id
        start_location: $.message.intent.fulfillment.start.location.gps
        start_area_code: $.message.intent.fulfillment.start.location.address.area_code
        end_location: $.message.intent.fulfillment.end.location.gps
        end_area_code: $.message.intent.fulfillment.end.location.address.area_code
        payment_type: $.message.intent.payment.type
        city_code: $.context.city
        fulfillment: $.message.intent.fulfillment
        retail_category: '$.message.intent[''@ondc/org/payload_details''].category'
      inputs:
        id: LogisticsSearchInput
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            retailCategory:
              type: string
              description: Select retail item category
              enum:
                - F&B
                - Grocery
                - Fashion
                - BPC
                - Electronics
                - Appliances
                - Home & Kitchen
                - Health & Wellness
                - Pharma
                - Auto components
                - C2C parcels
              default: F&B
            category:
              type: string
              description: Select a delivery category
              enum:
                - Immediate Delivery
                - Standard Delivery
                - Express Delivery
                - Next Day Delivery
                - Same Day Delivery
              default: Immediate Delivery
            paymentType:
              type: string
              description: Select payment type
              enum:
                - POST-FULFILLMENT
                - ON-ORDER
                - ON-FULFILLMENT
              default: POST-FULFILLMENT
            city_code:
              type: string
              description: City STD code
              pattern: '^std:\d+$'
              default: 'std:080'
            start_gps:
              type: string
              description: 'Start GPS coordinates (lat,long)'
              pattern: >-
                ^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$
              default: '12.4535,77.9283'
            end_gps:
              type: string
              description: 'End GPS coordinates (lat,long)'
              pattern: >-
                ^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$
              default: '12.4535,77.9283'
            start_code:
              type: string
              description: Start area pincode
              pattern: '^\d{6}$'
              default: '560001'
            end_code:
              type: string
              description: End area pincode
              pattern: '^\d{6}$'
              default: '560001'
          required:
            - retailCategory
            - category
            - paymentType
            - city_code
            - start_gps
            - end_gps
            - start_code
            - end_code
          additionalProperties: false
  - api: on_search
    action_id: on_search_1
    owner: BPP
    responseFor: search_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBjb25zdCBUYXRNYXBwaW5nID0gewogICAgIkltbWVkaWF0ZSBEZWxpdmVyeSI6IHsgY29kZTogIlBUNjBNIiwgZGF5OiAwLCBwaWNrdXBUaW1lOiAiUFQxNU0iIH0sCiAgICAiU2FtZSBEYXkgRGVsaXZlcnkiOiB7IGNvZGU6ICJQVDRIIiwgZGF5OiAwLCBwaWNrdXBUaW1lOiAiUFQxSCIgfSwKICAgICJOZXh0IERheSBEZWxpdmVyeSI6IHsgY29kZTogIlAxRCIsIGRheTogMSwgcGlja3VwVGltZTogIlBUNEgiIH0sCiAgICAiU3RhbmRhcmQgRGVsaXZlcnkiOiB7IGNvZGU6ICJQMkQiLCBkYXk6IDIsIHBpY2t1cFRpbWU6ICJQVDEySCIgfSwKICAgICJFeHByZXNzIERlbGl2ZXJ5IjogeyBjb2RlOiAiUDNEIiwgZGF5OiAzLCBwaWNrdXBUaW1lOiAiUDFEIiB9LAogICAgIkluc3RhbnQgRGVsaXZlcnkiOiB7IGNvZGU6ICJQVDEwTSIsIGRheTogMCwgcGlja3VwVGltZTogIlBUMk0iIH0sCiAgfTsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0Lm1lc3NhZ2VfaWQgPSBzZXNzaW9uRGF0YS5sYXRlc3RNZXNzYWdlX2lkWzBdOwogIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQuY2l0eSA9IHNlc3Npb25EYXRhLmNpdHlfY29kZVswXTsKCiAgY29uc29sZS5sb2coImNhdGVnb3J5X2lkIiwgc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdKQoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmNhdGFsb2dbImJwcC9kZXNjcmlwdG9yIl0udGFnc1swXS5saXN0ID0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZ1siYnBwL2Rlc2NyaXB0b3IiXS50YWdzWzBdLmxpc3QubWFwKAogICAgICAoaXRlbSkgPT4gewogICAgICAgIGlmIChpdGVtLmNvZGUgPT09ICJlZmZlY3RpdmVfZGF0ZSIpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSwKICAgICAgICAgICAgdmFsdWU6IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wLAogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBpdGVtOwogICAgICB9CiAgICApOwoKICBjb25zdCBjYXRlZ29yaWVzRGF0YSA9IHsKICAgIGlkOiBzZXNzaW9uRGF0YS5jYXRlZ29yeV9pZFswXSwKICAgIHRpbWU6IHsKICAgICAgbGFiZWw6ICJUQVQiLAogICAgICBkdXJhdGlvbjogVGF0TWFwcGluZ1tzZXNzaW9uRGF0YT8uY2F0ZWdvcnlfaWRbMF1dLmNvZGUsCiAgICAgIHRpbWVzdGFtcDogZ2V0RnV0dXJlRGF0ZSgKICAgICAgICBUYXRNYXBwaW5nW3Nlc3Npb25EYXRhPy5jYXRlZ29yeV9pZFswXV0uZGF5CiAgICAgICksCiAgICB9LAogIH07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYXRhbG9nWyJicHAvcHJvdmlkZXJzIl1bMF0uY2F0ZWdvcmllc1swXSA9CiAgICBjYXRlZ29yaWVzRGF0YTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYXRhbG9nWyJicHAvcHJvdmlkZXJzIl1bMF0uaXRlbXMgPQogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYXRhbG9nWyJicHAvcHJvdmlkZXJzIl1bMF0uaXRlbXMubWFwKAogICAgICAoaXRlbSkgPT4gewogICAgICAgIGNvbnN0IGRlbGl2ZXJ5RnVsZmlsbG1lbnQgPQogICAgICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYXRhbG9nPy5bImJwcC9wcm92aWRlcnMiXT8uWzBdPy5mdWxmaWxsbWVudHM/LmZpbmQoCiAgICAgICAgICAgIChmdWxmaWxsbWVudCkgPT4gZnVsZmlsbG1lbnQudHlwZSA9PT0gIkRlbGl2ZXJ5IgogICAgICAgICAgKSB8fCBudWxsOwogICAgICAgIGlmICgKICAgICAgICAgIEFycmF5LmlzQXJyYXkoc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWQpICYmCiAgICAgICAgICBzZXNzaW9uRGF0YS5jYXRlZ29yeV9pZFswXSA9PT0gIlN0YW5kYXJkIERlbGl2ZXJ5IiAmJgogICAgICAgICAgZGVsaXZlcnlGdWxmaWxsbWVudCAmJgogICAgICAgICAgaXRlbS5mdWxmaWxsbWVudF9pZCA9PT0gZGVsaXZlcnlGdWxmaWxsbWVudC5pZAogICAgICAgICkgewogICAgICAgICAgaXRlbS5kZXNjcmlwdG9yID0gaXRlbS5kZXNjcmlwdG9yIHx8IHt9OwogICAgICAgICAgaXRlbS5kZXNjcmlwdG9yLmNvZGUgPSAiUDJIMlAiOwogICAgICAgIH0KICAgICAgICBpdGVtLmNhdGVnb3J5X2lkID0gc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWRbMF07CiAgICAgICAgaXRlbS50aW1lID0gewogICAgICAgICAgbGFiZWw6ICJUQVQiLAogICAgICAgICAgZHVyYXRpb246IFRhdE1hcHBpbmdbc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWRdLmNvZGUsCiAgICAgICAgICB0aW1lc3RhbXA6IGdldEZ1dHVyZURhdGUoCiAgICAgICAgICAgIFRhdE1hcHBpbmdbc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWRdLmRheQogICAgICAgICAgKSwKICAgICAgICB9OwoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfQogICAgKTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYXRhbG9nWyJicHAvcHJvdmlkZXJzIl1bMF0uZnVsZmlsbG1lbnRzID0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZ1siYnBwL3Byb3ZpZGVycyJdWzBdLmZ1bGZpbGxtZW50cy5tYXAoCiAgICAgIChmdWxmaWxsbWVudCkgPT4gewogICAgICAgIGlmIChmdWxmaWxsbWVudC50eXBlID09PSAiRGVsaXZlcnkiIHx8IGZ1bGZpbGxtZW50LnR5cGUgPT09ICJSZXR1cm4iKSB7CiAgICAgICAgICBpZiAoc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdID09PSAiU3RhbmRhcmQgRGVsaXZlcnkiIHx8IHNlc3Npb25EYXRhPy5jYXRlZ29yeV9pZFswXSA9PT0gIk5leHQgRGF5IERlbGl2ZXJ5IiB8fCBzZXNzaW9uRGF0YT8uY2F0ZWdvcnlfaWRbMF0gPT09ICJFeHByZXNzIERlbGl2ZXJ5IiB8fCBzZXNzaW9uRGF0YT8uY2F0ZWdvcnlfaWRbMF0gPT09ICJTYW1lIERheSBEZWxpdmVyeSIpIHsKICAgICAgICAgICAgcmVtb3ZlVGFnc0J5Q29kZXMoZnVsZmlsbG1lbnQudGFncywgWyJkaXN0YW5jZSJdKTsKICAgICAgICAgICAgaWYgKGZ1bGZpbGxtZW50LnRhZ3MubGVuZ3RoIDwgMSkgZGVsZXRlIGZ1bGZpbGxtZW50LnRhZ3M7CiAgICAgICAgICB9CiAgICAgICAgICBmdWxmaWxsbWVudC5zdGFydC50aW1lLmR1cmF0aW9uID0KICAgICAgICAgICAgVGF0TWFwcGluZ1tzZXNzaW9uRGF0YS5jYXRlZ29yeV9pZF0ucGlja3VwVGltZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmdWxmaWxsbWVudDsKICAgICAgfQogICAgKTsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cgp9Cg==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: on_search
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M1
          timestamp: '2026-02-06T21:00:30.000Z'
        message:
          catalog:
            bpp/descriptor:
              name: LSP Aggregator Inc
              tags:
                - code: bpp_terms
                  list:
                    - code: static_terms
                      value: ''
                    - code: static_terms_new
                      value: >-
                        https://github.com/ONDC-Official/NP-Static-Terms/lspNP_LSP/1.0/tc.pdf
                    - code: effective_date
                      value: '2023-10-01T00:00:00.000Z'
            bpp/providers:
              - id: P1
                descriptor:
                  name: LSP Courier Inc
                  short_desc: LSP Courier Inc
                  long_desc: LSP Courier Inc
                categories:
                  - id: Immediate Delivery
                    time:
                      label: TAT
                      duration: PT60M
                      timestamp: '2023-06-06'
                fulfillments:
                  - id: '1'
                    type: Delivery
                    start:
                      time:
                        duration: PT15M
                    tags:
                      - code: distance
                        list:
                          - code: motorable_distance_type
                            value: kilometer
                          - code: motorable_distance
                            value: '1.8'
                  - id: '2'
                    type: RTO
                locations:
                  - id: L1
                    gps: '12.967555,77.749666'
                    address:
                      street: Jayanagar 4th Block
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                items:
                  - id: I1
                    parent_item_id: ''
                    category_id: Immediate Delivery
                    fulfillment_id: '1'
                    descriptor:
                      code: P2P
                      name: Fast delivery
                      short_desc: Fast delivery
                      long_desc: Fast delivery
                    price:
                      currency: INR
                      value: '59.00'
                    time:
                      label: TAT
                      duration: PT45M
                      timestamp: '2023-06-06'
                  - id: I2
                    parent_item_id: I1
                    category_id: Immediate Delivery
                    fulfillment_id: '2'
                    descriptor:
                      code: P2P
                      name: RTO quote
                      short_desc: RTO quote
                      long_desc: RTO quote
                    price:
                      currency: INR
                      value: '23.60'
                    time:
                      label: TAT
                      duration: PT60M
                      timestamp: '2023-06-06'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_search_providers: '$.message.catalog[''bpp/providers'']'
        on_search_locations: '$.message.catalog[''bpp/providers''][0].locations'
        on_search_fulfillments: '$.message.catalog[''bpp/providers''][0].fulfillments'
        on_search_items: '$.message.catalog[''bpp/providers''][0].items'
        provider_id: '$.message.catalog[''bpp/providers''][0].id'
        location_id: '$.message.catalog[''bpp/providers''][0].locations[0].id'
      inputs: {}
  - api: init
    action_id: init_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSBzZXNzaW9uRGF0YS5jaXR5X2NvZGVbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLm9uX3NlYXJjaF9wcm92aWRlcnNbMF1bMF0uaWQ7CiAgY29uc3QgZ2V0UGF5ZW1udEZpZWxkcyA9IChwYXltZW50VHlwZSkgPT4gewogICAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tT1JERVIiIHx8IHBheW1lbnRUeXBlID09PSAiT04tRlVMRklMTE1FTlQiKSB7CiAgICAgIHJldHVybiB7IGNvbGxlY3RlZF9ieTogIkJQUCIgfTsKICAgIH0KCiAgICBpZiAocGF5bWVudFR5cGUgPT09ICJQT1NULUZVTEZJTExNRU5UIikgewogICAgICByZXR1cm4gewogICAgICAgIGNvbGxlY3RlZF9ieTogIkJBUCIsCiAgICAgICAgIkBvbmRjL29yZy9zZXR0bGVtZW50X2Jhc2lzIjogImludm9pY2luZyIsCiAgICAgICAgIkBvbmRjL29yZy9zZXR0bGVtZW50X3dpbmRvdyI6ICJQMTVEIiwKICAgICAgfTsKICAgIH0KICB9OwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIubG9jYXRpb25zWzBdLmlkID0KICAgIHNlc3Npb25EYXRhLm9uX3NlYXJjaF9sb2NhdGlvbnNbMF1bMF0uaWQ7CiAgY29uc29sZS5sb2coIm9uIHNlYXJjaCBsb2NhdGlvbnMiLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uRGF0YS5vbl9zZWFyY2hfbG9jYXRpb25zKSk7CgogIGNvbnNvbGUubG9nKCJzZXNzaW9uIGRhdGEgb25fc2VhcmNoIGl0ZW1zIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEub25fc2VhcmNoX2l0ZW1zKSk7CgoKICAvLyBCdWlsZCBTVEFSVCBvYmplY3QKICBsZXQgc3RhcnRPYmogPSB7CiAgICBsb2NhdGlvbjogewogICAgICBpZDogIlMxIiwKICAgICAgZ3BzOiBzZXNzaW9uRGF0YS5zdGFydF9sb2NhdGlvblswXSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICJNeSBzdG9yZSBuYW1lIDEiLAogICAgICAgIGJ1aWxkaW5nOiAiTXkgYnVpbGRpbmcgbmFtZSAxIiwKICAgICAgICBsb2NhbGl0eTogIk15IHN0cmVldCBuYW1lIDEiLAogICAgICAgIGNpdHk6ICJteSBjaXR5IDEiLAogICAgICAgIHN0YXRlOiAibXkgc3RhdGUgMSIsCiAgICAgICAgY291bnRyeTogIkluZGlhIiwKICAgICAgICBhcmVhX2NvZGU6IHNlc3Npb25EYXRhLnN0YXJ0X2FyZWFfY29kZVswXSwKICAgICAgfSwKICAgIH0sCiAgICBjb250YWN0OiB7CiAgICAgIHBob25lOiAiOTg4NjA5ODg2MCIsCiAgICAgIGVtYWlsOiAiYWJjZC5lZmdoQGdtYWlsLmNvbSIsCiAgICB9LAogICAgLi4uKHNlc3Npb25EYXRhPy5mdWxmaWxsbWVudD8uc3RhcnQ/Lmluc3RydWN0aW9ucyAmJiB7CiAgICAgIGluc3RydWN0aW9uczogc2Vzc2lvbkRhdGEuZnVsZmlsbG1lbnQuc3RhcnQuaW5zdHJ1Y3Rpb25zLAogICAgfSksCiAgfTsKCiAgLy8gQnVpbGQgRU5EIG9iamVjdAogIGxldCBlbmRPYmogPSB7CiAgICBsb2NhdGlvbjogewogICAgICBncHM6IHNlc3Npb25EYXRhLmVuZF9sb2NhdGlvblswXSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICJNeSBob3VzZSBvciBidWlsZGluZyAjIiwKICAgICAgICBidWlsZGluZzogIk15IGJ1aWxkaW5nIG5hbWUgMiIsCiAgICAgICAgbG9jYWxpdHk6ICJNeSBzdHJlZXQgbmFtZSAyIiwKICAgICAgICBjaXR5OiAibXkgY2l0eSBuYW1lIDIiLAogICAgICAgIHN0YXRlOiAibXkgc3RhdGUgMiIsCiAgICAgICAgY291bnRyeTogIkluZGlhIiwKICAgICAgICBhcmVhX2NvZGU6IHNlc3Npb25EYXRhLmVuZF9hcmVhX2NvZGVbMF0sCiAgICAgIH0sCiAgICB9LAogICAgY29udGFjdDogewogICAgICBwaG9uZTogIjkxMjM0MjY3ODkiLAogICAgICBlbWFpbDogInh5ei5xd2VxQGdtYWlsLmNvbSIsCiAgICB9LAogICAgLi4uKHNlc3Npb25EYXRhPy5mdWxmaWxsbWVudD8uZW5kPy5pbnN0cnVjdGlvbnMgJiYgewogICAgICBpbnN0cnVjdGlvbnM6IHNlc3Npb25EYXRhLmZ1bGZpbGxtZW50LmVuZC5pbnN0cnVjdGlvbnMsCiAgICB9KSwKICB9OwogIGNvbnNvbGUubG9nKCJvbl9zZWFyY2hfZnVsZmlsbG1lbnRzIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEub25fc2VhcmNoX2Z1bGZpbGxtZW50cykpCiAgY29uc3Qgc291cmNlRnVsZmlsbG1lbnQgPSBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfZnVsZmlsbG1lbnRzWzBdPy5maW5kKAogICAgKGZ1bGZpbGxtZW50KSA9PiB7CiAgICAgIHJldHVybiBmdWxmaWxsbWVudC50eXBlID09PSAiRGVsaXZlcnkiOwogICAgfQogICk7CiAgY29uc29sZS5sb2coInNvdXJjZV9mdWxmaWxsbWVudCIsIEpTT04uc3RyaW5naWZ5KHNvdXJjZUZ1bGZpbGxtZW50KSk7CiAgY29uc3QgbWFwcGVkSXRlbXMgPSBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfaXRlbXNbMF0KICAgID8uZmlsdGVyKChpdGVtKSA9PiBpdGVtLmZ1bGZpbGxtZW50X2lkID09PSBzb3VyY2VGdWxmaWxsbWVudD8uaWQpCiAgICA/Lm1hcCgoaXRlbSkgPT4gKHsKICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgIGZ1bGZpbGxtZW50X2lkOiBpdGVtLmZ1bGZpbGxtZW50X2lkLAogICAgICBjYXRlZ29yeV9pZDogaXRlbS5jYXRlZ29yeV9pZCwKICAgICAgZGVzY3JpcHRvcjogewogICAgICAgIGNvZGU6IGl0ZW0uZGVzY3JpcHRvcj8uY29kZQogICAgICB9CiAgICB9KSkgfHwgW107CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSBtYXBwZWRJdGVtczsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1swXSA9IHsKICAgICAgaWQ6IHNvdXJjZUZ1bGZpbGxtZW50LmlkLAoKICAgICAgdHlwZTogc291cmNlRnVsZmlsbG1lbnQudHlwZSwKCiAgICAgIHN0YXJ0OiBzdGFydE9iaiwKICAgICAgZW5kOiBlbmRPYmosCgogICAgICB0YWdzOiByZW1vdmVUYWdzQnlDb2RlcygKICAgICAgICBzb3VyY2VGdWxmaWxsbWVudC50YWdzLAogICAgICAgIFsiZGlzdGFuY2UiXQogICAgICApLAogICAgfTsKCgogIGNvbnNvbGUubG9nKCJkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmciLCBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcpOwoKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nLmNyZWF0ZWRfYXQgPQogICAgZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nLnVwZGF0ZWRfYXQgPQogICAgZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudCA9IHsKICAgIHR5cGU6IHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZVswXSwKICAgIC4uLmdldFBheWVtbnRGaWVsZHMoc2Vzc2lvbkRhdGEucGF5bWVudF90eXBlWzBdKSwKICB9OwoKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: init
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M2
          timestamp: '2023-06-06T21:30:00.000Z'
          ttl: PT30S
        message:
          order:
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: '1'
                category_id: Immediate Delivery
                descriptor:
                  code: P2P
            fulfillments:
              - id: '1'
                type: Delivery
                start:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: My store name
                      building: My building name
                      locality: My street name
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: My street name
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
            billing:
              name: ONDC Logistics Buyer NP
              address:
                name: My house or building no
                building: My house or building name
                locality: Jayanagar
                city: Bengaluru
                state: Karnataka
                country: India
                area_code: '560076'
              tax_number: XXXXXXXXXXXXXXX
              phone: '9886098860'
              email: abcd.efgh@gmail.com
              created_at: '2023-02-06T21:30:00.000Z'
              updated_at: '2023-02-06T21:30:00.000Z'
            payment:
              '@ondc/org/collection_amount': '300.00'
              collected_by: BPP
              type: ON-FULFILLMENT
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  beneficiary_name: xxxxx
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        init_fulfillments: $.message.order.fulfillments
        items: $.message.order.items
        billing: $.message.order.billing
        payment: $.message.order.payment
      inputs: {}
  - api: on_init
    action_id: on_init_1
    owner: BPP
    responseFor: init_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0Lm1lc3NhZ2VfaWQgPSBzZXNzaW9uRGF0YS5sYXRlc3RNZXNzYWdlX2lkWzBdOwogIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQuY2l0eSA9IHNlc3Npb25EYXRhLmNpdHlfY29kZVswXTsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyLmlkID0gc2Vzc2lvbkRhdGEub25fc2VhcmNoX3Byb3ZpZGVyc1swXS5pZDsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyLmxvY2F0aW9uc1swXS5pZCA9CiAgICBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfbG9jYXRpb25zWzBdWzBdLmlkOwoKICBjb25zdCB0ZW1wSXRlbXMgPSBzZXNzaW9uRGF0YS5pdGVtc1swXTsKICAKICB0ZW1wSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgZGVsZXRlIGl0ZW0uY2F0ZWdvcnlfaWQ7CiAgICBkZWxldGUgaXRlbS50YWdzOwoKICAgIGlmIChzZXNzaW9uRGF0YT8ucmF0ZV9iYXNpcykgewogICAgICBkZWxldGUgaXRlbS5mdWxmaWxsbWVudF9pZDsKICAgICAgaXRlbS5mdWxmaWxsbWVudF9pZHMgPSBbIkYxIiwgIkYyIl07CiAgICB9CiAgfSk7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSB0ZW1wSXRlbXM7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPSBzZXNzaW9uRGF0YS5pbml0X2Z1bGZpbGxtZW50c1swXTsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUgPSB7CiAgICAgIGJyZWFrdXA6IFsKICAgICAgICB7CiAgICAgICAgICAiQG9uZGMvb3JnL2l0ZW1faWQiOiBzZXNzaW9uRGF0YS5pdGVtc1swXVswXS5pZCwKICAgICAgICAgICJAb25kYy9vcmcvdGl0bGVfdHlwZSI6ICJkZWxpdmVyeSIsCiAgICAgICAgICBwcmljZTogewogICAgICAgICAgICBjdXJyZW5jeTogIklOUiIsCiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uRGF0YT8ucmF0ZV9iYXNpcyA/ICIxMDAuMDAiIDogIjUwLjAwIiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiQG9uZGMvb3JnL2l0ZW1faWQiOiBzZXNzaW9uRGF0YS5pdGVtc1swXVswXS5pZCwKICAgICAgICAgICJAb25kYy9vcmcvdGl0bGVfdHlwZSI6ICJ0YXgiLAogICAgICAgICAgcHJpY2U6IHsKICAgICAgICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICAgICAgICB2YWx1ZTogc2Vzc2lvbkRhdGE/LnJhdGVfYmFzaXMgPyAiMTguMDAiIDogIjkuMDAiLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIC4uLihzZXNzaW9uRGF0YT8uaXNfY29kID09PSAieWVzIgogICAgICAgICAgPyBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAiQG9uZGMvb3JnL2l0ZW1faWQiOiBzZXNzaW9uRGF0YS5pdGVtc1sxXS5pZCwKICAgICAgICAgICAgICAiQG9uZGMvb3JnL3RpdGxlX3R5cGUiOiAiY29kIiwKICAgICAgICAgICAgICBwcmljZTogewogICAgICAgICAgICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICAgICAgICAgICAgdmFsdWU6ICI5LjAwIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgIkBvbmRjL29yZy9pdGVtX2lkIjogc2Vzc2lvbkRhdGEuaXRlbXNbMV0uaWQsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy90aXRsZV90eXBlIjogInRheCIsCiAgICAgICAgICAgICAgcHJpY2U6IHsKICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAiSU5SIiwKICAgICAgICAgICAgICAgIHZhbHVlOiAiMi4wMCIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgIF0KICAgICAgICAgIDogW10pLAogICAgICBdLAogICAgICB0dGw6ICJQVDE1TSIsCiAgICB9OwoKICBpZiAoc2Vzc2lvbkRhdGE/LmZlYXR1cmVfY2FuY2VsbGF0aW9uX3Rlcm1zID09PSAieWVzIikgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5jYW5jZWxsYXRpb25fdGVybXMgPSBbCiAgICAgIHsKICAgICAgICBmdWxmaWxsbWVudF9zdGF0ZTogewogICAgICAgICAgZGVzY3JpcHRvcjogewogICAgICAgICAgICBjb2RlOiAiUGVuZGluZyIsCiAgICAgICAgICAgIHNob3J0X2Rlc2M6ICIwMDgiLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIGNhbmNlbGxhdGlvbl9mZWU6IHsKICAgICAgICAgIHBlcmNlbnRhZ2U6ICIwLjAwIiwKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgZnVsZmlsbG1lbnRfc3RhdGU6IHsKICAgICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgICAgY29kZTogIkFnZW50LWFzc2lnbmVkIiwKICAgICAgICAgICAgc2hvcnRfZGVzYzogIjAwMSwwMDMiLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIGNhbmNlbGxhdGlvbl9mZWU6IHsKICAgICAgICAgIHBlcmNlbnRhZ2U6ICIxMDAuMDAiLAogICAgICAgIH0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBmdWxmaWxsbWVudF9zdGF0ZTogewogICAgICAgICAgZGVzY3JpcHRvcjogewogICAgICAgICAgICBjb2RlOiAiT3JkZXItcGlja2VkLXVwIiwKICAgICAgICAgICAgc2hvcnRfZGVzYzogIjAwMSwwMDMiLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIGNhbmNlbGxhdGlvbl9mZWU6IHsKICAgICAgICAgIHBlcmNlbnRhZ2U6ICIxMDAuMDAiLAogICAgICAgIH0sCiAgICAgIH0sCiAgICBdOwogIH0KICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlLnByaWNlID0gewogICAgY3VycmVuY3k6ICJJTlIiLAogICAgdmFsdWU6IGNhbGN1bGF0ZVF1b3RlUHJpY2UoZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZS5icmVha3VwKSwKICB9OwoKICBpZiAoc2Vzc2lvbkRhdGE/LnJhdGVfYmFzaXMpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdLmlkID0gIkYxIjsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzLnB1c2goewogICAgICAuLi5kZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1swXSwKICAgICAgaWQ6ICJGMiIsCiAgICB9KTsKICB9CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzLm1hcCgoZnVsZnVsbG1lbnQpID0+IHsKICAgICAgaWYgKHNlc3Npb25EYXRhLmNhdGVnb3J5X2lkWzBdID09PSAiSW1tZWRpYXRlIERlbGl2ZXJ5IikgewogICAgICAgIGZ1bGZ1bGxtZW50LnRhZ3MucHVzaCh7CiAgICAgICAgICBjb2RlOiAicmlkZXJfY2hlY2siLAogICAgICAgICAgbGlzdDogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogImlubGluZV9jaGVja19mb3JfcmlkZXIiLAogICAgICAgICAgICAgIHZhbHVlOiAieWVzIiwKICAgICAgICAgICAgfSwKICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGZ1bGZ1bGxtZW50OwogICAgfSk7CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KCiAgaWYgKAogICAgKHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIlBPU1QtRlVMRklMTE1FTlQiIHx8CiAgICAgIHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIk9OLUZVTEZJTExNRU5UIikgJiYKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudC5jb2xsZWN0ZWRfYnkgPT09ICJCQVAiCiAgKSB7CiAgICAvLyBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRbIkBvbmRjL29yZy9jb2xsZWN0aW9uX2Ftb3VudCJdID0gCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRbIkBvbmRjL29yZy9zZXR0bGVtZW50X2RldGFpbHMiXSA9IFsKICAgICAgewogICAgICAgIHNldHRsZW1lbnRfY291bnRlcnBhcnR5OiAibHNwIiwKICAgICAgICBzZXR0bGVtZW50X3R5cGU6ICJ1cGkiLAogICAgICAgIGJlbmVmaWNpYXJ5X25hbWU6ICJ4eHh4eCIsCiAgICAgICAgdXBpX2FkZHJlc3M6ICJnZnRAb2tzYmkiLAogICAgICAgIHNldHRsZW1lbnRfYmFua19hY2NvdW50X25vOiAiWFhYWFhYWFhYWCIsCiAgICAgICAgc2V0dGxlbWVudF9pZnNjX2NvZGU6ICJYWFhYWFhYWFgiLAogICAgICB9LAogICAgXTsKICB9CiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: on_init
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M2
          timestamp: '2023-02-06T21:30:30.000Z'
        message:
          order:
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I2
                fulfillment_id: '1'
            fulfillments:
              - id: '1'
                type: Delivery
                start:
                  location:
                    gps: '12.4535445,77.9283792'
                    address:
                      name: Store name
                      building: House or building name
                      locality: Locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                tags:
                  - code: rider_check
                    list:
                      - code: inline_check_for_rider
                        value: 'yes'
            quote:
              price:
                currency: INR
                value: '59.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
              ttl: PT15M
            payment:
              '@ondc/org/collection_amount': '300.00'
              type: ON-FULFILLMENT
              collected_by: BPP
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  beneficiary_name: xxxxx
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
            cancellation_terms:
              - fulfillment_state:
                  descriptor:
                    code: Pending
                    short_desc: 008
                cancellation_fee:
                  percentage: '0.00'
                  amount:
                    currency: INR
                    value: '0.00'
              - fulfillment_state:
                  descriptor:
                    code: Agent-assigned
                    short_desc: '001,003'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
              - fulfillment_state:
                  descriptor:
                    code: Order-picked-up
                    short_desc: '001,003'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
              - fulfillment_state:
                  descriptor:
                    code: Out-for-delivery
                    short_desc: '011,012,013,014,015'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
            tags:
              - code: bpp_terms
                list:
                  - code: max_liability
                    value: '2'
                  - code: max_liability_cap
                    value: '10000'
                  - code: mandatory_arbitration
                    value: 'false'
                  - code: court_jurisdiction
                    value: Bengaluru
                  - code: delay_interest
                    value: '1000'
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/protocol-network-extension/discussions/79
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        quote: $.message.order.quote
        cancellation_terms: $.message.order.cancellation_terms
      inputs: {}
  - api: confirm
    action_id: confirm_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gdXVpZHY0KCk7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIuaWQgPSBzZXNzaW9uRGF0YS5wcm92aWRlcl9pZFswXTsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyLmxvY2F0aW9uc1swXS5pZCA9CiAgICBzZXNzaW9uRGF0YS5sb2NhdGlvbl9pZFswXTsKCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlc3Npb25EYXRhLml0ZW1zWzBdOwoKICBsZXQgdGltZSA9IG51bGw7CgogIHNlc3Npb25EYXRhPy5vbl9zZWFyY2hfaXRlbXNbMF0/LmZvckVhY2goKGl0ZW0pID0+IHsKICAgIC8vIGNvbnNvbGUubG9nKCI6Ojo6Ojo6Ojo6OjoiLCBpdGVtLmlkLCBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zWzBdLmlkLCBpdGVtKQogICAgaWYgKGl0ZW0uaWQgPT09IGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXNbMF0uaWQpIHsKICAgICAgdGltZSA9IGl0ZW0udGltZTsKICAgIH0KICB9KTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMubWFwKAogICAgKGl0ZW0pID0+IHsKICAgICAgaXRlbS50aW1lID0gdGltZTsKICAgICAgcmV0dXJuIGl0ZW07CiAgICB9CiAgKTsKCiAgaWYgKHNlc3Npb25EYXRhPy5yYXRlX2Jhc2lzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zID0KICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICBkZWxldGUgaXRlbS5mdWxmaWxsbWVudF9pZDsKICAgICAgICBsZXQgZnVsZmlpbGxtZW50SWRzID0gW107CgogICAgICAgIHNlc3Npb25EYXRhPy5vbl9pbml0X2l0ZW1zPy5mb3JFYWNoKChvbmluaXRJdGVtKSA9PiB7CiAgICAgICAgICBpZiAob25pbml0SXRlbS5pZCA9PT0gaXRlbS5pZCkgewogICAgICAgICAgICBmdWxmaWlsbG1lbnRJZHMgPSBvbmluaXRJdGVtLmZ1bGZpbGxtZW50X2lkczsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaXRlbS5mdWxmaWxsbWVudF9pZHMgPSBmdWxmaWlsbG1lbnRJZHM7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLmZ1bGZpbGxtZW50cykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPSBzZXNzaW9uRGF0YS5mdWxmaWxsbWVudHM7CiAgICBjb25zb2xlLmxvZygiZXhpc3RpbmcgcGF5bG9hZCBpbiBjb25maXJtIiwgSlNPTi5zdHJpbmdpZnkoZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMpKTsKCiAgfQoKICBpZiAoCiAgICBBcnJheS5pc0FycmF5KHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcykgJiYKICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcy5sZW5ndGggPiAwCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbl90ZXJtcyA9CiAgICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtc1swXTsKICB9CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0uc3RhcnQudGltZSA9IHsKICAgIGR1cmF0aW9uOiBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfZnVsZmlsbG1lbnRzWzBdWzBdLnN0YXJ0LnRpbWUuZHVyYXRpb24sCiAgfTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0uc3RhcnQucGVyc29uID0gewogICAgbmFtZTogInBlcnNvbl9uYW1lXzEiLAogIH07CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdLmVuZC5wZXJzb24gPSB7CiAgICBuYW1lOiAicGVyc29uX25hbWVfMiIsCiAgfTsKCgogIGNvbnN0IHRhZ3MgPSBbCiAgICB7CiAgICAgIGNvZGU6ICJzdGF0ZSIsCiAgICAgIGxpc3Q6IFsKICAgICAgICB7CiAgICAgICAgICBjb2RlOiAicmVhZHlfdG9fc2hpcCIsCiAgICAgICAgICB2YWx1ZToKICAgICAgICAgICAgc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkID09PSAiSW1tZWRpYXRlIERlbGl2ZXJ5IiA/ICJ5ZXMiIDogIm5vIiwKICAgICAgICB9LAogICAgICBdLAogICAgfSwKCiAgICB7CiAgICAgICAgICBjb2RlOiAicnRvX2FjdGlvbiIsCiAgICAgICAgICBsaXN0OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb2RlOiAicmV0dXJuX3RvX29yaWdpbiIsCiAgICAgICAgICAgICAgdmFsdWU6IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzPy5yZXR1cm5Ub09yaWdpbiB8fCAibm8iLAogICAgICAgICAgICB9LAogICAgICAgICAgXSwKICAgICAgICB9CiAgXTsKCgogIGxldCBhbGxUYWdzID0gbWVyZ2VGdWxmaWxsbWVudFRhZ3MoCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1swXT8udGFncyA/PyBbXSwKICAgIHRhZ3MKICApOwoKCiAgaWYgKAogICAgc2Vzc2lvbkRhdGE/LnJhdGVfYmFzaXMgJiYKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzLmxlbmd0aCA+IDEKICApIHsKICAgIGNvbnN0IHByZVRhZ3MgPSByZW1vdmVUYWdzQnlDb2RlcygKICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMV0udGFncyA/PyBbXSwKICAgICAgWyJsaW5rZWRfcHJvdmlkZXIiXQogICAgKTsKCiAgICBhbGxUYWdzID0gWy4uLmFsbFRhZ3MsIC4uLnByZVRhZ3NdOwogIH0KCiAgYWxsVGFncyA9IHJlbW92ZVRhZ3NCeUNvZGVzKGFsbFRhZ3MsIFsicmlkZXJfY2hlY2siXSk7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzLm1hcCgoZnVsZmlsbG1lbnQpID0+ICh7CiAgICAgIC4uLmZ1bGZpbGxtZW50LAogICAgICB0YWdzOiBhbGxUYWdzLAogICAgfSkpOwoKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLQogIGxldCBpc1JlYWR5VG9TaGlwID0gZmFsc2U7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdLnRhZ3MuZm9yRWFjaCgodGFnKSA9PiB7CiAgICBpZiAodGFnLmNvZGUgPT09ICJzdGF0ZSIpIHsKICAgICAgdGFnLmxpc3QuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgIGlmIChpdGVtLmNvZGUgPT09ICJyZWFkeV90b19zaGlwIiAmJiBpdGVtLnZhbHVlID09ICJ5ZXMiKSB7CiAgICAgICAgICBpc1JlYWR5VG9TaGlwID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9CiAgICAoZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgfHwgW10pLm1hcCgoZnVsZmlsbG1lbnQpID0+IHsKCiAgICAgIGNvbnN0IHN0YXJ0Q29kZSA9IHNlc3Npb25EYXRhPy5zdGF0aWNfcGlja3VwX290cDsKICAgICAgY29uc3QgZW5kQ29kZSA9IHNlc3Npb25EYXRhPy5zdGF0aWNfZGVsaXZlcnlfb3RwOwoKICAgICAgbGV0IHVwZGF0ZWRTdGFydEluc3RydWN0aW9uczsKICAgICAgbGV0IHVwZGF0ZWRFbmRJbnN0cnVjdGlvbnM7CgogICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgIC8vIFNUQVJUIElOU1RSVUNUSU9OUwogICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgIGlmIChzdGFydENvZGUgPT09ICI1IikgewogICAgICAgIHVwZGF0ZWRTdGFydEluc3RydWN0aW9ucyA9IHsKICAgICAgICAgIGNvZGU6ICI1IiwKICAgICAgICAgIHNob3J0X2Rlc2M6ICI5ODcwIiwKICAgICAgICAgIGxvbmdfZGVzYzogImFkZGl0aW9uYWwgaW5zdHJ1Y3Rpb25zIGZvciBwaWNrdXAiLAogICAgICAgICAgYWRkaXRpb25hbF9kZXNjOiB7CiAgICAgICAgICAgIGNvbnRlbnRfdHlwZTogInRleHQvaHRtbCIsCiAgICAgICAgICAgIHVybDogImh0dHA6Ly9kZXNjcmlwdGlvbi5jb20iLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpc1JlYWR5VG9TaGlwICE9PSAidW5kZWZpbmVkIiAmJiBpc1JlYWR5VG9TaGlwKSB7CiAgICAgICAgdXBkYXRlZFN0YXJ0SW5zdHJ1Y3Rpb25zID0gewogICAgICAgICAgY29kZTogIjIiLAogICAgICAgICAgc2hvcnRfZGVzYzogIjEyMzEyMyIsCiAgICAgICAgICBsb25nX2Rlc2M6ICJhZGRpdGlvbmFsIGluc3RydWN0aW9ucyBmb3IgcGlja3VwIiwKICAgICAgICAgIGFkZGl0aW9uYWxfZGVzYzogewogICAgICAgICAgICBjb250ZW50X3R5cGU6ICJ0ZXh0L2h0bWwiLAogICAgICAgICAgICB1cmw6ICJodHRwOi8vZGVzY3JpcHRpb24uY29tIiwKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAvLyBFTkQgSU5TVFJVQ1RJT05TCiAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgaWYgKGVuZENvZGUgPT09ICI1IikgewogICAgICAgIHVwZGF0ZWRFbmRJbnN0cnVjdGlvbnMgPSB7CiAgICAgICAgICBjb2RlOiAiNSIsCiAgICAgICAgICBzaG9ydF9kZXNjOiAiNjg3MSIsCiAgICAgICAgICBsb25nX2Rlc2M6ICJhZGRpdGlvbmFsIGluc3RydWN0aW9ucyBmb3IgZGVsaXZlcnkiLAogICAgICAgICAgYWRkaXRpb25hbF9kZXNjOiB7CiAgICAgICAgICAgIGNvbnRlbnRfdHlwZTogInRleHQvaHRtbCIsCiAgICAgICAgICAgIHVybDogImh0dHA6Ly9kZXNjcmlwdGlvbi5jb20iLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpc1JlYWR5VG9TaGlwICE9PSAidW5kZWZpbmVkIiAmJiBpc1JlYWR5VG9TaGlwKSB7CiAgICAgICAgdXBkYXRlZEVuZEluc3RydWN0aW9ucyA9IHsKICAgICAgICAgIGNvZGU6ICIyIiwKICAgICAgICAgIHNob3J0X2Rlc2M6ICI5ODc2NTciLAogICAgICAgICAgbG9uZ19kZXNjOiAiYWRkaXRpb25hbCBpbnN0cnVjdGlvbnMgZm9yIGRlbGl2ZXJ5IiwKICAgICAgICAgIGFkZGl0aW9uYWxfZGVzYzogewogICAgICAgICAgICBjb250ZW50X3R5cGU6ICJ0ZXh0L2h0bWwiLAogICAgICAgICAgICB1cmw6ICJodHRwOi8vZGVzY3JpcHRpb24uY29tIiwKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgY29uc3QgdXBkYXRlZFRhZ3MgPSBbLi4uKGZ1bGZpbGxtZW50LnRhZ3MgfHwgW10pXTsKICAgICAgCiAgICAgIGNvbnN0IHVwZGF0ZWRGdWxmaWxsbWVudCA9IHsKICAgICAgICAuLi5mdWxmaWxsbWVudCwKICAgICAgICBzdGFydDogewogICAgICAgICAgLi4uKGZ1bGZpbGxtZW50LnN0YXJ0IHx8IHt9KSwKICAgICAgICAgIC4uLih1cGRhdGVkU3RhcnRJbnN0cnVjdGlvbnMgJiYgewogICAgICAgICAgICBpbnN0cnVjdGlvbnM6IHVwZGF0ZWRTdGFydEluc3RydWN0aW9ucywKICAgICAgICAgIH0pLAogICAgICAgIH0sCiAgICAgICAgZW5kOiB7CiAgICAgICAgICAuLi4oZnVsZmlsbG1lbnQuZW5kIHx8IHt9KSwKICAgICAgICAgIC4uLih1cGRhdGVkRW5kSW5zdHJ1Y3Rpb25zICYmIHsKICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zOiB1cGRhdGVkRW5kSW5zdHJ1Y3Rpb25zLAogICAgICAgICAgfSksCiAgICAgICAgfSwKICAgICAgICB0YWdzOiB1cGRhdGVkVGFncywKICAgICAgfTsKCiAgICAgIGNvbnNvbGUubG9nKCJVcGRhdGVkIGZ1bGZpbGxtZW50OiIsIHVwZGF0ZWRGdWxmaWxsbWVudCk7CgogICAgICByZXR1cm4gdXBkYXRlZEZ1bGZpbGxtZW50OwogICAgfSk7CgoKICBjb25zdCB0ZW1wUXVvdGUgPSBzZXNzaW9uRGF0YS5xdW90ZVswXTsKCiAgZGVsZXRlIHRlbXBRdW90ZS50dGw7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUgPSB0ZW1wUXVvdGU7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuY3JlYXRlZF9hdCA9IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIudXBkYXRlZF9hdCA9IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwoKICBpZiAoc2Vzc2lvbkRhdGEucGF5bWVudCkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50ID0gc2Vzc2lvbkRhdGEucGF5bWVudFswXTsKICB9CgogIGlmICgKICAgIChzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUgPT09ICJQT1NULUZVTEZJTExNRU5UIiB8fAogICAgICBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUgPT09ICJPTi1GVUxGSUxMTUVOVCIpICYmCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQuY29sbGVjdGVkX2J5ID09PSAiQlBQIgogICkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50WyJAb25kYy9vcmcvc2V0dGxlbWVudF9kZXRhaWxzIl0gPSBbCiAgICAgIHsKICAgICAgICBzZXR0bGVtZW50X2NvdW50ZXJwYXJ0eTogImxibnAiLAogICAgICAgIHNldHRsZW1lbnRfdHlwZTogInVwaSIsCiAgICAgICAgYmVuZWZpY2lhcnlfbmFtZTogInh4eHh4IiwKICAgICAgICB1cGlfYWRkcmVzczogImdmdEBva3NiaSIsCiAgICAgICAgc2V0dGxlbWVudF9iYW5rX2FjY291bnRfbm86ICJYWFhYWFhYWFhYIiwKICAgICAgICBzZXR0bGVtZW50X2lmc2NfY29kZTogIlhYWFhYWFhYWCIsCiAgICAgIH0sCiAgICBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlclsiQG9uZGMvb3JnL2xpbmtlZF9vcmRlciJdID0gewogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIGNhdGVnb3J5X2lkOiBzZXNzaW9uRGF0YT8ucmV0YWlsX2NhdGVnb3J5WzBdIHx8ICJHcm9jZXJ5IiwKICAgICAgICBkZXNjcmlwdG9yOiB7CiAgICAgICAgICBuYW1lOiAiSXRlbTEiLAogICAgICAgIH0sCiAgICAgICAgcXVhbnRpdHk6IHsKICAgICAgICAgIGNvdW50OiAyLAogICAgICAgICAgbWVhc3VyZTogewogICAgICAgICAgICB1bml0OiAia2lsb2dyYW0iLAogICAgICAgICAgICB2YWx1ZTogMSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBwcmljZTogewogICAgICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICAgICAgdmFsdWU6ICI3MC4wMCIsCiAgICAgICAgfSwKICAgICAgfQogICAgXSwKICAgIHByb3ZpZGVyOiB7CiAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICBuYW1lOiAiU2VsbGVyMSIsCiAgICAgIH0sCiAgICAgIGFkZHJlc3M6IHsKICAgICAgICBuYW1lOiAiTXkgc3RvcmUgbmFtZSAxIiwKICAgICAgICBidWlsZGluZzogIk15IGJ1aWxkaW5nIG5hbWUgMSIsCiAgICAgICAgbG9jYWxpdHk6ICJNeSBzdHJlZXQgbmFtZSAxIiwKICAgICAgICBjaXR5OiAibXkgY2l0eSAxIiwKICAgICAgICBzdGF0ZTogIm15IHN0YXRlIDEiLAogICAgICAgIGFyZWFfY29kZTogc2Vzc2lvbkRhdGE/LnN0YXJ0X2FyZWFfY29kZVswXSB8fCAiNTYwMDAxIiwKICAgICAgfSwKICAgIH0sCiAgICBvcmRlcjogewogICAgICBpZDogIk8xIiwKICAgICAgd2VpZ2h0OiB7CiAgICAgICAgdW5pdDogImtpbG9ncmFtIiwKICAgICAgICB2YWx1ZTogMywKICAgICAgfSwKICAgICAgZGltZW5zaW9uczogewogICAgICAgIGxlbmd0aDogewogICAgICAgICAgdW5pdDogImNlbnRpbWV0ZXIiLAogICAgICAgICAgdmFsdWU6IDEsCiAgICAgICAgfSwKICAgICAgICBicmVhZHRoOiB7CiAgICAgICAgICB1bml0OiAiY2VudGltZXRlciIsCiAgICAgICAgICB2YWx1ZTogMSwKICAgICAgICB9LAogICAgICAgIGhlaWdodDogewogICAgICAgICAgdW5pdDogImNlbnRpbWV0ZXIiLAogICAgICAgICAgdmFsdWU6IDEsCiAgICAgICAgfSwKICAgICAgfSwKICAgIH0sCiAgfTsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: confirm
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M3
          timestamp: '2023-06-06T22:00:00.000Z'
          ttl: PT30S
        message:
          order:
            id: O2
            state: Created
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: '1'
                category_id: Immediate Delivery
                descriptor:
                  code: P2P
                time:
                  label: TAT
                  duration: PT45M
                  timestamp: '2023-06-06'
            quote:
              price:
                currency: INR
                value: '59.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
            fulfillments:
              - id: '1'
                type: Delivery
                '@ondc/org/awb_no': '1227262193237777'
                start:
                  time:
                    duration: PT15M
                  person:
                    name: person_name
                  location:
                    gps: '12.4535445,77.9283792'
                    address:
                      name: Store name
                      building: House or building name
                      locality: Locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                  instructions:
                    code: '2'
                    short_desc: value of PCC
                    long_desc: additional instructions for pickup
                    additional_desc:
                      content_type: text/html
                      url: 'https://reverse_qc_sop_form.htm'
                end:
                  person:
                    name: person_name
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                  instructions:
                    code: '3'
                    short_desc: value of DCC
                    long_desc: additional instructions for delivery
            billing:
              name: ONDC Logistics Buyer NP1
              address:
                name: name
                building: My house or building name
                locality: My street name
                city: Bengaluru
                state: Karnataka
                country: India
                area_code: '560076'
              tax_number: 29AAACU1901H1ZK
              phone: '9886098860'
              email: abcd.efgh@gmail.com
              created_at: '2023-06-06T21:30:00.000Z'
              updated_at: '2023-06-06T21:30:00.000Z'
            payment:
              '@ondc/org/collection_amount': '300.00'
              collected_by: BPP
              type: ON-FULFILLMENT
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
            '@ondc/org/linked_order':
              items:
                - category_id: Grocery
                  descriptor:
                    name: Atta
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 0.5
                  price:
                    currency: INR
                    value: '150.00'
              provider:
                descriptor:
                  name: Aadishwar Store
                address:
                  name: KHB Towers
                  building: Building or House No
                  locality: Koramangala
                  city: Bengaluru
                  state: Karnataka
                  area_code: '560070'
              order:
                id: O1
                weight:
                  unit: kilogram
                  value: 1
                dimensions:
                  length:
                    unit: centimeter
                    value: 1
                  breadth:
                    unit: centimeter
                    value: 1
                  height:
                    unit: centimeter
                    value: 1
            tags:
              - code: bpp_terms
                list:
                  - code: max_liability
                    value: '2'
                  - code: max_liability_cap
                    value: '10000'
                  - code: mandatory_arbitration
                    value: 'false'
                  - code: court_jurisdiction
                    value: Bengaluru
                  - code: delay_interest
                    value: '1000'
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/protocol-network-extension/discussions/79
              - code: bap_terms
                list:
                  - code: accept_bpp_terms
                    value: 'Y'
            created_at: '2023-06-06T22:00:00.000Z'
            updated_at: '2023-06-06T22:00:00.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        order_status: $.message.order.state
        order_id: $.message.order.id
        confirm_create_at_timestamp: $.message.order.created_at
        fulfillments: $.message.order.fulfillments
        items: $.message.order.items
        quote: $.message.order.quote
        linked_order: '$.message.order[''@ondc/org/linked_order'']'
        confirm_tags: $.message.order.tags
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            returnToOrigin:
              type: string
              description: Do you want return to origin?
              enum:
                - 'yes'
                - 'no'
              default: 'yes'
          required: []
          additionalProperties: false
  - api: on_confirm
    action_id: on_confirm_1
    owner: BPP
    responseFor: confirm_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQuY29udGV4dC5tZXNzYWdlX2lkID0gc2Vzc2lvbkRhdGEubGF0ZXN0TWVzc2FnZV9pZFswXTsKICBjb25zdCBwb3B1bGF0ZUZ1bGZpbGxtZW50Q29uZmltID0gKAogICAgZXhpc3RpbmdQYXlsb2FkLAogICAgc2Vzc2lvbkRhdGEKICApID0+IHsKICAgCiAgICBleGlzdGluZ1BheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgICBleGlzdGluZ1BheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWVudCkgPT4gewogICAgICAgIGxldCBpc1JlYWR5VG9TaGlwID0gZmFsc2U7CgogICAgICAgIGZ1bGZpbGxtZW50LnRhZ3MuZm9yRWFjaCgodGFnKSA9PiB7CiAgICAgICAgICBpZiAodGFnLmNvZGUgPT09ICJzdGF0ZSIpIHsKICAgICAgICAgICAgdGFnLmxpc3QuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgICAgICAgIGlmIChpdGVtLmNvZGUgPT09ICJyZWFkeV90b19zaGlwIiAmJiBpdGVtLnZhbHVlID09ICJ5ZXMiKSB7CiAgICAgICAgICAgICAgICBpc1JlYWR5VG9TaGlwID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBmdWxmaWxsbWVudC50cmFja2luZyA9IHRydWU7CgogICAgICAgIGlmIChpc1JlYWR5VG9TaGlwKSB7CiAgICAgICAgICBmdWxmaWxsbWVudC5zdGF0ZSA9IHsKICAgICAgICAgICAgZGVzY3JpcHRvcjogewogICAgICAgICAgICAgIGNvZGU6ICJBZ2VudC1hc3NpZ25lZCIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9OwogICAgICAgICAgZnVsZmlsbG1lbnQuYWdlbnQgPSB7CiAgICAgICAgICAgIG5hbWU6ICJwZXJzb25fbmFtZSIsCiAgICAgICAgICAgIHBob25lOiAiOTg4NjA5ODg2MCIsCiAgICAgICAgICB9OwogICAgICAgICAgZnVsZmlsbG1lbnQudmVoaWNsZSA9IHsKICAgICAgICAgICAgcmVnaXN0cmF0aW9uOiAiM0xWSjk0NSIsCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmICghZXhpc3RpbmdQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdLnN0YXJ0Py50aW1lPy5yYW5nZSkgewogICAgICAgICAgICBmdWxmaWxsbWVudC5zdGFydC50aW1lLnJhbmdlID0gewogICAgICAgICAgICAgIHN0YXJ0OiBleGlzdGluZ1BheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgICAgICAgICAgZW5kOiBnZXRUaW1lc3RhbXBGcm9tRHVyYXRpb24oCiAgICAgICAgICAgICAgICBleGlzdGluZ1BheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgICAgICAgICAgICBmdWxmaWxsbWVudD8uc3RhcnQ/LnRpbWU/LmR1cmF0aW9uIHx8ICJQMUQiCiAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGZ1bGZpbGxtZW50LmVuZC50aW1lID0gewogICAgICAgICAgICAgIHJhbmdlOiB7CiAgICAgICAgICAgICAgICBzdGFydDogZnVsZmlsbG1lbnQ/LnN0YXJ0Py50aW1lPy5yYW5nZT8uZW5kLAogICAgICAgICAgICAgICAgZW5kOiBnZXRUaW1lc3RhbXBGcm9tRHVyYXRpb24oCiAgICAgICAgICAgICAgICAgIGV4aXN0aW5nUGF5bG9hZC5jb250ZXh0LnRpbWVzdGFtcCwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbkRhdGE/LnRhdCB8fCAiUDFEIgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZ1bGZpbGxtZW50OwogICAgICB9KTsKCiAgICByZXR1cm4gZXhpc3RpbmdQYXlsb2FkOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlc3Npb25EYXRhPy5pdGVtc1swXTsKCiAgaWYgKHNlc3Npb25EYXRhPy5jb25maXJtX2NyZWF0ZV9hdF90aW1lc3RhbXApIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuY3JlYXRlZF9hdCA9CiAgICAgIHNlc3Npb25EYXRhLmNvbmZpcm1fY3JlYXRlX2F0X3RpbWVzdGFtcFswXTsKICB9CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci51cGRhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CgogIGlmIChzZXNzaW9uRGF0YT8uZnVsZmlsbG1lbnRzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9IHNlc3Npb25EYXRhLmZ1bGZpbGxtZW50c1swXTsKICB9CgogIGlmIChBcnJheS5pc0FycmF5KHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcykgJiYKICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcy5sZW5ndGggPiAwKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbl90ZXJtcyA9CiAgICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtc1swXTsKICB9CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWV0KSA9PiB7CiAgICAgIGZ1bGZpbGxtZXQuc3RhdGUgPSB7CiAgICAgICAgZGVzY3JpcHRvcjogewogICAgICAgICAgY29kZTogIlBlbmRpbmciLAogICAgICAgIH0sCiAgICAgIH07CiAgICAgIGZ1bGZpbGxtZXQudGFncy5wdXNoKHsKICAgICAgICBjb2RlOiAid2VhdGhlcl9jaGVjayIsCiAgICAgICAgbGlzdDogWwogICAgICAgICAgewogICAgICAgICAgICBjb2RlOiAicmFpbmluZyIsCiAgICAgICAgICAgIHZhbHVlOiAibm8iLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9KTsKCiAgICAgIHJldHVybiBmdWxmaWxsbWV0OwogICAgfSk7CiAgZGVmYXVsdFBheWxvYWQgPSBwb3B1bGF0ZUZ1bGZpbGxtZW50Q29uZmltKGRlZmF1bHRQYXlsb2FkLCBzZXNzaW9uRGF0YSk7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSA9IHNlc3Npb25EYXRhLnF1b3RlWzBdOwoKICBpZiAoc2Vzc2lvbkRhdGEucGF5bWVudCkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50ID0gc2Vzc2lvbkRhdGEucGF5bWVudFswXTsKICB9CgogIGlmICgKICAgIHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIk9OLU9SREVSIiAmJgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50LmNvbGxlY3RlZF9ieSA9PT0gIkJQUCIKICApIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudC5wYXJhbXMgPSB7CiAgICAgIGN1cnJlbmN5OiAiSU5SIiwKICAgICAgdHJhbnNhY3Rpb25faWQ6ICJ0eG4xMjM0IiwKICAgICAgYW1vdW50OiBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlLnByaWNlLnZhbHVlLAogICAgfTsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudC5zdGF0dXMgPT09ICJQQUlEIjsKICB9CgogIGlmIChzZXNzaW9uRGF0YS5saW5rZWRfb3JkZXIpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXJbIkBvbmRjL29yZy9saW5rZWRfb3JkZXIiXSA9CiAgICAgIHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlclswXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YS5jb25maXJtX3RhZ3MpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIudGFncyA9IHNlc3Npb25EYXRhLmNvbmZpcm1fdGFnc1swXQogIH0KCiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_confirm
          timestamp: '2026-02-15T12:12:22.442Z'
          transaction_id: 84770f59-155f-4a91-85f0-2a97ecb314b5
          message_id: 9bef97cf-81a2-40a7-bc3d-b4b80b77af54
          bap_id: sample-bap-id
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            id: 0dfdb5d1971e42bfb85d0c77e5035239
            state: Accepted
            provider:
              id: Delhivery
            items:
              - descriptor:
                  code: P2H2P
                category_id: Standard Delivery
                id: 4e017417-9784-4e05-bc66-502fb2d3fa72
                fulfillment_id: '1'
                time:
                  label: TAT
                  duration: P1D
                  timestamp: '2024-02-03'
            quote:
              price:
                currency: INR
                value: '42.48'
              breakup:
                - '@ondc/org/item_id': 4e017417-9784-4e05-bc66-502fb2d3fa72
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '36.00'
                - '@ondc/org/item_id': 4e017417-9784-4e05-bc66-502fb2d3fa72
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '6.48'
            payment:
              type: ON-ORDER
              status: PAID
              collected_by: BAP
              '@ondc/org/settlement_details':
                - settlement_ifsc_code: IFSCTEST1234
                  beneficiary_name: DELHIVERY LIMITED
                  settlement_bank_account_no: ACCTEST1234
                  settlement_counterparty: seller-app
                  settlement_type: neft
              '@ondc/org/collection_amount': '0.0'
            fulfillments:
              - id: '1'
                type: Delivery
                state:
                  descriptor:
                    code: Searching-for-Agent
                '@ondc/org/awb_no': '6421710001606'
                tracking: true
                start:
                  instructions:
                    long_desc: Status For Pickup
                    short_desc: '0001'
                  person:
                    name: Sangeetha Mobiles
                  location:
                    gps: '28.4554726,77.0219019'
                    address:
                      name: Sangeetha Mobiles
                      building: 'below Sangeetha mobiles,'
                      city: Bangalore
                      state: Karnataka
                      country: IND
                      area_code: '400005'
                      locality: Banashankari
                  contact:
                    phone: '8197759422'
                    email: anirban@sangeethamobiles.com
                  time:
                    range:
                      start: '2024-02-03T02:38:00.000Z'
                      end: '2024-02-03T07:38:00.000Z'
                end:
                  instructions:
                    long_desc: Status For Drop
                    short_desc: '0001'
                  person:
                    name: sellerapp
                  location:
                    gps: '21,78'
                    address:
                      name: sellerapp
                      building: indiranagar
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '110017'
                      locality: '12,san jose'
                  contact:
                    phone: '9809557809'
                    email: prasanth.m@sellerapp.com
            billing:
              address:
                door: '1, 621/A'
                country: India
                city: Bangalore
                area_code: '560038'
                name: '12th main road , Hal 2nd stage'
                locality: Indiranagar Bangalore
                state: Karnataka
                building: san jose
              updated_at: '2024-02-02T12:46:04.914Z'
              phone: '9650439777'
              tax_number: 29ABDCS3411L1Z7
              name: SELLMETRIC PRIVATE LIMITED
              created_at: '2024-02-02T12:46:04.914Z'
              email: ondc-billing@sellerapp.com
            '@ondc/org/linked_order':
              items:
                - descriptor:
                    name: Samsung Galaxy A03s Blue 3GB 32GB
                  category_id: Mobiles
                  quantity:
                    count: 1
                    measure:
                      value: 10
                      unit: gram
                  price:
                    currency: INR
                    value: '13499'
              provider:
                descriptor:
                  name: Sangeetha mobiles
                address:
                  name: Sangeetha Mobiles
                  building: 'below Sangeetha mobiles,'
                  city: Bangalore
                  state: Karnataka
                  country: IND
                  area_code: '400005'
                  locality: Banashankari
              order:
                id: SLRP-2914
                weight:
                  value: 11
                  unit: gram
                dimensions:
                  length:
                    value: 10
                    unit: centimeter
                  breadth:
                    value: 10
                    unit: centimeter
                  height:
                    value: 10
                    unit: centimeter
            created_at: '2024-02-02T12:46:05.420Z'
            updated_at: '2024-02-02T12:46:05.420Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_confirm_tags: $.message.order.tags
        on_confirm_fulfillments: $.message.order.fulfillments
        order_updated_at_timestamp: $.message.order.updated_at
      inputs: {}
  - api: cancel
    action_id: cancel_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyX2lkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5jYW5jZWxsYXRpb25fcmVhc29uX2lkID0gc2Vzc2lvbkRhdGEudXNlcl9pbnB1dHM/LmNhbmNlbGxhdGlvbl9yZWFzb25faWQKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: cancel
          timestamp: '2026-02-15T18:07:52.986Z'
          transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
          message_id: ff55fa1f-bb8e-4949-9167-47bf17902a9c
          bap_id: bap.example.com
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: bpp.example.com
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order_id: f86ecba049b741e9b162057c09a4aabe
          cancellation_reason_id: '005'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        cancellation_reason_id: $.message.cancellation_reason_id
        is_cancel_called: $.context.action
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            cancellation_reason_id:
              type: string
              description: Select a cancellation reason ID
              enum:
                - '005'
              default: '005'
          required:
            - cancellation_reason_id
          additionalProperties: false
  - api: on_cancel
    action_id: on_cancel_1
    owner: BPP
    responseFor: cancel_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQuY29udGV4dC5tZXNzYWdlX2lkID0gc2Vzc2lvbkRhdGEubGF0ZXN0TWVzc2FnZV9pZFswXTsKICBjb25zb2xlLmxvZygic2Vzc2lvbiBkYXRhIGNvbXBsZXRlIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEpKQoKICBpZiAoc2Vzc2lvbkRhdGE/Lm9uX2NvbmZpcm1fZnVsZmlsbG1lbnRzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9IHNlc3Npb25EYXRhLm9uX2NvbmZpcm1fZnVsZmlsbG1lbnRzWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nWzBdKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zID0gc2Vzc2lvbkRhdGEuaXRlbXNbMF07CgogIGlmIChzZXNzaW9uRGF0YT8uaXNfY2FuY2VsX2NhbGxlZFswXSA9PT0gImNhbmNlbCIpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuc3RhdGUgPSAiQ2FuY2VsbGVkIjsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlID0gc2Vzc2lvbkRhdGEucXVvdGVbMF07CgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5jYW5jZWxsYXRpb24gPSB7CiAgICAgIGNhbmNlbGxlZF9ieTogZGVmYXVsdFBheWxvYWQuY29udGV4dC5iYXBfaWQsCiAgICAgIHJlYXNvbjogewogICAgICAgIGlkOiBzZXNzaW9uRGF0YT8uY2FuY2VsbGF0aW9uX3JlYXNvbl9pZFswXSwKICAgICAgfSwKICAgIH07CiAgICBjb25zdCBkZWxpdmVyeUZ1bGZpbGxtZW50ID0gZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMuZmlsdGVyKChmdWxmaWxsbWVudCkgPT4gZnVsZmlsbG1lbnQudHlwZSA9PT0gIkRlbGl2ZXJ5IikKCgogICAgZm9yIChjb25zdCBmdWxmaWxsbWVudCBvZiBkZWxpdmVyeUZ1bGZpbGxtZW50KSB7CiAgICAgIGlmIChmdWxmaWxsbWVudC5zdGF0ZS5kZXNjcmlwdG9yLmNvZGUgPT09ICJQZW5kaW5nIiB8fCBmdWxmaWxsbWVudC5zdGF0ZS5kZXNjcmlwdG9yLmNvZGUgPT09ICJTZWFyY2hpbmctZm9yLUFnZW50IikgewogICAgICAgIGNvbnN0IHVwZGF0ZWRRdW90ZSA9IHJlc2V0UXVvdGVQcmljZXMoZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSk7CiAgICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSA9IHVwZGF0ZWRRdW90ZQogICAgICB9CiAgICB9CgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5tYXAoKGZ1bGZpbGxtZW50KSA9PiB7CiAgICAgICAgZnVsZmlsbG1lbnQudGFncyA9IHJlbW92ZVRhZ3NCeUNvZGVzKGZ1bGZpbGxtZW50LnRhZ3MsIFsKICAgICAgICAgICJzdGF0ZSIsCiAgICAgICAgICAicnRvX2FjdGlvbiIsCiAgICAgICAgICAid2VhdGhlcl9jaGVjayIsCiAgICAgICAgXSk7CiAgICAgICAgZnVsZmlsbG1lbnQudGFncy5wdXNoKHsKICAgICAgICAgIGNvZGU6ICJwcmVjYW5jZWxfc3RhdGUiLAogICAgICAgICAgbGlzdDogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogImZ1bGZpbGxtZW50X3N0YXRlIiwKICAgICAgICAgICAgICB2YWx1ZTogZnVsZmlsbG1lbnQuc3RhdGUuZGVzY3JpcHRvci5jb2RlLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogInVwZGF0ZWRfYXQiLAogICAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uRGF0YT8ub3JkZXJfdXBkYXRlZF9hdF90aW1lc3RhbXBbMF0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICAgIGZ1bGZpbGxtZW50LnN0YXRlLmRlc2NyaXB0b3IuY29kZSA9ICJDYW5jZWxsZWQiOwoKICAgICAgICByZXR1cm4gZnVsZmlsbG1lbnQ7CiAgICAgIH0pOwogICAgY29uc29sZS5sb2coImV4aXN0aW5nIHBheWxvYWQiLCBKU09OLnN0cmluZ2lmeShkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zKSk7CgogIH0KCiAgZWxzZSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnN0YXRlID0gIkluLXByb2dyZXNzIjsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbiA9IHsKICAgICAgY2FuY2VsbGVkX2J5OiBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmJwcF9pZCwKICAgICAgcmVhc29uOiB7CiAgICAgICAgaWQ6IHNlc3Npb25EYXRhPy5jYW5jZWxsYXRpb25fcmVhc29uX2lkLAogICAgICB9LAogICAgfTsKCiAgICBsZXQgYXJlRGlmZlRhZ3NQcmVzZW50ID0gZmFsc2U7CgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5tYXAoKGZ1bGZpbGxtZW50KSA9PiB7CiAgICAgICAgaWYgKGZ1bGZpbGxtZW50LnR5cGUgPT09ICJEZWxpdmVyeSIpIHsKICAgICAgICAgIGZ1bGZpbGxtZW50LnRhZ3MgPSByZW1vdmVUYWdzQnlDb2RlcyhmdWxmaWxsbWVudC50YWdzLCBbCiAgICAgICAgICAgICJzdGF0ZSIsCiAgICAgICAgICAgICJydG9fYWN0aW9uIiwKICAgICAgICAgICAgIndlYXRoZXJfY2hlY2siLAogICAgICAgICAgXSk7CiAgICAgICAgICBmdWxmaWxsbWVudC50YWdzLnB1c2goewogICAgICAgICAgICBjb2RlOiAicHJlY2FuY2VsX3N0YXRlIiwKICAgICAgICAgICAgbGlzdDogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvZGU6ICJmdWxmaWxsbWVudF9zdGF0ZSIsCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVsZmlsbG1lbnQuc3RhdGUuZGVzY3JpcHRvci5jb2RlLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29kZTogInVwZGF0ZWRfYXQiLAogICAgICAgICAgICAgICAgdmFsdWU6IHNlc3Npb25EYXRhPy5vcmRlcl91cGRhdGVkX2F0X3RpbWVzdGFtcFswXSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgICAgfSk7CiAgICAgICAgICBmdWxmaWxsbWVudC5zdGF0ZS5kZXNjcmlwdG9yLmNvZGUgPSAiUlRPIjsKCiAgICAgICAgICBmdWxmaWxsbWVudC50YWdzLnB1c2goewogICAgICAgICAgICBjb2RlOiAicnRvX2V2ZW50IiwKICAgICAgICAgICAgbGlzdDogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvZGU6ICJyZXRyeV9jb3VudCIsCiAgICAgICAgICAgICAgICB2YWx1ZTogc2Vzc2lvbkRhdGE/LmRvbWFpbiA9PT0gIk9OREM6TE9HMTAiID8gIjEiIDogIjMiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29kZTogInJ0b19pZCIsCiAgICAgICAgICAgICAgICB2YWx1ZTogc2Vzc2lvbkRhdGE/LnJ0b19pZCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvZGU6ICJjYW5jZWxsYXRpb25fcmVhc29uX2lkIiwKICAgICAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uRGF0YT8uY2FuY2VsbGF0aW9uX3JlYXNvbl9pZFswXSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvZGU6ICJjYW5jZWxsZWRfYnkiLAogICAgICAgICAgICAgICAgdmFsdWU6IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQuYnBwX2lkLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgICB9KTsKCiAgICAgICAgICBmdWxmaWxsbWVudC50YWdzID0gcmVtb3ZlVGFnc0J5Q29kZXMoZnVsZmlsbG1lbnQudGFncywgWyJ0cmFja2luZyJdKTsKICAgICAgICB9CgogICAgICAgIC8vIGNoZWNrIGZvciBkaWZmIHRhZ3MKICAgICAgICBmdWxmaWxsbWVudC50YWdzLm1hcCgodGFnKSA9PiB7CiAgICAgICAgICBpZiAodGFnLmNvZGUgPT09ICJsaW5rZWRfb3JkZXJfZGlmZiIpIHsKICAgICAgICAgICAgYXJlRGlmZlRhZ3NQcmVzZW50ID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIGZ1bGZpbGxtZW50OwogICAgICB9KTsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5wdXNoKHsKICAgICAgaWQ6IHNlc3Npb25EYXRhPy5ydG9faWQsCiAgICAgIHR5cGU6ICJSVE8iLAogICAgICBzdGF0ZTogewogICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgIGNvZGU6ICJSVE8tSW5pdGlhdGVkIiwKICAgICAgICB9LAogICAgICB9LAogICAgICBzdGFydDogewogICAgICAgIHRpbWU6IHsKICAgICAgICAgIHRpbWVzdGFtcDogZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgICAgfSwKICAgICAgfSwKICAgIH0pOwoKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSBzZXNzaW9uRGF0YS5pdGVtc1swXTsKICAgIGNvbnNvbGUubG9nKCJkZWZhdWx0cGF5bG9hZCBpdGVtcyIsIEpTT04uc3RyaW5naWZ5KGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMpKQoKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUgPSBzZXNzaW9uRGF0YS5xdW90ZVswXTsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlLnByaWNlID0gewogICAgICBjdXJyZW5jeTogIklOUiIsCiAgICAgIHZhbHVlOiBjYWxjdWxhdGVRdW90ZVByaWNlKGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUuYnJlYWt1cCksCiAgICB9OwoKICB9CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KICBpZiAoQXJyYXkuaXNBcnJheShzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXMpICYmCiAgICBzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXMubGVuZ3RoID4gMCkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5jYW5jZWxsYXRpb25fdGVybXMgPQogICAgICBzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXNbMF07CiAgfQogIGlmIChzZXNzaW9uRGF0YS5saW5rZWRfb3JkZXIpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXJbIkBvbmRjL29yZy9saW5rZWRfb3JkZXIiXSA9CiAgICAgIHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlclswXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YT8uY29uZmlybV9jcmVhdGVfYXRfdGltZXN0YW1wKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNyZWF0ZWRfYXQgPQogICAgICBzZXNzaW9uRGF0YT8uY29uZmlybV9jcmVhdGVfYXRfdGltZXN0YW1wWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci51cGRhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CiAgY29uc29sZS5sb2coImV4aXN0aW5nIHBheWxvYWQgaW4gb25fY2FuY2VsIiwgSlNPTi5zdHJpbmdpZnkoZGVmYXVsdFBheWxvYWQpKTsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_cancel
          timestamp: '2026-02-15T18:08:05.976Z'
          transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
          message_id: eaebbbdb-de31-48fd-acea-c8883633e729
          bap_id: bap.example.com
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: bpp.example.com
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            id: f86ecba049b741e9b162057c09a4aabe
            state: Cancelled
            provider:
              id: DTDC
            cancellation:
              cancelled_by: devapigateway.bizom.in/ondc
              reason:
                id: '005'
            items:
              - id: B2C SMART EXPRESS
                category_id: Standard Delivery
                fulfillment_id: '1'
                descriptor:
                  code: P2H2P
            quote:
              price:
                currency: INR
                value: '77.00'
              breakup:
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '63.14'
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '13.86'
            billing:
              name: Bizom
              email: ondchelp@mobisy.com
              phone: '9886193962'
              address:
                name: Bizom
                locality: Bellandur Main Rd
                city: Bengaluru
                state: Karnataka
                country: India
                building: Sri Arunachaleshwara Building
                area_code: '560103'
              tax_number: 29AAFCM4341L1Z6
              created_at: '2024-09-02T09:53:28.649Z'
              updated_at: '2024-09-02T09:53:28.649Z'
            payment:
              type: POST-FULFILLMENT
              collected_by: BAP
              status: NOT-PAID
            '@ondc/org/linked_order':
              items:
                - category_id: Grocery
                  descriptor:
                    name: >-
                      Surya Pickle Mirchi (Red Chilli) Powder 500g |Suitable for
                      Pickling
                  quantity:
                    count: 1
                    measure:
                      unit: kilogram
                      value: 0.5
                  price:
                    currency: INR
                    value: '70.0'
              provider:
                address:
                  name: Shailja Rajput
                  locality: Central Jail Road Sarjapur
                  city: Bangalore
                  state: Karnataka
                  country: IND
                  building: Silverwood Regency Apartment
                  area_code: '560103'
                descriptor:
                  name: Bizom Mart
              order:
                id: 2024-09-02-955623
                weight:
                  unit: kilogram
                  value: 0.5
                dimensions:
                  length:
                    unit: centimeter
                    value: 4
                  breadth:
                    unit: centimeter
                    value: 10
                  height:
                    unit: centimeter
                    value: 12
            fulfillments:
              - id: '1'
                type: Delivery
                state:
                  descriptor:
                    code: Cancelled
                    name: Cancelled
                start:
                  location:
                    gps: '12.927341,77.671691'
                    address:
                      name: Shailja Rajput
                      locality: Central Jail Road Sarjapur
                      city: Bangalore
                      state: Karnataka
                      country: IND
                      building: Silverwood Regency Apartment
                      area_code: '560103'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  person:
                    name: Shailja Rajput
                end:
                  location:
                    gps: '28.516106,77.114037'
                    address:
                      name: Delhi Address
                      locality: Avenue Jacaranda
                      city: New Delhi
                      state: Delhi
                      country: IND
                      building: Maheshwari Apartment
                      area_code: '110038'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  person:
                    name: Delhi Address
                tracking: true
                tags:
                  - code: precancel_state
                    list:
                      - code: fulfillment_state
                        value: Pending
                      - code: updated_at
                        value: '2024-09-02T09:50:49.631Z'
                '@ondc/org/awb_no': 7D2321486
            created_at: '2024-09-02T09:50:47.483Z'
            updated_at: '2024-09-02T09:50:47.985Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
      inputs: {}
transaction_history:
  - action_id: search_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: search
        timestamp: '2026-02-18T05:20:51.297Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: a84e9fcc-24a9-4443-9260-b26415e05975
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        intent:
          category:
            id: Immediate Delivery
          payment:
            type: POST-FULFILLMENT
          '@ondc/org/payload_details':
            weight:
              unit: kilogram
              value: 1
            value:
              currency: INR
              value: '388.5'
            dimensions:
              length:
                unit: meter
                value: 0.1
              breadth:
                unit: meter
                value: 0.1
              height:
                unit: meter
                value: 0.1
            category: F&B
          fulfillment:
            type: Delivery
            start:
              location:
                gps: '12.4535,77.9283'
                address:
                  area_code: '560001'
            end:
              location:
                gps: '12.4535,77.9283'
                address:
                  area_code: '560001'
          provider:
            time:
              days: '1,2,3,4,5,6,7'
              range:
                start: '0700'
                end: '2355'
              schedule:
                holidays:
                  - '2026-02-28'
                  - '2026-03-05'
              duration: PT10M
    action: search
    saved_info: {}
  - action_id: on_search_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: on_search
        timestamp: '2026-02-18T05:20:51.338Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: a84e9fcc-24a9-4443-9260-b26415e05975
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        catalog:
          bpp/descriptor:
            name: LSP Aggregator Inc
            tags:
              - code: bpp_terms
                list:
                  - code: static_terms
                    value: ''
                  - code: static_terms_new
                    value: >-
                      https://github.com/ONDC-Official/NP-Static-Terms/lspNP_LSP/1.0/tc.pdf
                  - code: effective_date
                    value: '2026-02-18T05:20:51.338Z'
          bpp/providers:
            - id: P1
              descriptor:
                name: LSP Courier Inc
                short_desc: LSP Courier Inc
                long_desc: LSP Courier Inc
              categories:
                - id: Immediate Delivery
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-18'
              fulfillments:
                - id: '1'
                  type: Delivery
                  start:
                    time:
                      duration: PT15M
                  tags:
                    - code: distance
                      list:
                        - code: motorable_distance_type
                          value: kilometer
                        - code: motorable_distance
                          value: '1.8'
                - id: '2'
                  type: RTO
              locations:
                - id: L1
                  gps: '12.967555,77.749666'
                  address:
                    street: Jayanagar 4th Block
                    city: Bengaluru
                    area_code: '560076'
                    state: KA
              items:
                - id: I1
                  parent_item_id: ''
                  category_id: Immediate Delivery
                  fulfillment_id: '1'
                  descriptor:
                    code: P2P
                    name: Fast delivery
                    short_desc: Fast delivery
                    long_desc: Fast delivery
                  price:
                    currency: INR
                    value: '59.00'
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-18'
                - id: I2
                  parent_item_id: I1
                  category_id: Immediate Delivery
                  fulfillment_id: '2'
                  descriptor:
                    code: P2P
                    name: RTO quote
                    short_desc: RTO quote
                    long_desc: RTO quote
                  price:
                    currency: INR
                    value: '23.60'
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-18'
    action: on_search
    saved_info: {}
  - action_id: init_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: init
        timestamp: '2026-02-18T05:20:51.378Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: ad3b6b7a-22b8-48ac-9c20-872ac7a024be
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        order:
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              category_id: Immediate Delivery
              descriptor:
                code: P2P
          fulfillments:
            - id: '1'
              type: Delivery
              start:
                location:
                  id: S1
                  gps: '12.4535,77.9283'
                  address:
                    name: My store name 1
                    building: My building name 1
                    locality: My street name 1
                    city: my city 1
                    state: my state 1
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: 'My house or building #'
                    building: My building name 2
                    locality: My street name 2
                    city: my city name 2
                    state: my state 2
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9123426789'
                  email: xyz.qweq@gmail.com
              tags: []
          billing:
            name: ONDC Logistics Buyer NP
            address:
              name: My house or building no
              building: My house or building name
              locality: Jayanagar
              city: Bengaluru
              state: Karnataka
              country: India
              area_code: '560076'
            tax_number: XXXXXXXXXXXXXXX
            phone: '9886098860'
            email: abcd.efgh@gmail.com
            created_at: '2026-02-18T05:20:51.378Z'
            updated_at: '2026-02-18T05:20:51.378Z'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
    action: init
    saved_info: {}
  - action_id: on_init_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: on_init
        timestamp: '2026-02-18T05:20:51.412Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: ad3b6b7a-22b8-48ac-9c20-872ac7a024be
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        order:
          provider:
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              descriptor:
                code: P2P
          fulfillments:
            - id: '1'
              type: Delivery
              start:
                location:
                  id: S1
                  gps: '12.4535,77.9283'
                  address:
                    name: My store name 1
                    building: My building name 1
                    locality: My street name 1
                    city: my city 1
                    state: my state 1
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: 'My house or building #'
                    building: My building name 2
                    locality: My street name 2
                    city: my city name 2
                    state: my state 2
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9123426789'
                  email: xyz.qweq@gmail.com
              tags:
                - code: rider_check
                  list:
                    - code: inline_check_for_rider
                      value: 'yes'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '50.00'
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': tax
                price:
                  currency: INR
                  value: '9.00'
            ttl: PT15M
            price:
              currency: INR
              value: '59.00'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
          cancellation_terms:
            - fulfillment_state:
                descriptor:
                  code: Pending
                  short_desc: 008
              cancellation_fee:
                percentage: '0.00'
                amount:
                  currency: INR
                  value: '0.00'
            - fulfillment_state:
                descriptor:
                  code: Agent-assigned
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Order-picked-up
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Out-for-delivery
                  short_desc: '011,012,013,014,015'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
          tags:
            - code: bpp_terms
              list:
                - code: max_liability
                  value: '2'
                - code: max_liability_cap
                  value: '10000'
                - code: mandatory_arbitration
                  value: 'false'
                - code: court_jurisdiction
                  value: Bengaluru
                - code: delay_interest
                  value: '1000'
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/protocol-network-extension/discussions/79
    action: on_init
    saved_info: {}
  - action_id: confirm_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: confirm
        timestamp: '2026-02-18T05:20:52.443Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: ad901b51-f410-40b3-8f18-04135ea8400f
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        order:
          id: bc6df56a-b938-40ac-8f82-5e7cc5fc6830
          state: Created
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              category_id: Immediate Delivery
              descriptor:
                code: P2P
              time:
                label: TAT
                duration: PT60M
                timestamp: '2026-02-18'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '50.00'
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': tax
                price:
                  currency: INR
                  value: '9.00'
            price:
              currency: INR
              value: '59.00'
          fulfillments:
            - id: '1'
              type: Delivery
              '@ondc/org/awb_no': '1227262193237777'
              start:
                time:
                  duration: PT15M
                person:
                  name: person_name_1
                location:
                  gps: '12.4535445,77.9283792'
                  address:
                    name: Store name
                    building: House or building name
                    locality: Locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560041'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '2'
                  short_desc: value of PCC
                  long_desc: additional instructions for pickup
                  additional_desc:
                    content_type: text/html
                    url: 'https://reverse_qc_sop_form.htm'
              end:
                person:
                  name: person_name_2
                location:
                  gps: '12.453544,77.928379'
                  address:
                    name: 'My house #'
                    building: My house or building name
                    locality: locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560076'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '3'
                  short_desc: value of DCC
                  long_desc: additional instructions for delivery
              tags:
                - code: state
                  list:
                    - code: ready_to_ship
                      value: 'no'
                - code: rto_action
                  list:
                    - code: return_to_origin
                      value: 'yes'
          billing:
            name: ONDC Logistics Buyer NP
            address:
              name: My house or building no
              building: My house or building name
              locality: Jayanagar
              city: Bengaluru
              state: Karnataka
              country: India
              area_code: '560076'
            tax_number: XXXXXXXXXXXXXXX
            phone: '9886098860'
            email: abcd.efgh@gmail.com
            created_at: '2026-02-18T05:20:51.378Z'
            updated_at: '2026-02-18T05:20:51.378Z'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
          '@ondc/org/linked_order':
            items:
              - category_id: F&B
                descriptor:
                  name: Item1
                quantity:
                  count: 2
                  measure:
                    unit: kilogram
                    value: 1
                price:
                  currency: INR
                  value: '70.00'
            provider:
              descriptor:
                name: Seller1
              address:
                name: My store name 1
                building: My building name 1
                locality: My street name 1
                city: my city 1
                state: my state 1
                area_code: '560001'
            order:
              id: O1
              weight:
                unit: kilogram
                value: 3
              dimensions:
                length:
                  unit: centimeter
                  value: 1
                breadth:
                  unit: centimeter
                  value: 1
                height:
                  unit: centimeter
                  value: 1
          tags:
            - code: bpp_terms
              list:
                - code: max_liability
                  value: '2'
                - code: max_liability_cap
                  value: '10000'
                - code: mandatory_arbitration
                  value: 'false'
                - code: court_jurisdiction
                  value: Bengaluru
                - code: delay_interest
                  value: '1000'
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/protocol-network-extension/discussions/79
            - code: bap_terms
              list:
                - code: accept_bpp_terms
                  value: 'Y'
          created_at: '2026-02-18T05:20:52.443Z'
          updated_at: '2026-02-18T05:20:52.443Z'
          cancellation_terms:
            - fulfillment_state:
                descriptor:
                  code: Pending
                  short_desc: 008
              cancellation_fee:
                percentage: '0.00'
                amount:
                  currency: INR
                  value: '0.00'
            - fulfillment_state:
                descriptor:
                  code: Agent-assigned
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Order-picked-up
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Out-for-delivery
                  short_desc: '011,012,013,014,015'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
    action: confirm
    saved_info: {}
  - action_id: on_confirm_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: on_confirm
        timestamp: '2026-02-18T05:20:52.472Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: ad901b51-f410-40b3-8f18-04135ea8400f
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        order:
          id: bc6df56a-b938-40ac-8f82-5e7cc5fc6830
          state: Accepted
          provider:
            id: Delhivery
          items:
            - id: I1
              fulfillment_id: '1'
              category_id: Immediate Delivery
              descriptor:
                code: P2P
              time:
                label: TAT
                duration: PT60M
                timestamp: '2026-02-18'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '50.00'
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': tax
                price:
                  currency: INR
                  value: '9.00'
            price:
              currency: INR
              value: '59.00'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
          fulfillments:
            - id: '1'
              type: Delivery
              '@ondc/org/awb_no': '1227262193237777'
              start:
                time:
                  duration: PT15M
                person:
                  name: person_name_1
                location:
                  gps: '12.4535445,77.9283792'
                  address:
                    name: Store name
                    building: House or building name
                    locality: Locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560041'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '2'
                  short_desc: value of PCC
                  long_desc: additional instructions for pickup
                  additional_desc:
                    content_type: text/html
                    url: 'https://reverse_qc_sop_form.htm'
              end:
                person:
                  name: person_name_2
                location:
                  gps: '12.453544,77.928379'
                  address:
                    name: 'My house #'
                    building: My house or building name
                    locality: locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560076'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '3'
                  short_desc: value of DCC
                  long_desc: additional instructions for delivery
              tags:
                - code: state
                  list:
                    - code: ready_to_ship
                      value: 'no'
                - code: rto_action
                  list:
                    - code: return_to_origin
                      value: 'yes'
                - code: weather_check
                  list:
                    - code: raining
                      value: 'no'
              state:
                descriptor:
                  code: Pending
              tracking: true
          billing:
            name: ONDC Logistics Buyer NP
            address:
              name: My house or building no
              building: My house or building name
              locality: Jayanagar
              city: Bengaluru
              state: Karnataka
              country: India
              area_code: '560076'
            tax_number: XXXXXXXXXXXXXXX
            phone: '9886098860'
            email: abcd.efgh@gmail.com
            created_at: '2026-02-18T05:20:51.378Z'
            updated_at: '2026-02-18T05:20:51.378Z'
          '@ondc/org/linked_order':
            items:
              - category_id: F&B
                descriptor:
                  name: Item1
                quantity:
                  count: 2
                  measure:
                    unit: kilogram
                    value: 1
                price:
                  currency: INR
                  value: '70.00'
            provider:
              descriptor:
                name: Seller1
              address:
                name: My store name 1
                building: My building name 1
                locality: My street name 1
                city: my city 1
                state: my state 1
                area_code: '560001'
            order:
              id: O1
              weight:
                unit: kilogram
                value: 3
              dimensions:
                length:
                  unit: centimeter
                  value: 1
                breadth:
                  unit: centimeter
                  value: 1
                height:
                  unit: centimeter
                  value: 1
          created_at: '2026-02-18T05:20:52.443Z'
          updated_at: '2026-02-18T05:20:52.472Z'
          cancellation_terms:
            - fulfillment_state:
                descriptor:
                  code: Pending
                  short_desc: 008
              cancellation_fee:
                percentage: '0.00'
                amount:
                  currency: INR
                  value: '0.00'
            - fulfillment_state:
                descriptor:
                  code: Agent-assigned
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Order-picked-up
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Out-for-delivery
                  short_desc: '011,012,013,014,015'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
          tags:
            - code: bpp_terms
              list:
                - code: max_liability
                  value: '2'
                - code: max_liability_cap
                  value: '10000'
                - code: mandatory_arbitration
                  value: 'false'
                - code: court_jurisdiction
                  value: Bengaluru
                - code: delay_interest
                  value: '1000'
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/protocol-network-extension/discussions/79
            - code: bap_terms
              list:
                - code: accept_bpp_terms
                  value: 'Y'
    action: on_confirm
    saved_info: {}
  - action_id: cancel_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: cancel
        timestamp: '2026-02-18T05:20:54.605Z'
        transaction_id: 6e84a54d-f119-4a17-bc51-2a34a7e5ed22
        message_id: cbfb5e82-94d7-4f8c-87d5-907a1a862bcf
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        order_id: bc6df56a-b938-40ac-8f82-5e7cc5fc6830
        cancellation_reason_id: '005'
    action: cancel
    saved_info: {}
validationLib: ''
helperLib: >-
  LyoKICBDdXN0b20gaGVscGVyIGZ1bmN0aW9ucyBhdmFpbGFibGUgaW4gYWxsIG1vY2sgZ2VuZXJhdGlvbiBmdW5jdGlvbnMuCiAgdGhlc2UgYXJlIGFwcGVuZGVkIGJlbG93IHRoZSBnZW5lcmF0ZSBmdW5jdGlvbiBmb3IgZWFjaCBzdGVwLgoqLwoKLy8gR2VuZXJhdGVzIGEgVVVJRCB2NApmdW5jdGlvbiB1dWlkdjQoKSB7CiAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHsKICAgIGNvbnN0IHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwOwogICAgY29uc3QgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7CiAgICByZXR1cm4gdi50b1N0cmluZygxNik7CiAgfSk7Cn0KCi8vIEdlbmVyYXRlIGEgNiBkaWdpdCBzdHJpbmcgSUQKZnVuY3Rpb24gZ2VuZXJhdGU2RGlnaXRJZCgpIHsKICByZXR1cm4gTWF0aC5mbG9vcigxMDAwMDAgKyBNYXRoLnJhbmRvbSgpICogOTAwMDAwKS50b1N0cmluZygpOwp9CgovLyBSZXR1cm5zIHRoZSBjdXJyZW50IElTTyB0aW1lc3RhbXAKZnVuY3Rpb24gY3VycmVudFRpbWVzdGFtcCgpIHsKICByZXR1cm4gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOwp9CgovLyBDb252ZXJ0cyBJU08gODYwMSBkdXJhdGlvbiBzdHJpbmcgdG8gdG90YWwgc2Vjb25kcwpjb25zdCBpc29EdXJUb1NlYyA9IChkdXJhdGlvbikgPT4gewogIGNvbnN0IGR1clJFID0gL1AoKGQrKVkpPygoZCspTSk/KChkKylXKT8oKGQrKUQpP1Q/KChkKylIKT8oKGQrKU0pPygoZCspUyk/LzsKICBjb25zdCBzID0gZHVyUkUuZXhlYyhkdXJhdGlvbik7CiAgaWYgKCFzKSByZXR1cm4gMDsKCiAgcmV0dXJuIChOdW1iZXIocz8uWzJdKSB8fCAwKSAqIDMxNTM2MDAwICsKICAgIChOdW1iZXIocz8uWzRdKSB8fCAwKSAqIDI2MjgyODggKwogICAgKE51bWJlcihzPy5bNl0pIHx8IDApICogNjA0ODAwICsKICAgIChOdW1iZXIocz8uWzhdKSB8fCAwKSAqIDg2NDAwICsKICAgIChOdW1iZXIocz8uWzEwXSkgfHwgMCkgKiAzNjAwICsKICAgIChOdW1iZXIocz8uWzEyXSkgfHwgMCkgKiA2MCArCiAgICAoTnVtYmVyKHM/LlsxNF0pIHx8IDApOwp9OwoKCmZ1bmN0aW9uIGRlbGF5KG1zKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7Cn0KCmZ1bmN0aW9uIGdldFRpbWVzdGFtcEZyb21EdXJhdGlvbigKICBkYXRlLAogIGR1cmF0aW9uCikgewogIGNvbnNvbGUubG9nKCJkdXJhdGlvTiIsIGR1cmF0aW9uKTsKICBjb25zdCBkdXJhdGlvblJlZ2V4ID0gL1AoPzooXGQrKUQpPyg/OlQoPzooXGQrKUgpPyg/OihcZCspTSk/KD86KFxkKylTKT8pPy87CiAgY29uc3QgbWF0Y2ggPSBkdXJhdGlvbi5tYXRjaChkdXJhdGlvblJlZ2V4KTsKCiAgaWYgKCFtYXRjaCkgewogICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIElTTyA4NjAxIGR1cmF0aW9uIGZvcm1hdCIpOwogIH0KCiAgY29uc3QgZGF5cyA9IG1hdGNoWzFdID8gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKSB8fCAwIDogMDsKICBjb25zdCBob3VycyA9IG1hdGNoWzJdID8gcGFyc2VJbnQobWF0Y2hbMl0sIDEwKSB8fCAwIDogMDsKICBjb25zdCBtaW51dGVzID0gbWF0Y2hbM10gPyBwYXJzZUludChtYXRjaFszXSwgMTApIHx8IDAgOiAwOwogIGNvbnN0IHNlY29uZHMgPSBtYXRjaFs0XSA/IHBhcnNlSW50KG1hdGNoWzRdLCAxMCkgfHwgMCA6IDA7CgogIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZShkYXRlKTsKICBmdXR1cmVEYXRlLnNldERhdGUoZnV0dXJlRGF0ZS5nZXREYXRlKCkgKyBkYXlzKTsKICBmdXR1cmVEYXRlLnNldEhvdXJzKGZ1dHVyZURhdGUuZ2V0SG91cnMoKSArIGhvdXJzKTsKICBmdXR1cmVEYXRlLnNldE1pbnV0ZXMoZnV0dXJlRGF0ZS5nZXRNaW51dGVzKCkgKyBtaW51dGVzKTsKICBmdXR1cmVEYXRlLnNldFNlY29uZHMoZnV0dXJlRGF0ZS5nZXRTZWNvbmRzKCkgKyBzZWNvbmRzKTsKCiAgcmV0dXJuIGZ1dHVyZURhdGUudG9JU09TdHJpbmcoKTsKfQoKZnVuY3Rpb24gcmVtb3ZlVGFnc0J5Q29kZXModGFncywgY29kZXNUb1JlbW92ZSkgewogIHJldHVybiB0YWdzLmZpbHRlcigodGFnKSA9PiAhY29kZXNUb1JlbW92ZS5pbmNsdWRlcyh0YWcuY29kZSkpOwp9CgpmdW5jdGlvbiBnZXRGdXR1cmVEYXRlKGRheXNBaGVhZCkgewogIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZSgpOwogIGZ1dHVyZURhdGUuc2V0RGF0ZShmdXR1cmVEYXRlLmdldERhdGUoKSArIGRheXNBaGVhZCk7CgogIHJldHVybiBmdXR1cmVEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoIlQiKVswXTsKfQoKZnVuY3Rpb24gaXNFbXB0eShvYmopIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7Cn0KCmNvbnN0IGdldEZ1dHVyZURhdGVJbk1pbnV0ZXMgPSAobWludXRlcykgPT4gewogIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgY29uc3QgZnV0dXJlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSArIG1pbnV0ZXMgKiA2MCAqIDEwMDApOwogIHJldHVybiBmdXR1cmUudG9JU09TdHJpbmcoKTsKfTsKLy8gZnVuY3Rpb24gZ2V0T3JkZXJQcmVwVGltZShjYXRlZ29yeSkgewovLyAgIGNvbnN0IFRhdE1hcHBpbmcgPSB7Ci8vICAgICAiSW1tZWRpYXRlIERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUFQ2ME0iLAovLyAgICAgICBkYXk6IDAsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQVDE1TSIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDEwTSIsCi8vICAgICB9LAovLyAgICAgIlNhbWUgRGF5IERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUFQ0SCIsCi8vICAgICAgIGRheTogMCwKLy8gICAgICAgcGlja3VwVGltZTogIlBUMUgiLAovLyAgICAgICBvcmRlclByZXBUaW1lOiAiUFQxSCIsCi8vICAgICB9LAovLyAgICAgIk5leHQgRGF5IERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUDFEIiwKLy8gICAgICAgZGF5OiAxLAovLyAgICAgICBwaWNrdXBUaW1lOiAiUFQ0SCIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDRIIiwKLy8gICAgIH0sCi8vICAgICAiU3RhbmRhcmQgRGVsaXZlcnkiOiB7Ci8vICAgICAgIGNvZGU6ICJQMkQiLAovLyAgICAgICBkYXk6IDIsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQVDEySCIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDEySCIsCi8vICAgICB9LAovLyAgICAgIkV4cHJlc3MgRGVsaXZlcnkiOiB7Ci8vICAgICAgIGNvZGU6ICJQM0QiLAovLyAgICAgICBkYXk6IDIsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQMUQiLAovLyAgICAgICBvcmRlclByZXBUaW1lOiAiUDFEIiwKLy8gICAgIH0sCi8vICAgICAiSW5zdGFudCBEZWxpdmVyeSI6IHsKLy8gICAgICAgY29kZTogIlBUMTBNIiwKLy8gICAgICAgZGF5OiAwLAovLyAgICAgICBwaWNrdXBUaW1lOiAiUFQyTSIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDJNIiwKLy8gICAgIH0sCi8vICAgfTsKLy8gICByZXR1cm4gVGF0TWFwcGluZ1tjYXRlZ29yeV0/Lm9yZGVyUHJlcFRpbWUgfHwgbnVsbDsKLy8gfTsKCgpjb25zdCBnZW5lcmF0ZVF1b3RlVHJhaWwgPSAoCiAgYnJlYWt1cCwKICBpdGVtcywKICBvcHRpb25zLAogIHBhcmVudEl0ZW1JZAopID0+IHsKICBjb25zdCB7CiAgICBmdWxmaWxsbWVudFN0YXRlID0gIlBSRSIsCiAgICBpc1JUTyA9IGZhbHNlLAogICAgcGFydENhbmNlbCA9IGZhbHNlLAogIH0gPSBvcHRpb25zOwogIGNvbnN0IHF1b3RlVHJhaWxUYWdzID0gW107CgogIGZ1bmN0aW9uIGV4dHJhY3RUeXBlKHRhZ3MpIHsKICAgIGNvbnN0IHR5cGVUYWcgPSB0YWdzLmZpbmQoKHRhZykgPT4gdGFnLmNvZGUgPT09ICJ0eXBlIik7CiAgICBpZiAoIXR5cGVUYWcgfHwgIXR5cGVUYWcubGlzdCkgcmV0dXJuIG51bGw7CgogICAgY29uc3QgdHlwZUl0ZW0gPSB0eXBlVGFnLmxpc3QuZmluZCgoaXRlbSkgPT4gaXRlbS5jb2RlID09PSAidHlwZSIpOwogICAgcmV0dXJuIHR5cGVJdGVtID8gdHlwZUl0ZW0udmFsdWUgOiBudWxsOwogIH0KCiAgYnJlYWt1cC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICBpZiAoCiAgICAgIGl0ZW1bIkBvbmRjL29yZy90aXRsZV90eXBlIl0gPT09ICJkZWxpdmVyeSIgfHwKICAgICAgaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSA9PT0gInBhY2tpbmciCiAgICApIHsKICAgICAgaWYgKGZ1bGZpbGxtZW50U3RhdGUgPT09ICJQUkUiICYmICFwYXJ0Q2FuY2VsKSB7CiAgICAgICAgcXVvdGVUcmFpbFRhZ3MucHVzaCh7CiAgICAgICAgICBjb2RlOiAicXVvdGVfdHJhaWwiLAogICAgICAgICAgbGlzdDogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogInR5cGUiLAogICAgICAgICAgICAgIHZhbHVlOiBpdGVtWyJAb25kYy9vcmcvdGl0bGVfdHlwZSJdLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogImlkIiwKICAgICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL2l0ZW1faWQiXSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgICAgICAgICAgICAgdmFsdWU6ICJJTlIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogInZhbHVlIiwKICAgICAgICAgICAgICB2YWx1ZTogYC0ke2l0ZW0ucHJpY2UudmFsdWV9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSA9PT0gIm9mZmVyIikgewogICAgICBxdW90ZVRyYWlsVGFncy5wdXNoKHsKICAgICAgICBjb2RlOiAicXVvdGVfdHJhaWwiLAogICAgICAgIGxpc3Q6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogInR5cGUiLAogICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJpZCIsCiAgICAgICAgICAgIHZhbHVlOiBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogImN1cnJlbmN5IiwKICAgICAgICAgICAgdmFsdWU6ICJJTlIiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogInZhbHVlIiwKICAgICAgICAgICAgdmFsdWU6IGAke01hdGguYWJzKHBhcnNlSW50KGl0ZW0ucHJpY2UudmFsdWUpKX1gLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoCiAgICAgIHBhcnNlSW50KGl0ZW0ucHJpY2UudmFsdWUpICE9PSAwICYmCiAgICAgICghcGFyZW50SXRlbUlkIHx8IGl0ZW0/Lml0ZW0/LnBhcmVudF9pdGVtX2lkID09PSBwYXJlbnRJdGVtSWQpCiAgICApIHsKICAgICAgY29uc29sZS5sb2coIml0ZW1zOiIsIGl0ZW1zKTsKICAgICAgY29uc29sZS5sb2coIml0ZW17YXNkYXMiLCBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdKTsKCiAgICAgIGNvbnN0IHRhZ3MgPSBpdGVtcy5maW5kKAogICAgICAgIChhbGxJdGVtKSA9PiBhbGxJdGVtLmlkID09PSBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdCiAgICAgICkudGFnczsKICAgICAgY29uc3Qgc3ViVHlwZSA9IGV4dHJhY3RUeXBlKHRhZ3MpOwoKICAgICAgcXVvdGVUcmFpbFRhZ3MucHVzaCh7CiAgICAgICAgY29kZTogInF1b3RlX3RyYWlsIiwKICAgICAgICBsaXN0OiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJ0eXBlIiwKICAgICAgICAgICAgdmFsdWU6IGl0ZW1bIkBvbmRjL29yZy90aXRsZV90eXBlIl0sCiAgICAgICAgICB9LAogICAgICAgICAgLi4uKHN1YlR5cGUKICAgICAgICAgICAgPyBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29kZTogInN1YnR5cGUiLAogICAgICAgICAgICAgICAgdmFsdWU6IHN1YlR5cGUsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXQogICAgICAgICAgICA6IFtdKSwKCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJwYXJlbnRfaXRlbV9pZCIsCiAgICAgICAgICAgIHZhbHVlOiBpdGVtLml0ZW0ucGFyZW50X2l0ZW1faWQsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBjb2RlOiAiaWQiLAogICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL2l0ZW1faWQiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgICAgICAgICAgIHZhbHVlOiAiSU5SIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJ2YWx1ZSIsCiAgICAgICAgICAgIHZhbHVlOiBgLSR7aXRlbS5wcmljZS52YWx1ZX1gLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9KTsKICAgIH0KICB9KTsKCiAgLy8gaWYgKGlzUlRPKSB7CiAgLy8gICBxdW90ZVRyYWlsVGFncy5wdXNoKHsKICAvLyAgICAgY29kZTogInF1b3RlX3RyYWlsIiwKICAvLyAgICAgbGlzdDogWwogIC8vICAgICAgIHsKICAvLyAgICAgICAgIGNvZGU6ICJ0eXBlIiwKICAvLyAgICAgICAgIHZhbHVlOiAiZGVsaXZlcnkiLAogIC8vICAgICAgIH0sCiAgLy8gICAgICAgewogIC8vICAgICAgICAgY29kZTogImlkIiwKICAvLyAgICAgICAgIHZhbHVlOiAiRjEtUlRPIiwKICAvLyAgICAgICB9LAogIC8vICAgICAgIHsKICAvLyAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgLy8gICAgICAgICB2YWx1ZTogIklOUiIsCiAgLy8gICAgICAgfSwKICAvLyAgICAgICB7CiAgLy8gICAgICAgICBjb2RlOiAidmFsdWUiLAogIC8vICAgICAgICAgdmFsdWU6IGA1MGAsCiAgLy8gICAgICAgfSwKICAvLyAgICAgXSwKICAvLyAgIH0pOwogIC8vIH0KCiAgcmV0dXJuIHF1b3RlVHJhaWxUYWdzOwp9OwoKZnVuY3Rpb24gcmVzZXRRdW90ZVByaWNlcyhxdW90ZSkgewogIC8vIEEgaGVscGVyIHRvIGNvbnZlcnQgYW55IHByaWNlIHZhbHVlIGludG8gemVybyB3aXRoIHNhbWUgZGVjaW1hbCBmb3JtYXQKICBjb25zdCB0b1plcm9Gb3JtYXR0ZWQgPSAodmFsdWUpID0+IHsKICAgIGNvbnN0IGRlY2ltYWxzID0gdmFsdWUuaW5jbHVkZXMoIi4iKSA/IHZhbHVlLnNwbGl0KCIuIilbMV0ubGVuZ3RoIDogMDsKICAgIHJldHVybiAoMCkudG9GaXhlZChkZWNpbWFscyk7CiAgfTsKCiAgcmV0dXJuIHsKICAgIC4uLnF1b3RlLAogICAgYnJlYWt1cDogcXVvdGUuYnJlYWt1cC5tYXAoKGl0ZW0pID0+ICh7CiAgICAgIC4uLml0ZW0sCiAgICAgIHByaWNlOiB7CiAgICAgICAgLi4uaXRlbS5wcmljZSwKICAgICAgICB2YWx1ZTogdG9aZXJvRm9ybWF0dGVkKGl0ZW0ucHJpY2UudmFsdWUpCiAgICAgIH0KICAgIH0pKSwKICAgIHByaWNlOiB7CiAgICAgIC4uLnF1b3RlLnByaWNlLAogICAgICB2YWx1ZTogdG9aZXJvRm9ybWF0dGVkKHF1b3RlLnByaWNlLnZhbHVlKQogICAgfQogIH07Cn0KCmZ1bmN0aW9uIG1lcmdlRnVsZmlsbG1lbnRUYWdzKAogIGV4aXN0aW5nVGFncyA9IFtdLAogIG5ld1RhZ3MgPSBbXQopIHsKICBjb25zdCBtZXJnZWQgPSBbXTsKCiAgLy8gUGljayBMQVNUIG9jY3VycmVuY2UgZnJvbSBuZXdUYWdzIChhdXRob3JpdGF0aXZlKQogIGNvbnN0IG5ld0xpbmtlZE9yZGVyID0gWy4uLm5ld1RhZ3NdCiAgICAucmV2ZXJzZSgpCiAgICAuZmluZCh0ID0+IHQuY29kZSA9PT0gImxpbmtlZF9vcmRlciIpOwoKICBjb25zdCBuZXdMaW5rZWRQcm92aWRlciA9IFsuLi5uZXdUYWdzXQogICAgLnJldmVyc2UoKQogICAgLmZpbmQodCA9PiB0LmNvZGUgPT09ICJsaW5rZWRfcHJvdmlkZXIiKTsKCiAgbGV0IGxpbmtlZE9yZGVyQWRkZWQgPSBmYWxzZTsKICBsZXQgbGlua2VkUHJvdmlkZXJBZGRlZCA9IGZhbHNlOwoKICAvLyAx77iP4oOjIFByb2Nlc3MgZXhpc3RpbmcgdGFncwogIGZvciAoY29uc3QgdGFnIG9mIGV4aXN0aW5nVGFncykgewogICAgaWYgKHRhZy5jb2RlID09PSAibGlua2VkX29yZGVyIikgewogICAgICBpZiAoIWxpbmtlZE9yZGVyQWRkZWQpIHsKICAgICAgICBtZXJnZWQucHVzaChuZXdMaW5rZWRPcmRlciA/PyB0YWcpOwogICAgICAgIGxpbmtlZE9yZGVyQWRkZWQgPSB0cnVlOwogICAgICB9CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmICh0YWcuY29kZSA9PT0gImxpbmtlZF9wcm92aWRlciIpIHsKICAgICAgaWYgKCFsaW5rZWRQcm92aWRlckFkZGVkKSB7CiAgICAgICAgbWVyZ2VkLnB1c2gobmV3TGlua2VkUHJvdmlkZXIgPz8gdGFnKTsKICAgICAgICBsaW5rZWRQcm92aWRlckFkZGVkID0gdHJ1ZTsKICAgICAgfQogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBtZXJnZWQucHVzaCh0YWcpOwogIH0KCiAgLy8gMu+4j+KDoyBBZGQgbWlzc2luZyBzaW5nbGV0b24gdGFncwogIGlmIChuZXdMaW5rZWRPcmRlciAmJiAhbGlua2VkT3JkZXJBZGRlZCkgewogICAgbWVyZ2VkLnB1c2gobmV3TGlua2VkT3JkZXIpOwogIH0KCiAgaWYgKG5ld0xpbmtlZFByb3ZpZGVyICYmICFsaW5rZWRQcm92aWRlckFkZGVkKSB7CiAgICBtZXJnZWQucHVzaChuZXdMaW5rZWRQcm92aWRlcik7CiAgfQoKICAvLyAz77iP4oOjIEFkZCBOT04tc2luZ2xldG9uIG5ldyB0YWdzIChkZWR1cC1zYWZlKQogIGZvciAoY29uc3QgdGFnIG9mIG5ld1RhZ3MpIHsKICAgIGlmICgKICAgICAgdGFnLmNvZGUgIT09ICJsaW5rZWRfb3JkZXIiICYmCiAgICAgIHRhZy5jb2RlICE9PSAibGlua2VkX3Byb3ZpZGVyIgogICAgKSB7CiAgICAgIG1lcmdlZC5wdXNoKHRhZyk7CiAgICB9CiAgfQoKICByZXR1cm4gbWVyZ2VkOwp9Cgpjb25zdCBnZXRQYXltZW50U3RhdHVzID0gKHBheW1lbnRUeXBlLCBvcmRlclN0YXRlKSA9PiB7CiAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tRlVMRklMTE1FTlQiICYmIG9yZGVyU3RhdGUgPT09ICJDb21wbGV0ZWQiKSB7CiAgICByZXR1cm4gIlBBSUQiOwogIH0KCiAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tT1JERVIiKSB7CiAgICByZXR1cm4gIlBBSUQiOwogIH0KCiAgaWYgKHBheW1lbnRUeXBlID09PSAiUE9TVC1GVUxGSUxMTUVOVCIpIHsKICAgIHJldHVybiAiTk9ULVBBSUQiOwogIH0KCiAgcmV0dXJuICJOT1QtUEFJRCI7Cn07CgpmdW5jdGlvbiByZXNldFF1b3RlUHJpY2VzKHF1b3RlKSB7CiAgLy8gQSBoZWxwZXIgdG8gY29udmVydCBhbnkgcHJpY2UgdmFsdWUgaW50byB6ZXJvIHdpdGggc2FtZSBkZWNpbWFsIGZvcm1hdAogIGNvbnN0IHRvWmVyb0Zvcm1hdHRlZCA9ICh2YWx1ZSkgPT4gewogICAgY29uc3QgZGVjaW1hbHMgPSB2YWx1ZS5pbmNsdWRlcygiLiIpID8gdmFsdWUuc3BsaXQoIi4iKVsxXS5sZW5ndGggOiAwOwogICAgcmV0dXJuICgwKS50b0ZpeGVkKGRlY2ltYWxzKTsKICB9OwoKICByZXR1cm4gewogICAgLi4ucXVvdGUsCiAgICBicmVha3VwOiBxdW90ZS5icmVha3VwLm1hcCgoaXRlbSkgPT4gKHsKICAgICAgLi4uaXRlbSwKICAgICAgcHJpY2U6IHsKICAgICAgICAuLi5pdGVtLnByaWNlLAogICAgICAgIHZhbHVlOiB0b1plcm9Gb3JtYXR0ZWQoaXRlbS5wcmljZS52YWx1ZSkKICAgICAgfQogICAgfSkpLAogICAgcHJpY2U6IHsKICAgICAgLi4ucXVvdGUucHJpY2UsCiAgICAgIHZhbHVlOiB0b1plcm9Gb3JtYXR0ZWQocXVvdGUucHJpY2UudmFsdWUpCiAgICB9CiAgfTsKfQoKZnVuY3Rpb24gY2FsY3VsYXRlUXVvdGVQcmljZShicmVha3VwKSB7CiAgbGV0IHRvdGFsUHJpY2UgPSAwOwogIGJyZWFrdXAuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgdG90YWxQcmljZSArPSBwYXJzZUZsb2F0KGl0ZW0ucHJpY2UudmFsdWUpIHx8IDA7CiAgfSk7CgogIHJldHVybiB0b3RhbFByaWNlLnRvRml4ZWQoMik7IC8vIHJldHVybnMgYSBzdHJpbmcgd2l0aCAyIGRlY2ltYWwgcGxhY2VzCn07Cg==
