meta:
  domain: 'nic2004:60232'
  version: 1.2.0
  flowId: ORDER_FLOW_BASELINE(without rts)
transaction_data:
  transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
  latest_timestamp: '1970-01-01T00:00:00.000Z'
  bap_id: bap.example.com
  bap_uri: 'https://bap.example.com'
  bpp_id: bpp.example.com
  bpp_uri: 'https://bpp.example.com'
steps:
  - api: search
    action_id: search_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICB0cnkgewogICAgY29uc3QgaW5wdXRzID0gc2Vzc2lvbkRhdGEudXNlcl9pbnB1dHM7CiAgICBjb25zdCBUYXRNYXBwaW5nID0gewogICAgICAiSW1tZWRpYXRlIERlbGl2ZXJ5IjogewogICAgICAgIGNvZGU6ICJQVDYwTSIsCiAgICAgICAgZGF5OiAwLAogICAgICAgIHBpY2t1cFRpbWU6ICJQVDE1TSIsCiAgICAgICAgb3JkZXJQcmVwVGltZTogIlBUMTBNIiwKICAgICAgfSwKICAgICAgIlNhbWUgRGF5IERlbGl2ZXJ5IjogewogICAgICAgIGNvZGU6ICJQVDRIIiwKICAgICAgICBkYXk6IDAsCiAgICAgICAgcGlja3VwVGltZTogIlBUMUgiLAogICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDFIIiwKICAgICAgfSwKICAgICAgIk5leHQgRGF5IERlbGl2ZXJ5IjogewogICAgICAgIGNvZGU6ICJQMUQiLAogICAgICAgIGRheTogMSwKICAgICAgICBwaWNrdXBUaW1lOiAiUFQ0SCIsCiAgICAgICAgb3JkZXJQcmVwVGltZTogIlBUNEgiLAogICAgICB9LAogICAgICAiU3RhbmRhcmQgRGVsaXZlcnkiOiB7CiAgICAgICAgY29kZTogIlAyRCIsCiAgICAgICAgZGF5OiAyLAogICAgICAgIHBpY2t1cFRpbWU6ICJQVDEySCIsCiAgICAgICAgb3JkZXJQcmVwVGltZTogIlBUMTJIIiwKICAgICAgfSwKICAgICAgIkV4cHJlc3MgRGVsaXZlcnkiOiB7CiAgICAgICAgY29kZTogIlAzRCIsCiAgICAgICAgZGF5OiAyLAogICAgICAgIHBpY2t1cFRpbWU6ICJQMUQiLAogICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQMUQiLAogICAgICB9LAogICAgICAiSW5zdGFudCBEZWxpdmVyeSI6IHsKICAgICAgICBjb2RlOiAiUFQxME0iLAogICAgICAgIGRheTogMCwKICAgICAgICBwaWNrdXBUaW1lOiAiUFQyTSIsCiAgICAgICAgb3JkZXJQcmVwVGltZTogIlBUMk0iLAogICAgICB9LAogICAgfTsKICAgIGNvbnNvbGUubG9nKCJpbnNpZGUgc2VhcmNoIGdlbmVyYXRvciIsIEpTT04uc3RyaW5naWZ5KHNlc3Npb25EYXRhLmNhdGVnb3J5KSk7CgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5pbnRlbnQucHJvdmlkZXIudGltZS5zY2hlZHVsZS5ob2xpZGF5cyA9IFsKICAgICAgZ2V0RnV0dXJlRGF0ZSgxMCksCiAgICAgIGdldEZ1dHVyZURhdGUoMTUpLAogICAgXTsKICAgIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQuY2l0eSA9IGlucHV0cy5jaXR5X2NvZGU7CgoKICAgIGlmIChpbnB1dHM/LmNhdGVnb3J5KSB7CiAgICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LmNhdGVnb3J5LmlkID0gaW5wdXRzLmNhdGVnb3J5OwogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmludGVudC5wYXltZW50LnR5cGUgPSBpbnB1dHMucGF5bWVudFR5cGU7CgogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmludGVudC5wcm92aWRlci50aW1lLmR1cmF0aW9uID0KICAgICAgICBUYXRNYXBwaW5nW2lucHV0cz8uY2F0ZWdvcnldLm9yZGVyUHJlcFRpbWU7CiAgICB9CgogICAgY29uc3QgZGVsaXZlcnlGdWxmaWxsbWVudCA9IHsKICAgICAgdHlwZTogIkRlbGl2ZXJ5IiwKICAgICAgc3RhcnQ6IHsKICAgICAgICBsb2NhdGlvbjogewogICAgICAgICAgZ3BzOiBpbnB1dHMuc3RhcnRfZ3BzLAogICAgICAgICAgYWRkcmVzczogewogICAgICAgICAgICBhcmVhX2NvZGU6IGlucHV0cy5zdGFydF9jb2RlCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBlbmQ6IHsKICAgICAgICBsb2NhdGlvbjogewogICAgICAgICAgZ3BzOiBpbnB1dHMuZW5kX2dwcywKICAgICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgICAgYXJlYV9jb2RlOiBpbnB1dHMuZW5kX2NvZGUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LmZ1bGZpbGxtZW50ID0gZGVsaXZlcnlGdWxmaWxsbWVudDsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmludGVudFsiQG9uZGMvb3JnL3BheWxvYWRfZGV0YWlscyJdLmNhdGVnb3J5ID0KICAgICAgaW5wdXRzPy5yZXRhaWxDYXRlZ29yeSB8fCAiR3JvY2VyeSI7CgogICAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwogIH0KICBjYXRjaCAoZSkgewogICAgY29uc29sZS5sb2coZSk7CiAgICByZXR1cm4gewogICAgICBjb250ZXh0OiBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LAogICAgICBlcnJvcjogZS5tZXNzYWdlID8/ICJ1bmtvd24iCiAgICB9CiAgfQp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: search
          core_version: 1.2.0
          bap_id: biz.test.bitsila.com
          bap_uri: 'https://biz.test.bitsila.com/ecc/ondc/logistics-bap'
          transaction_id: LOG-3849-1001-1179-M7K1
          message_id: 7667caff-182a-41b7-bda9-d7bca33dd98f
          timestamp: '2024-04-08T11:53:11.349Z'
          ttl: PT30S
        message:
          intent:
            category:
              id: Immediate Delivery
            payment:
              type: ON-ORDER
            '@ondc/org/payload_details':
              weight:
                unit: kilogram
                value: 1
              value:
                currency: INR
                value: '388.5'
              dimensions:
                length:
                  unit: meter
                  value: 0.1
                breadth:
                  unit: meter
                  value: 0.1
                height:
                  unit: meter
                  value: 0.1
              category: F&B
            fulfillment:
              type: Delivery
              start:
                location:
                  id: '3849:4120'
                  gps: '12.916691283211073, 77.64782934951943'
                  address:
                    area_code: '560102'
              end:
                location:
                  gps: '12.9180305, 77.6372603'
                  address:
                    area_code: '560102'
            provider:
              time:
                days: '1,2,3,4,5,6,7'
                range:
                  start: '0700'
                  end: '2355'
                schedule:
                  holidays: []
                duration: PT15M
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        category_id: $.message.intent.category.id
        start_location: $.message.intent.fulfillment.start.location.gps
        end_location: $.message.intent.fulfillment.end.location.gps
        start_area_code: $.message.intent.fulfillment.start.location.address.area_code
        end_area_code: $.message.intent.fulfillment.end.location.address.area_code
        payment_type: $.message.intent.payment.type
        city_code: $.context.city
        fulfillment: $.message.intent.fulfillment
        retail_category: '$.message.intent[''@ondc/org/payload_details''].category'
      inputs:
        id: LogisticsSearchInput
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            retailCategory:
              type: string
              description: Select retail item category
              enum:
                - F&B
                - Grocery
                - Fashion
                - BPC
                - Electronics
                - Appliances
                - Home & Kitchen
                - Health & Wellness
                - Pharma
                - Auto components
                - C2C parcels
              default: F&B
            category:
              type: string
              description: Select a delivery category
              enum:
                - Immediate Delivery
                - Standard Delivery
                - Express Delivery
                - Next Day Delivery
                - Same Day Delivery
              default: Immediate Delivery
            paymentType:
              type: string
              description: Select payment type
              enum:
                - POST-FULFILLMENT
                - ON-ORDER
                - ON-FULFILLMENT
              default: POST-FULFILLMENT
            city_code:
              type: string
              description: City STD code
              pattern: '^std:\d+$'
              default: 'std:080'
            start_gps:
              type: string
              description: 'Start GPS coordinates (lat,long)'
              pattern: >-
                ^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$
              default: '12.4535,77.9283'
            end_gps:
              type: string
              description: 'End GPS coordinates (lat,long)'
              pattern: >-
                ^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$
              default: '12.4535,77.9283'
            start_code:
              type: string
              description: Start area pincode
              pattern: '^\d{6}$'
              default: '560001'
            end_code:
              type: string
              description: End area pincode
              pattern: '^\d{6}$'
              default: '560001'
          required:
            - retailCategory
            - category
            - paymentType
            - city_code
            - start_gps
            - end_gps
            - start_code
            - end_code
          additionalProperties: false
  - api: on_search
    action_id: on_search_1
    owner: BPP
    responseFor: search_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICB0cnkgewogICAgY29uc3QgVGF0TWFwcGluZyA9IHsKICAgICAgIkltbWVkaWF0ZSBEZWxpdmVyeSI6IHsgY29kZTogIlBUNjBNIiwgZGF5OiAwLCBwaWNrdXBUaW1lOiAiUFQxNU0iIH0sCiAgICAgICJTYW1lIERheSBEZWxpdmVyeSI6IHsgY29kZTogIlBUNEgiLCBkYXk6IDAsIHBpY2t1cFRpbWU6ICJQVDFIIiB9LAogICAgICAiTmV4dCBEYXkgRGVsaXZlcnkiOiB7IGNvZGU6ICJQMUQiLCBkYXk6IDEsIHBpY2t1cFRpbWU6ICJQVDRIIiB9LAogICAgICAiU3RhbmRhcmQgRGVsaXZlcnkiOiB7IGNvZGU6ICJQMkQiLCBkYXk6IDIsIHBpY2t1cFRpbWU6ICJQVDEySCIgfSwKICAgICAgIkV4cHJlc3MgRGVsaXZlcnkiOiB7IGNvZGU6ICJQM0QiLCBkYXk6IDMsIHBpY2t1cFRpbWU6ICJQMUQiIH0sCiAgICAgICJJbnN0YW50IERlbGl2ZXJ5IjogeyBjb2RlOiAiUFQxME0iLCBkYXk6IDAsIHBpY2t1cFRpbWU6ICJQVDJNIiB9LAogICAgfTsKICAgIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQubWVzc2FnZV9pZCA9IHNlc3Npb25EYXRhLmxhdGVzdE1lc3NhZ2VfaWRbMF07CiAgICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSBzZXNzaW9uRGF0YS5jaXR5X2NvZGVbMF07CgogICAgY29uc29sZS5sb2coImNhdGVnb3J5X2lkIiwgc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdKQoKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZ1siYnBwL2Rlc2NyaXB0b3IiXS50YWdzWzBdLmxpc3QgPQogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmNhdGFsb2dbImJwcC9kZXNjcmlwdG9yIl0udGFnc1swXS5saXN0Lm1hcCgKICAgICAgICAoaXRlbSkgPT4gewogICAgICAgICAgaWYgKGl0ZW0uY29kZSA9PT0gImVmZmVjdGl2ZV9kYXRlIikgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSwKICAgICAgICAgICAgICB2YWx1ZTogZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgfQogICAgICApOwoKICAgIGNvbnN0IGNhdGVnb3JpZXNEYXRhID0gewogICAgICBpZDogc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWRbMF0sCiAgICAgIHRpbWU6IHsKICAgICAgICBsYWJlbDogIlRBVCIsCiAgICAgICAgZHVyYXRpb246IFRhdE1hcHBpbmdbc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdXS5jb2RlLAogICAgICAgIHRpbWVzdGFtcDogZ2V0RnV0dXJlRGF0ZSgKICAgICAgICAgIFRhdE1hcHBpbmdbc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdXS5kYXkKICAgICAgICApLAogICAgICB9LAogICAgfTsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZ1siYnBwL3Byb3ZpZGVycyJdWzBdLmNhdGVnb3JpZXNbMF0gPQogICAgICBjYXRlZ29yaWVzRGF0YTsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmNhdGFsb2dbImJwcC9wcm92aWRlcnMiXVswXS5pdGVtcyA9CiAgICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZ1siYnBwL3Byb3ZpZGVycyJdWzBdLml0ZW1zLm1hcCgKICAgICAgICAoaXRlbSkgPT4gewogICAgICAgICAgY29uc3QgZGVsaXZlcnlGdWxmaWxsbWVudCA9CiAgICAgICAgICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuY2F0YWxvZz8uWyJicHAvcHJvdmlkZXJzIl0/LlswXT8uZnVsZmlsbG1lbnRzPy5maW5kKAogICAgICAgICAgICAgIChmdWxmaWxsbWVudCkgPT4gZnVsZmlsbG1lbnQudHlwZSA9PT0gIkRlbGl2ZXJ5IgogICAgICAgICAgICApIHx8IG51bGw7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoc2Vzc2lvbkRhdGEuY2F0ZWdvcnlfaWQpICYmCiAgICAgICAgICAgIHNlc3Npb25EYXRhLmNhdGVnb3J5X2lkWzBdID09PSAiU3RhbmRhcmQgRGVsaXZlcnkiICYmCiAgICAgICAgICAgIGRlbGl2ZXJ5RnVsZmlsbG1lbnQgJiYKICAgICAgICAgICAgaXRlbS5mdWxmaWxsbWVudF9pZCA9PT0gZGVsaXZlcnlGdWxmaWxsbWVudC5pZAogICAgICAgICAgKSB7CiAgICAgICAgICAgIGl0ZW0uZGVzY3JpcHRvciA9IGl0ZW0uZGVzY3JpcHRvciB8fCB7fTsKICAgICAgICAgICAgaXRlbS5kZXNjcmlwdG9yLmNvZGUgPSAiUDJIMlAiOwogICAgICAgICAgfQogICAgICAgICAgaXRlbS5jYXRlZ29yeV9pZCA9IHNlc3Npb25EYXRhLmNhdGVnb3J5X2lkWzBdOwogICAgICAgICAgaXRlbS50aW1lID0gewogICAgICAgICAgICBsYWJlbDogIlRBVCIsCiAgICAgICAgICAgIGR1cmF0aW9uOiBUYXRNYXBwaW5nW3Nlc3Npb25EYXRhLmNhdGVnb3J5X2lkXS5jb2RlLAogICAgICAgICAgICB0aW1lc3RhbXA6IGdldEZ1dHVyZURhdGUoCiAgICAgICAgICAgICAgVGF0TWFwcGluZ1tzZXNzaW9uRGF0YS5jYXRlZ29yeV9pZF0uZGF5CiAgICAgICAgICAgICksCiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgIH0KICAgICAgKTsKCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmNhdGFsb2dbImJwcC9wcm92aWRlcnMiXVswXS5mdWxmaWxsbWVudHMgPQogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLmNhdGFsb2dbImJwcC9wcm92aWRlcnMiXVswXS5mdWxmaWxsbWVudHMubWFwKAogICAgICAgIChmdWxmaWxsbWVudCkgPT4gewogICAgICAgICAgaWYgKGZ1bGZpbGxtZW50LnR5cGUgPT09ICJEZWxpdmVyeSIgfHwgZnVsZmlsbG1lbnQudHlwZSA9PT0gIlJldHVybiIpIHsKICAgICAgICAgICAgaWYgKHNlc3Npb25EYXRhPy5jYXRlZ29yeV9pZFswXSA9PT0gIlN0YW5kYXJkIERlbGl2ZXJ5IiB8fCBzZXNzaW9uRGF0YT8uY2F0ZWdvcnlfaWRbMF0gPT09ICJOZXh0IERheSBEZWxpdmVyeSIgfHwgc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdID09PSAiRXhwcmVzcyBEZWxpdmVyeSIgfHwgc2Vzc2lvbkRhdGE/LmNhdGVnb3J5X2lkWzBdID09PSAiU2FtZSBEYXkgRGVsaXZlcnkiKSB7CiAgICAgICAgICAgICAgcmVtb3ZlVGFnc0J5Q29kZXMoZnVsZmlsbG1lbnQudGFncywgWyJkaXN0YW5jZSJdKTsKICAgICAgICAgICAgICBpZiAoZnVsZmlsbG1lbnQudGFncy5sZW5ndGggPCAxKSBkZWxldGUgZnVsZmlsbG1lbnQudGFnczsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdWxmaWxsbWVudC5zdGFydC50aW1lLmR1cmF0aW9uID0KICAgICAgICAgICAgICBUYXRNYXBwaW5nW3Nlc3Npb25EYXRhLmNhdGVnb3J5X2lkXS5waWNrdXBUaW1lOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBmdWxmaWxsbWVudDsKICAgICAgICB9CiAgICAgICk7CiAgICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7CiAgfQogIGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmxvZyhlKTsKICAgIHJldHVybiB7CiAgICAgIGNvbnRleHQ6IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQsCiAgICAgIGVycm9yOiBlLm1lc3NhZ2UgPz8gInVua293biIKICAgIH0KICB9Cgp9Cg==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: on_search
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M1
          timestamp: '2026-02-06T21:00:30.000Z'
        message:
          catalog:
            bpp/descriptor:
              name: LSP Aggregator Inc
              tags:
                - code: bpp_terms
                  list:
                    - code: static_terms
                      value: ''
                    - code: static_terms_new
                      value: >-
                        https://github.com/ONDC-Official/NP-Static-Terms/lspNP_LSP/1.0/tc.pdf
                    - code: effective_date
                      value: '2023-10-01T00:00:00.000Z'
            bpp/providers:
              - id: P1
                descriptor:
                  name: LSP Courier Inc
                  short_desc: LSP Courier Inc
                  long_desc: LSP Courier Inc
                categories:
                  - id: Immediate Delivery
                    time:
                      label: TAT
                      duration: PT60M
                      timestamp: '2023-06-06'
                fulfillments:
                  - id: '1'
                    type: Delivery
                    start:
                      time:
                        duration: PT15M
                    tags:
                      - code: distance
                        list:
                          - code: motorable_distance_type
                            value: kilometer
                          - code: motorable_distance
                            value: '1.8'
                  - id: '2'
                    type: RTO
                locations:
                  - id: L1
                    gps: '12.967555,77.749666'
                    address:
                      street: Jayanagar 4th Block
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                items:
                  - id: I1
                    parent_item_id: ''
                    category_id: Immediate Delivery
                    fulfillment_id: '1'
                    descriptor:
                      code: P2P
                      name: Fast delivery
                      short_desc: Fast delivery
                      long_desc: Fast delivery
                    price:
                      currency: INR
                      value: '59.00'
                    time:
                      label: TAT
                      duration: PT45M
                      timestamp: '2023-06-06'
                  - id: I2
                    parent_item_id: I1
                    category_id: Immediate Delivery
                    fulfillment_id: '2'
                    descriptor:
                      code: P2P
                      name: RTO quote
                      short_desc: RTO quote
                      long_desc: RTO quote
                    price:
                      currency: INR
                      value: '23.60'
                    time:
                      label: TAT
                      duration: PT60M
                      timestamp: '2023-06-06'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_search_providers: '$.message.catalog[''bpp/providers'']'
        on_search_locations: '$.message.catalog[''bpp/providers''][0].locations'
        on_search_fulfillments: '$.message.catalog[''bpp/providers''][0].fulfillments'
        on_search_items: '$.message.catalog[''bpp/providers''][0].items'
        provider_id: '$.message.catalog[''bpp/providers''][0].id'
        location_id: '$.message.catalog[''bpp/providers''][0].locations[0].id'
        rto_id: >-
          $.message.catalog['bpp/providers'][0].fulfillments[?(@.type=="RTO")].id
      inputs: {}
  - api: init
    action_id: init_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSBzZXNzaW9uRGF0YS5jaXR5X2NvZGVbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLm9uX3NlYXJjaF9wcm92aWRlcnNbMF1bMF0uaWQ7CiAgY29uc3QgZ2V0UGF5ZW1udEZpZWxkcyA9IChwYXltZW50VHlwZSkgPT4gewogICAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tT1JERVIiIHx8IHBheW1lbnRUeXBlID09PSAiT04tRlVMRklMTE1FTlQiKSB7CiAgICAgIHJldHVybiB7IGNvbGxlY3RlZF9ieTogIkJQUCIgfTsKICAgIH0KCiAgICBpZiAocGF5bWVudFR5cGUgPT09ICJQT1NULUZVTEZJTExNRU5UIikgewogICAgICByZXR1cm4gewogICAgICAgIGNvbGxlY3RlZF9ieTogIkJBUCIsCiAgICAgICAgIkBvbmRjL29yZy9zZXR0bGVtZW50X2Jhc2lzIjogImludm9pY2luZyIsCiAgICAgICAgIkBvbmRjL29yZy9zZXR0bGVtZW50X3dpbmRvdyI6ICJQMTVEIiwKICAgICAgfTsKICAgIH0KICB9OwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIubG9jYXRpb25zWzBdLmlkID0KICAgIHNlc3Npb25EYXRhLm9uX3NlYXJjaF9sb2NhdGlvbnNbMF1bMF0uaWQ7CiAgY29uc29sZS5sb2coIm9uIHNlYXJjaCBsb2NhdGlvbnMiLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uRGF0YS5vbl9zZWFyY2hfbG9jYXRpb25zKSk7CgogIGNvbnNvbGUubG9nKCJzZXNzaW9uIGRhdGEgb25fc2VhcmNoIGl0ZW1zIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEub25fc2VhcmNoX2l0ZW1zKSk7CgoKICAvLyBCdWlsZCBTVEFSVCBvYmplY3QKICBsZXQgc3RhcnRPYmogPSB7CiAgICBsb2NhdGlvbjogewogICAgICBpZDogIlMxIiwKICAgICAgZ3BzOiBzZXNzaW9uRGF0YS5zdGFydF9sb2NhdGlvblswXSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICJNeSBzdG9yZSBuYW1lIDEiLAogICAgICAgIGJ1aWxkaW5nOiAiTXkgYnVpbGRpbmcgbmFtZSAxIiwKICAgICAgICBsb2NhbGl0eTogIk15IHN0cmVldCBuYW1lIDEiLAogICAgICAgIGNpdHk6ICJteSBjaXR5IDEiLAogICAgICAgIHN0YXRlOiAibXkgc3RhdGUgMSIsCiAgICAgICAgY291bnRyeTogIkluZGlhIiwKICAgICAgICBhcmVhX2NvZGU6IHNlc3Npb25EYXRhLnN0YXJ0X2FyZWFfY29kZVswXSwKICAgICAgfSwKICAgIH0sCiAgICBjb250YWN0OiB7CiAgICAgIHBob25lOiAiOTg4NjA5ODg2MCIsCiAgICAgIGVtYWlsOiAiYWJjZC5lZmdoQGdtYWlsLmNvbSIsCiAgICB9LAogICAgLi4uKHNlc3Npb25EYXRhPy5mdWxmaWxsbWVudD8uc3RhcnQ/Lmluc3RydWN0aW9ucyAmJiB7CiAgICAgIGluc3RydWN0aW9uczogc2Vzc2lvbkRhdGEuZnVsZmlsbG1lbnQuc3RhcnQuaW5zdHJ1Y3Rpb25zLAogICAgfSksCiAgfTsKCiAgLy8gQnVpbGQgRU5EIG9iamVjdAogIGxldCBlbmRPYmogPSB7CiAgICBsb2NhdGlvbjogewogICAgICBncHM6IHNlc3Npb25EYXRhLmVuZF9sb2NhdGlvblswXSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICJNeSBob3VzZSBvciBidWlsZGluZyAjIiwKICAgICAgICBidWlsZGluZzogIk15IGJ1aWxkaW5nIG5hbWUgMiIsCiAgICAgICAgbG9jYWxpdHk6ICJNeSBzdHJlZXQgbmFtZSAyIiwKICAgICAgICBjaXR5OiAibXkgY2l0eSBuYW1lIDIiLAogICAgICAgIHN0YXRlOiAibXkgc3RhdGUgMiIsCiAgICAgICAgY291bnRyeTogIkluZGlhIiwKICAgICAgICBhcmVhX2NvZGU6IHNlc3Npb25EYXRhLmVuZF9hcmVhX2NvZGVbMF0sCiAgICAgIH0sCiAgICB9LAogICAgY29udGFjdDogewogICAgICBwaG9uZTogIjkxMjM0MjY3ODkiLAogICAgICBlbWFpbDogInh5ei5xd2VxQGdtYWlsLmNvbSIsCiAgICB9LAogICAgLi4uKHNlc3Npb25EYXRhPy5mdWxmaWxsbWVudD8uZW5kPy5pbnN0cnVjdGlvbnMgJiYgewogICAgICBpbnN0cnVjdGlvbnM6IHNlc3Npb25EYXRhLmZ1bGZpbGxtZW50LmVuZC5pbnN0cnVjdGlvbnMsCiAgICB9KSwKICB9OwogIGNvbnNvbGUubG9nKCJvbl9zZWFyY2hfZnVsZmlsbG1lbnRzIiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbkRhdGEub25fc2VhcmNoX2Z1bGZpbGxtZW50cykpCiAgY29uc3Qgc291cmNlRnVsZmlsbG1lbnQgPSBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfZnVsZmlsbG1lbnRzWzBdPy5maW5kKAogICAgKGZ1bGZpbGxtZW50KSA9PiB7CiAgICAgIHJldHVybiBmdWxmaWxsbWVudC50eXBlID09PSAiRGVsaXZlcnkiOwogICAgfQogICk7CiAgY29uc29sZS5sb2coInNvdXJjZV9mdWxmaWxsbWVudCIsIEpTT04uc3RyaW5naWZ5KHNvdXJjZUZ1bGZpbGxtZW50KSk7CiAgY29uc3QgbWFwcGVkSXRlbXMgPSBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfaXRlbXNbMF0KICAgID8uZmlsdGVyKChpdGVtKSA9PiBpdGVtLmZ1bGZpbGxtZW50X2lkID09PSBzb3VyY2VGdWxmaWxsbWVudD8uaWQpCiAgICA/Lm1hcCgoaXRlbSkgPT4gKHsKICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgIGZ1bGZpbGxtZW50X2lkOiBpdGVtLmZ1bGZpbGxtZW50X2lkLAogICAgICBjYXRlZ29yeV9pZDogaXRlbS5jYXRlZ29yeV9pZCwKICAgICAgZGVzY3JpcHRvcjogewogICAgICAgIGNvZGU6IGl0ZW0uZGVzY3JpcHRvcj8uY29kZQogICAgICB9CiAgICB9KSkgfHwgW107CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSBtYXBwZWRJdGVtczsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0gPSB7CiAgICBpZDogc291cmNlRnVsZmlsbG1lbnQuaWQsCgogICAgdHlwZTogc291cmNlRnVsZmlsbG1lbnQudHlwZSwKCiAgICBzdGFydDogc3RhcnRPYmosCiAgICBlbmQ6IGVuZE9iaiwKCiAgICB0YWdzOiByZW1vdmVUYWdzQnlDb2RlcygKICAgICAgc291cmNlRnVsZmlsbG1lbnQudGFncywKICAgICAgWyJkaXN0YW5jZSJdCiAgICApLAogIH07CgoKICBjb25zb2xlLmxvZygiZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nIiwgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nKTsKCgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuYmlsbGluZy5jcmVhdGVkX2F0ID0KICAgIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuYmlsbGluZy51cGRhdGVkX2F0ID0KICAgIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSB7CiAgICB0eXBlOiBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGVbMF0sCiAgICAuLi5nZXRQYXllbW50RmllbGRzKHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZVswXSksCiAgfTsKCiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: init
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M2
          timestamp: '2023-06-06T21:30:00.000Z'
          ttl: PT30S
        message:
          order:
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: '1'
                category_id: Immediate Delivery
                descriptor:
                  code: P2P
            fulfillments:
              - id: '1'
                type: Delivery
                start:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: My store name
                      building: My building name
                      locality: My street name
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: My street name
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
            billing:
              name: ONDC Logistics Buyer NP
              address:
                name: My house or building no
                building: My house or building name
                locality: Jayanagar
                city: Bengaluru
                state: Karnataka
                country: India
                area_code: '560076'
              tax_number: XXXXXXXXXXXXXXX
              phone: '9886098860'
              email: abcd.efgh@gmail.com
              created_at: '2023-02-06T21:30:00.000Z'
              updated_at: '2023-02-06T21:30:00.000Z'
            payment:
              '@ondc/org/collection_amount': '300.00'
              collected_by: BPP
              type: ON-FULFILLMENT
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  beneficiary_name: xxxxx
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        init_fulfillments: $.message.order.fulfillments
        items: $.message.order.items
        billing: $.message.order.billing
        payment: $.message.order.payment
        provider_id: $.message.order.provider.id
      inputs: {}
  - api: on_init
    action_id: on_init_1
    owner: BPP
    responseFor: init_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0Lm1lc3NhZ2VfaWQgPSBzZXNzaW9uRGF0YS5sYXRlc3RNZXNzYWdlX2lkWzBdOwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIuaWQgPSBzZXNzaW9uRGF0YS5wcm92aWRlcl9pZFswXTsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSBzZXNzaW9uRGF0YS5jaXR5X2NvZGVbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLm9uX3NlYXJjaF9wcm92aWRlcnNbMF0uaWQ7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5sb2NhdGlvbnNbMF0uaWQgPQogICAgc2Vzc2lvbkRhdGEub25fc2VhcmNoX2xvY2F0aW9uc1swXVswXS5pZDsKCiAgY29uc3QgdGVtcEl0ZW1zID0gc2Vzc2lvbkRhdGEuaXRlbXNbMF07CiAgCiAgdGVtcEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHsKICAgIGRlbGV0ZSBpdGVtLmNhdGVnb3J5X2lkOwogICAgZGVsZXRlIGl0ZW0udGFnczsKCiAgICBpZiAoc2Vzc2lvbkRhdGE/LnJhdGVfYmFzaXMpIHsKICAgICAgZGVsZXRlIGl0ZW0uZnVsZmlsbG1lbnRfaWQ7CiAgICAgIGl0ZW0uZnVsZmlsbG1lbnRfaWRzID0gWyJGMSIsICJGMiJdOwogICAgfQogIH0pOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zID0gdGVtcEl0ZW1zOwogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0gc2Vzc2lvbkRhdGEuaW5pdF9mdWxmaWxsbWVudHNbMF07CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlID0gewogICAgICBicmVha3VwOiBbCiAgICAgICAgewogICAgICAgICAgIkBvbmRjL29yZy9pdGVtX2lkIjogc2Vzc2lvbkRhdGEuaXRlbXNbMF1bMF0uaWQsCiAgICAgICAgICAiQG9uZGMvb3JnL3RpdGxlX3R5cGUiOiAiZGVsaXZlcnkiLAogICAgICAgICAgcHJpY2U6IHsKICAgICAgICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICAgICAgICB2YWx1ZTogc2Vzc2lvbkRhdGE/LnJhdGVfYmFzaXMgPyAiMTAwLjAwIiA6ICI1MC4wMCIsCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIkBvbmRjL29yZy9pdGVtX2lkIjogc2Vzc2lvbkRhdGEuaXRlbXNbMF1bMF0uaWQsCiAgICAgICAgICAiQG9uZGMvb3JnL3RpdGxlX3R5cGUiOiAidGF4IiwKICAgICAgICAgIHByaWNlOiB7CiAgICAgICAgICAgIGN1cnJlbmN5OiAiSU5SIiwKICAgICAgICAgICAgdmFsdWU6IHNlc3Npb25EYXRhPy5yYXRlX2Jhc2lzID8gIjE4LjAwIiA6ICI5LjAwIiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICAuLi4oc2Vzc2lvbkRhdGE/LmlzX2NvZCA9PT0gInllcyIKICAgICAgICAgID8gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgIkBvbmRjL29yZy9pdGVtX2lkIjogc2Vzc2lvbkRhdGEuaXRlbXNbMV0uaWQsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy90aXRsZV90eXBlIjogImNvZCIsCiAgICAgICAgICAgICAgcHJpY2U6IHsKICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAiSU5SIiwKICAgICAgICAgICAgICAgIHZhbHVlOiAiOS4wMCIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICJAb25kYy9vcmcvaXRlbV9pZCI6IHNlc3Npb25EYXRhLml0ZW1zWzFdLmlkLAogICAgICAgICAgICAgICJAb25kYy9vcmcvdGl0bGVfdHlwZSI6ICJ0YXgiLAogICAgICAgICAgICAgIHByaWNlOiB7CiAgICAgICAgICAgICAgICBjdXJyZW5jeTogIklOUiIsCiAgICAgICAgICAgICAgICB2YWx1ZTogIjIuMDAiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdCiAgICAgICAgICA6IFtdKSwKICAgICAgXSwKICAgICAgdHRsOiAiUFQxNU0iLAogICAgfTsKCiAgaWYgKHNlc3Npb25EYXRhPy5mZWF0dXJlX2NhbmNlbGxhdGlvbl90ZXJtcyA9PT0gInllcyIpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuY2FuY2VsbGF0aW9uX3Rlcm1zID0gWwogICAgICB7CiAgICAgICAgZnVsZmlsbG1lbnRfc3RhdGU6IHsKICAgICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgICAgY29kZTogIlBlbmRpbmciLAogICAgICAgICAgICBzaG9ydF9kZXNjOiAiMDA4IiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBjYW5jZWxsYXRpb25fZmVlOiB7CiAgICAgICAgICBwZXJjZW50YWdlOiAiMC4wMCIsCiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIGZ1bGZpbGxtZW50X3N0YXRlOiB7CiAgICAgICAgICBkZXNjcmlwdG9yOiB7CiAgICAgICAgICAgIGNvZGU6ICJBZ2VudC1hc3NpZ25lZCIsCiAgICAgICAgICAgIHNob3J0X2Rlc2M6ICIwMDEsMDAzIiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBjYW5jZWxsYXRpb25fZmVlOiB7CiAgICAgICAgICBwZXJjZW50YWdlOiAiMTAwLjAwIiwKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgZnVsZmlsbG1lbnRfc3RhdGU6IHsKICAgICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgICAgY29kZTogIk9yZGVyLXBpY2tlZC11cCIsCiAgICAgICAgICAgIHNob3J0X2Rlc2M6ICIwMDEsMDAzIiwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBjYW5jZWxsYXRpb25fZmVlOiB7CiAgICAgICAgICBwZXJjZW50YWdlOiAiMTAwLjAwIiwKICAgICAgICB9LAogICAgICB9LAogICAgXTsKICB9CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZS5wcmljZSA9IHsKICAgIGN1cnJlbmN5OiAiSU5SIiwKICAgIHZhbHVlOiBjYWxjdWxhdGVRdW90ZVByaWNlKGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUuYnJlYWt1cCksCiAgfTsKCiAgaWYgKHNlc3Npb25EYXRhPy5yYXRlX2Jhc2lzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1swXS5pZCA9ICJGMSI7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5wdXNoKHsKICAgICAgLi4uZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0sCiAgICAgIGlkOiAiRjIiLAogICAgfSk7CiAgfQoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5tYXAoKGZ1bGZ1bGxtZW50KSA9PiB7CiAgICAgIGlmIChzZXNzaW9uRGF0YS5jYXRlZ29yeV9pZFswXSA9PT0gIkltbWVkaWF0ZSBEZWxpdmVyeSIpIHsKICAgICAgICBmdWxmdWxsbWVudC50YWdzLnB1c2goewogICAgICAgICAgY29kZTogInJpZGVyX2NoZWNrIiwKICAgICAgICAgIGxpc3Q6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvZGU6ICJpbmxpbmVfY2hlY2tfZm9yX3JpZGVyIiwKICAgICAgICAgICAgICB2YWx1ZTogInllcyIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBmdWxmdWxsbWVudDsKICAgIH0pOwoKICBpZiAoc2Vzc2lvbkRhdGEucGF5bWVudCkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50ID0gc2Vzc2lvbkRhdGEucGF5bWVudFswXTsKICB9CgogIGlmICgKICAgIChzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUgPT09ICJQT1NULUZVTEZJTExNRU5UIiB8fAogICAgICBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUgPT09ICJPTi1GVUxGSUxMTUVOVCIpICYmCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQuY29sbGVjdGVkX2J5ID09PSAiQkFQIgogICkgewogICAgLy8gZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50WyJAb25kYy9vcmcvY29sbGVjdGlvbl9hbW91bnQiXSA9IAogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50WyJAb25kYy9vcmcvc2V0dGxlbWVudF9kZXRhaWxzIl0gPSBbCiAgICAgIHsKICAgICAgICBzZXR0bGVtZW50X2NvdW50ZXJwYXJ0eTogImxzcCIsCiAgICAgICAgc2V0dGxlbWVudF90eXBlOiAidXBpIiwKICAgICAgICBiZW5lZmljaWFyeV9uYW1lOiAieHh4eHgiLAogICAgICAgIHVwaV9hZGRyZXNzOiAiZ2Z0QG9rc2JpIiwKICAgICAgICBzZXR0bGVtZW50X2JhbmtfYWNjb3VudF9ubzogIlhYWFhYWFhYWFgiLAogICAgICAgIHNldHRsZW1lbnRfaWZzY19jb2RlOiAiWFhYWFhYWFhYIiwKICAgICAgfSwKICAgIF07CiAgfQogIHJldHVybiBkZWZhdWx0UGF5bG9hZDsKfQ==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: on_init
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M2
          timestamp: '2023-02-06T21:30:30.000Z'
        message:
          order:
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I2
                fulfillment_id: '1'
            fulfillments:
              - id: '1'
                type: Delivery
                start:
                  location:
                    gps: '12.4535445,77.9283792'
                    address:
                      name: Store name
                      building: House or building name
                      locality: Locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                tags:
                  - code: rider_check
                    list:
                      - code: inline_check_for_rider
                        value: 'yes'
            quote:
              price:
                currency: INR
                value: '59.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
              ttl: PT15M
            payment:
              '@ondc/org/collection_amount': '300.00'
              type: ON-FULFILLMENT
              collected_by: BPP
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  beneficiary_name: xxxxx
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
            cancellation_terms:
              - fulfillment_state:
                  descriptor:
                    code: Pending
                    short_desc: 008
                cancellation_fee:
                  percentage: '0.00'
                  amount:
                    currency: INR
                    value: '0.00'
              - fulfillment_state:
                  descriptor:
                    code: Agent-assigned
                    short_desc: '001,003'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
              - fulfillment_state:
                  descriptor:
                    code: Order-picked-up
                    short_desc: '001,003'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
              - fulfillment_state:
                  descriptor:
                    code: Out-for-delivery
                    short_desc: '011,012,013,014,015'
                cancellation_fee:
                  percentage: '100.00'
                  amount:
                    currency: INR
                    value: '50.00'
            tags:
              - code: bpp_terms
                list:
                  - code: max_liability
                    value: '2'
                  - code: max_liability_cap
                    value: '10000'
                  - code: mandatory_arbitration
                    value: 'false'
                  - code: court_jurisdiction
                    value: Bengaluru
                  - code: delay_interest
                    value: '1000'
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/protocol-network-extension/discussions/79
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        cancellation_terms: $.message.order.cancellation_terms
        quote: $.message.order.quote
      inputs: {}
  - api: confirm
    action_id: confirm_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gdXVpZHY0KCk7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIuaWQgPSBzZXNzaW9uRGF0YS5wcm92aWRlcl9pZFswXTsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyLmxvY2F0aW9uc1swXS5pZCA9CiAgICBzZXNzaW9uRGF0YS5sb2NhdGlvbl9pZFswXTsKCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlc3Npb25EYXRhLml0ZW1zWzBdOwoKICBsZXQgdGltZSA9IG51bGw7CgogIHNlc3Npb25EYXRhPy5vbl9zZWFyY2hfaXRlbXNbMF0/LmZvckVhY2goKGl0ZW0pID0+IHsKICAgIC8vIGNvbnNvbGUubG9nKCI6Ojo6Ojo6Ojo6OjoiLCBpdGVtLmlkLCBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zWzBdLmlkLCBpdGVtKQogICAgaWYgKGl0ZW0uaWQgPT09IGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXNbMF0uaWQpIHsKICAgICAgdGltZSA9IGl0ZW0udGltZTsKICAgIH0KICB9KTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMubWFwKAogICAgKGl0ZW0pID0+IHsKICAgICAgaXRlbS50aW1lID0gdGltZTsKICAgICAgcmV0dXJuIGl0ZW07CiAgICB9CiAgKTsKCiAgaWYgKHNlc3Npb25EYXRhPy5yYXRlX2Jhc2lzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zID0KICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICBkZWxldGUgaXRlbS5mdWxmaWxsbWVudF9pZDsKICAgICAgICBsZXQgZnVsZmlpbGxtZW50SWRzID0gW107CgogICAgICAgIHNlc3Npb25EYXRhPy5vbl9pbml0X2l0ZW1zPy5mb3JFYWNoKChvbmluaXRJdGVtKSA9PiB7CiAgICAgICAgICBpZiAob25pbml0SXRlbS5pZCA9PT0gaXRlbS5pZCkgewogICAgICAgICAgICBmdWxmaWlsbG1lbnRJZHMgPSBvbmluaXRJdGVtLmZ1bGZpbGxtZW50X2lkczsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaXRlbS5mdWxmaWxsbWVudF9pZHMgPSBmdWxmaWlsbG1lbnRJZHM7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLmZ1bGZpbGxtZW50cykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPSBzZXNzaW9uRGF0YS5mdWxmaWxsbWVudHM7CiAgICBjb25zb2xlLmxvZygiZXhpc3RpbmcgcGF5bG9hZCBpbiBjb25maXJtIiwgSlNPTi5zdHJpbmdpZnkoZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMpKTsKCiAgfQoKICBpZiAoCiAgICBBcnJheS5pc0FycmF5KHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcykgJiYKICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcy5sZW5ndGggPiAwCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbl90ZXJtcyA9CiAgICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtc1swXTsKICB9CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0uc3RhcnQudGltZSA9IHsKICAgIGR1cmF0aW9uOiBzZXNzaW9uRGF0YS5vbl9zZWFyY2hfZnVsZmlsbG1lbnRzWzBdWzBdLnN0YXJ0LnRpbWUuZHVyYXRpb24sCiAgfTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0uc3RhcnQucGVyc29uID0gewogICAgbmFtZTogInBlcnNvbl9uYW1lXzEiLAogIH07CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdLmVuZC5wZXJzb24gPSB7CiAgICBuYW1lOiAicGVyc29uX25hbWVfMiIsCiAgfTsKCgogIGNvbnN0IHRhZ3MgPSBbCiAgICB7CiAgICAgIGNvZGU6ICJzdGF0ZSIsCiAgICAgIGxpc3Q6IFsKICAgICAgICB7CiAgICAgICAgICBjb2RlOiAicmVhZHlfdG9fc2hpcCIsCiAgICAgICAgICB2YWx1ZTogInllcyIgLAogICAgICAgIH0sCiAgICAgIF0sCiAgICB9LAoKICAgIHsKICAgICAgICAgIGNvZGU6ICJydG9fYWN0aW9uIiwKICAgICAgICAgIGxpc3Q6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvZGU6ICJyZXR1cm5fdG9fb3JpZ2luIiwKICAgICAgICAgICAgICB2YWx1ZTogInllcyIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICBdLAogICAgICAgIH0KICBdOwoKCiAgbGV0IGFsbFRhZ3MgPSBtZXJnZUZ1bGZpbGxtZW50VGFncygKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzWzBdPy50YWdzID8/IFtdLAogICAgdGFncwogICk7CgoKICBpZiAoCiAgICBzZXNzaW9uRGF0YT8ucmF0ZV9iYXNpcyAmJgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubGVuZ3RoID4gMQogICkgewogICAgY29uc3QgcHJlVGFncyA9IHJlbW92ZVRhZ3NCeUNvZGVzKAogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1sxXS50YWdzID8/IFtdLAogICAgICBbImxpbmtlZF9wcm92aWRlciJdCiAgICApOwoKICAgIGFsbFRhZ3MgPSBbLi4uYWxsVGFncywgLi4ucHJlVGFnc107CiAgfQoKICBhbGxUYWdzID0gcmVtb3ZlVGFnc0J5Q29kZXMoYWxsVGFncywgWyJyaWRlcl9jaGVjayJdKTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWVudCkgPT4gKHsKICAgICAgLi4uZnVsZmlsbG1lbnQsCiAgICAgIHRhZ3M6IGFsbFRhZ3MsCiAgICB9KSk7CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgbGV0IGlzUmVhZHlUb1NoaXAgPSBmYWxzZTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHNbMF0udGFncy5mb3JFYWNoKCh0YWcpID0+IHsKICAgIGlmICh0YWcuY29kZSA9PT0gInN0YXRlIikgewogICAgICB0YWcubGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgaWYgKGl0ZW0uY29kZSA9PT0gInJlYWR5X3RvX3NoaXAiICYmIGl0ZW0udmFsdWUgPT0gInllcyIpIHsKICAgICAgICAgIGlzUmVhZHlUb1NoaXAgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0KICAgIChkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyB8fCBbXSkubWFwKChmdWxmaWxsbWVudCkgPT4gewoKICAgICAgY29uc3Qgc3RhcnRDb2RlID0gc2Vzc2lvbkRhdGE/LnN0YXRpY19waWNrdXBfb3RwOwogICAgICBjb25zdCBlbmRDb2RlID0gc2Vzc2lvbkRhdGE/LnN0YXRpY19kZWxpdmVyeV9vdHA7CgogICAgICBsZXQgdXBkYXRlZFN0YXJ0SW5zdHJ1Y3Rpb25zOwogICAgICBsZXQgdXBkYXRlZEVuZEluc3RydWN0aW9uczsKCiAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgLy8gU1RBUlQgSU5TVFJVQ1RJT05TCiAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgaWYgKHN0YXJ0Q29kZSA9PT0gIjUiKSB7CiAgICAgICAgdXBkYXRlZFN0YXJ0SW5zdHJ1Y3Rpb25zID0gewogICAgICAgICAgY29kZTogIjUiLAogICAgICAgICAgc2hvcnRfZGVzYzogIjk4NzAiLAogICAgICAgICAgbG9uZ19kZXNjOiAiYWRkaXRpb25hbCBpbnN0cnVjdGlvbnMgZm9yIHBpY2t1cCIsCiAgICAgICAgICBhZGRpdGlvbmFsX2Rlc2M6IHsKICAgICAgICAgICAgY29udGVudF90eXBlOiAidGV4dC9odG1sIiwKICAgICAgICAgICAgdXJsOiAiaHR0cDovL2Rlc2NyaXB0aW9uLmNvbSIsCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGlzUmVhZHlUb1NoaXAgIT09ICJ1bmRlZmluZWQiICYmIGlzUmVhZHlUb1NoaXApIHsKICAgICAgICB1cGRhdGVkU3RhcnRJbnN0cnVjdGlvbnMgPSB7CiAgICAgICAgICBjb2RlOiAiMiIsCiAgICAgICAgICBzaG9ydF9kZXNjOiAiMTIzMTIzIiwKICAgICAgICAgIGxvbmdfZGVzYzogImFkZGl0aW9uYWwgaW5zdHJ1Y3Rpb25zIGZvciBwaWNrdXAiLAogICAgICAgICAgYWRkaXRpb25hbF9kZXNjOiB7CiAgICAgICAgICAgIGNvbnRlbnRfdHlwZTogInRleHQvaHRtbCIsCiAgICAgICAgICAgIHVybDogImh0dHA6Ly9kZXNjcmlwdGlvbi5jb20iLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9CgogICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgIC8vIEVORCBJTlNUUlVDVElPTlMKICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICBpZiAoZW5kQ29kZSA9PT0gIjUiKSB7CiAgICAgICAgdXBkYXRlZEVuZEluc3RydWN0aW9ucyA9IHsKICAgICAgICAgIGNvZGU6ICI1IiwKICAgICAgICAgIHNob3J0X2Rlc2M6ICI2ODcxIiwKICAgICAgICAgIGxvbmdfZGVzYzogImFkZGl0aW9uYWwgaW5zdHJ1Y3Rpb25zIGZvciBkZWxpdmVyeSIsCiAgICAgICAgICBhZGRpdGlvbmFsX2Rlc2M6IHsKICAgICAgICAgICAgY29udGVudF90eXBlOiAidGV4dC9odG1sIiwKICAgICAgICAgICAgdXJsOiAiaHR0cDovL2Rlc2NyaXB0aW9uLmNvbSIsCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGlzUmVhZHlUb1NoaXAgIT09ICJ1bmRlZmluZWQiICYmIGlzUmVhZHlUb1NoaXApIHsKICAgICAgICB1cGRhdGVkRW5kSW5zdHJ1Y3Rpb25zID0gewogICAgICAgICAgY29kZTogIjIiLAogICAgICAgICAgc2hvcnRfZGVzYzogIjk4NzY1NyIsCiAgICAgICAgICBsb25nX2Rlc2M6ICJhZGRpdGlvbmFsIGluc3RydWN0aW9ucyBmb3IgZGVsaXZlcnkiLAogICAgICAgICAgYWRkaXRpb25hbF9kZXNjOiB7CiAgICAgICAgICAgIGNvbnRlbnRfdHlwZTogInRleHQvaHRtbCIsCiAgICAgICAgICAgIHVybDogImh0dHA6Ly9kZXNjcmlwdGlvbi5jb20iLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICB9CgogICAgICBjb25zdCB1cGRhdGVkVGFncyA9IFsuLi4oZnVsZmlsbG1lbnQudGFncyB8fCBbXSldOwogICAgICAKICAgICAgY29uc3QgdXBkYXRlZEZ1bGZpbGxtZW50ID0gewogICAgICAgIC4uLmZ1bGZpbGxtZW50LAogICAgICAgIHN0YXJ0OiB7CiAgICAgICAgICAuLi4oZnVsZmlsbG1lbnQuc3RhcnQgfHwge30pLAogICAgICAgICAgLi4uKHVwZGF0ZWRTdGFydEluc3RydWN0aW9ucyAmJiB7CiAgICAgICAgICAgIGluc3RydWN0aW9uczogdXBkYXRlZFN0YXJ0SW5zdHJ1Y3Rpb25zLAogICAgICAgICAgfSksCiAgICAgICAgfSwKICAgICAgICBlbmQ6IHsKICAgICAgICAgIC4uLihmdWxmaWxsbWVudC5lbmQgfHwge30pLAogICAgICAgICAgLi4uKHVwZGF0ZWRFbmRJbnN0cnVjdGlvbnMgJiYgewogICAgICAgICAgICBpbnN0cnVjdGlvbnM6IHVwZGF0ZWRFbmRJbnN0cnVjdGlvbnMsCiAgICAgICAgICB9KSwKICAgICAgICB9LAogICAgICAgIHRhZ3M6IHVwZGF0ZWRUYWdzLAogICAgICB9OwoKICAgICAgY29uc29sZS5sb2coIlVwZGF0ZWQgZnVsZmlsbG1lbnQ6IiwgdXBkYXRlZEZ1bGZpbGxtZW50KTsKCiAgICAgIHJldHVybiB1cGRhdGVkRnVsZmlsbG1lbnQ7CiAgICB9KTsKCgogIGNvbnN0IHRlbXBRdW90ZSA9IHNlc3Npb25EYXRhLnF1b3RlWzBdOwoKICBkZWxldGUgdGVtcFF1b3RlLnR0bDsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSA9IHRlbXBRdW90ZTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5jcmVhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci51cGRhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KCiAgaWYgKAogICAgKHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIlBPU1QtRlVMRklMTE1FTlQiIHx8CiAgICAgIHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIk9OLUZVTEZJTExNRU5UIikgJiYKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudC5jb2xsZWN0ZWRfYnkgPT09ICJCUFAiCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRbIkBvbmRjL29yZy9zZXR0bGVtZW50X2RldGFpbHMiXSA9IFsKICAgICAgewogICAgICAgIHNldHRsZW1lbnRfY291bnRlcnBhcnR5OiAibGJucCIsCiAgICAgICAgc2V0dGxlbWVudF90eXBlOiAidXBpIiwKICAgICAgICBiZW5lZmljaWFyeV9uYW1lOiAieHh4eHgiLAogICAgICAgIHVwaV9hZGRyZXNzOiAiZ2Z0QG9rc2JpIiwKICAgICAgICBzZXR0bGVtZW50X2JhbmtfYWNjb3VudF9ubzogIlhYWFhYWFhYWFgiLAogICAgICAgIHNldHRsZW1lbnRfaWZzY19jb2RlOiAiWFhYWFhYWFhYIiwKICAgICAgfSwKICAgIF07CiAgfQoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyWyJAb25kYy9vcmcvbGlua2VkX29yZGVyIl0gPSB7CiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgY2F0ZWdvcnlfaWQ6IHNlc3Npb25EYXRhPy5yZXRhaWxfY2F0ZWdvcnlbMF0gfHwgIkdyb2NlcnkiLAogICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgIG5hbWU6ICJJdGVtMSIsCiAgICAgICAgfSwKICAgICAgICBxdWFudGl0eTogewogICAgICAgICAgY291bnQ6IDIsCiAgICAgICAgICBtZWFzdXJlOiB7CiAgICAgICAgICAgIHVuaXQ6ICJraWxvZ3JhbSIsCiAgICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIHByaWNlOiB7CiAgICAgICAgICBjdXJyZW5jeTogIklOUiIsCiAgICAgICAgICB2YWx1ZTogIjcwLjAwIiwKICAgICAgICB9LAogICAgICB9CiAgICBdLAogICAgcHJvdmlkZXI6IHsKICAgICAgZGVzY3JpcHRvcjogewogICAgICAgIG5hbWU6ICJTZWxsZXIxIiwKICAgICAgfSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICJNeSBzdG9yZSBuYW1lIDEiLAogICAgICAgIGJ1aWxkaW5nOiAiTXkgYnVpbGRpbmcgbmFtZSAxIiwKICAgICAgICBsb2NhbGl0eTogIk15IHN0cmVldCBuYW1lIDEiLAogICAgICAgIGNpdHk6ICJteSBjaXR5IDEiLAogICAgICAgIHN0YXRlOiAibXkgc3RhdGUgMSIsCiAgICAgICAgYXJlYV9jb2RlOiBzZXNzaW9uRGF0YT8uc3RhcnRfYXJlYV9jb2RlWzBdIHx8ICI1NjAwMDEiLAogICAgICB9LAogICAgfSwKICAgIG9yZGVyOiB7CiAgICAgIGlkOiAiTzEiLAogICAgICB3ZWlnaHQ6IHsKICAgICAgICB1bml0OiAia2lsb2dyYW0iLAogICAgICAgIHZhbHVlOiAzLAogICAgICB9LAogICAgICBkaW1lbnNpb25zOiB7CiAgICAgICAgbGVuZ3RoOiB7CiAgICAgICAgICB1bml0OiAiY2VudGltZXRlciIsCiAgICAgICAgICB2YWx1ZTogMSwKICAgICAgICB9LAogICAgICAgIGJyZWFkdGg6IHsKICAgICAgICAgIHVuaXQ6ICJjZW50aW1ldGVyIiwKICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgIH0sCiAgICAgICAgaGVpZ2h0OiB7CiAgICAgICAgICB1bml0OiAiY2VudGltZXRlciIsCiAgICAgICAgICB2YWx1ZTogMSwKICAgICAgICB9LAogICAgICB9LAogICAgfSwKICB9OwogIHJldHVybiBkZWZhdWx0UGF5bG9hZDsKfQ==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          country: IND
          city: 'std:080'
          action: confirm
          core_version: 1.2.0
          bap_id: logistics_buyer.com
          bap_uri: 'https://logistics_buyer.com/ondc'
          bpp_id: lsp.com
          bpp_uri: 'https://lsp.com/ondc'
          transaction_id: T1
          message_id: M3
          timestamp: '2023-06-06T22:00:00.000Z'
          ttl: PT30S
        message:
          order:
            id: O2
            state: Created
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: '1'
                category_id: Immediate Delivery
                descriptor:
                  code: P2P
                time:
                  label: TAT
                  duration: PT45M
                  timestamp: '2023-06-06'
            quote:
              price:
                currency: INR
                value: '59.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
            fulfillments:
              - id: '1'
                type: Delivery
                '@ondc/org/awb_no': '1227262193237777'
                start:
                  time:
                    duration: PT15M
                  person:
                    name: person_name
                  location:
                    gps: '12.4535445,77.9283792'
                    address:
                      name: Store name
                      building: House or building name
                      locality: Locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560041'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                  instructions:
                    code: '2'
                    short_desc: value of PCC
                    long_desc: additional instructions for pickup
                    additional_desc:
                      content_type: text/html
                      url: 'https://reverse_qc_sop_form.htm'
                end:
                  person:
                    name: person_name
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'My house #'
                      building: My house or building name
                      locality: locality
                      city: Bengaluru
                      state: Karnataka
                      country: India
                      area_code: '560076'
                  contact:
                    phone: '9886098860'
                    email: abcd.efgh@gmail.com
                  instructions:
                    code: '3'
                    short_desc: value of DCC
                    long_desc: additional instructions for delivery
            billing:
              name: ONDC Logistics Buyer NP1
              address:
                name: name
                building: My house or building name
                locality: My street name
                city: Bengaluru
                state: Karnataka
                country: India
                area_code: '560076'
              tax_number: 29AAACU1901H1ZK
              phone: '9886098860'
              email: abcd.efgh@gmail.com
              created_at: '2023-06-06T21:30:00.000Z'
              updated_at: '2023-06-06T21:30:00.000Z'
            payment:
              '@ondc/org/collection_amount': '300.00'
              collected_by: BPP
              type: ON-FULFILLMENT
              '@ondc/org/settlement_details':
                - settlement_counterparty: buyer-app
                  settlement_type: upi
                  upi_address: gft@oksbi
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_ifsc_code: XXXXXXXXX
            '@ondc/org/linked_order':
              items:
                - category_id: Grocery
                  descriptor:
                    name: Atta
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 0.5
                  price:
                    currency: INR
                    value: '150.00'
              provider:
                descriptor:
                  name: Aadishwar Store
                address:
                  name: KHB Towers
                  building: Building or House No
                  locality: Koramangala
                  city: Bengaluru
                  state: Karnataka
                  area_code: '560070'
              order:
                id: O1
                weight:
                  unit: kilogram
                  value: 1
                dimensions:
                  length:
                    unit: centimeter
                    value: 1
                  breadth:
                    unit: centimeter
                    value: 1
                  height:
                    unit: centimeter
                    value: 1
            tags:
              - code: bpp_terms
                list:
                  - code: max_liability
                    value: '2'
                  - code: max_liability_cap
                    value: '10000'
                  - code: mandatory_arbitration
                    value: 'false'
                  - code: court_jurisdiction
                    value: Bengaluru
                  - code: delay_interest
                    value: '1000'
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/protocol-network-extension/discussions/79
              - code: bap_terms
                list:
                  - code: accept_bpp_terms
                    value: 'Y'
            created_at: '2023-06-06T22:00:00.000Z'
            updated_at: '2023-06-06T22:00:00.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        order_status: $.message.order.state
        order_id: $.message.order.id
        confirm_create_at_timestamp: $.message.order.created_at
        items: $.message.order.items
        quote: $.message.order.quote
        linked_order: '$.message.order[''@ondc/org/linked_order'']'
        confirm_tags: $.message.order.tags
        confirm_fulfillments: $.message.order.fulfillments
      inputs: {}
  - api: on_confirm
    action_id: on_confirm_1
    owner: BPP
    responseFor: confirm_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQuY29udGV4dC5tZXNzYWdlX2lkID0gc2Vzc2lvbkRhdGEubGF0ZXN0TWVzc2FnZV9pZFswXTsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyLmlkID0gc2Vzc2lvbkRhdGEucHJvdmlkZXJfaWRbMF07CiAgY29uc3QgcG9wdWxhdGVGdWxmaWxsbWVudENvbmZpbSA9ICgKICAgIGV4aXN0aW5nUGF5bG9hZCwKICAgIHNlc3Npb25EYXRhCiAgKSA9PiB7CiAgIAogICAgZXhpc3RpbmdQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0KICAgICAgZXhpc3RpbmdQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzLm1hcCgoZnVsZmlsbG1lbnQpID0+IHsKICAgICAgICBsZXQgaXNSZWFkeVRvU2hpcCA9IGZhbHNlOwoKICAgICAgICBmdWxmaWxsbWVudC50YWdzLmZvckVhY2goKHRhZykgPT4gewogICAgICAgICAgaWYgKHRhZy5jb2RlID09PSAic3RhdGUiKSB7CiAgICAgICAgICAgIHRhZy5saXN0LmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgICAgICBpZiAoaXRlbS5jb2RlID09PSAicmVhZHlfdG9fc2hpcCIgJiYgaXRlbS52YWx1ZSA9PSAieWVzIikgewogICAgICAgICAgICAgICAgaXNSZWFkeVRvU2hpcCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgZnVsZmlsbG1lbnQudHJhY2tpbmcgPSB0cnVlOwoKICAgICAgICBpZiAoaXNSZWFkeVRvU2hpcCkgewogICAgICAgICAgZnVsZmlsbG1lbnQuc3RhdGUgPSB7CiAgICAgICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgICAgICBjb2RlOiAiQWdlbnQtYXNzaWduZWQiLAogICAgICAgICAgICB9LAogICAgICAgICAgfTsKICAgICAgICAgIGZ1bGZpbGxtZW50LmFnZW50ID0gewogICAgICAgICAgICBuYW1lOiAicGVyc29uX25hbWUiLAogICAgICAgICAgICBwaG9uZTogIjk4ODYwOTg4NjAiLAogICAgICAgICAgfTsKICAgICAgICAgIGZ1bGZpbGxtZW50LnZlaGljbGUgPSB7CiAgICAgICAgICAgIHJlZ2lzdHJhdGlvbjogIjNMVko5NDUiLAogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAoIWV4aXN0aW5nUGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50c1swXS5zdGFydD8udGltZT8ucmFuZ2UpIHsKICAgICAgICAgICAgZnVsZmlsbG1lbnQuc3RhcnQudGltZS5yYW5nZSA9IHsKICAgICAgICAgICAgICBzdGFydDogZXhpc3RpbmdQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wLAogICAgICAgICAgICAgIGVuZDogZ2V0VGltZXN0YW1wRnJvbUR1cmF0aW9uKAogICAgICAgICAgICAgICAgZXhpc3RpbmdQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wLAogICAgICAgICAgICAgICAgZnVsZmlsbG1lbnQ/LnN0YXJ0Py50aW1lPy5kdXJhdGlvbiB8fCAiUDFEIgogICAgICAgICAgICAgICksCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBmdWxmaWxsbWVudC5lbmQudGltZSA9IHsKICAgICAgICAgICAgICByYW5nZTogewogICAgICAgICAgICAgICAgc3RhcnQ6IGZ1bGZpbGxtZW50Py5zdGFydD8udGltZT8ucmFuZ2U/LmVuZCwKICAgICAgICAgICAgICAgIGVuZDogZ2V0VGltZXN0YW1wRnJvbUR1cmF0aW9uKAogICAgICAgICAgICAgICAgICBleGlzdGluZ1BheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgICAgICAgICAgICAgIHNlc3Npb25EYXRhPy50YXQgfHwgIlAxRCIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmdWxmaWxsbWVudDsKICAgICAgfSk7CgogICAgcmV0dXJuIGV4aXN0aW5nUGF5bG9hZDsKICB9CgogIGlmIChzZXNzaW9uRGF0YT8uYmlsbGluZykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nID0gc2Vzc2lvbkRhdGEuYmlsbGluZ1swXTsKICB9CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSBzZXNzaW9uRGF0YT8uaXRlbXNbMF07CgogIGlmIChzZXNzaW9uRGF0YT8uY29uZmlybV9jcmVhdGVfYXRfdGltZXN0YW1wKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNyZWF0ZWRfYXQgPQogICAgICBzZXNzaW9uRGF0YS5jb25maXJtX2NyZWF0ZV9hdF90aW1lc3RhbXBbMF07CiAgfQogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIudXBkYXRlZF9hdCA9IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwoKICBpZiAoc2Vzc2lvbkRhdGE/LmNvbmZpcm1fZnVsZmlsbG1lbnRzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9IHNlc3Npb25EYXRhLmNvbmZpcm1fZnVsZmlsbG1lbnRzWzBdOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkoc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zKSAmJgogICAgc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zLmxlbmd0aCA+IDApIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuY2FuY2VsbGF0aW9uX3Rlcm1zID0KICAgICAgc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zWzBdOwogIH0KICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5tYXAoKGZ1bGZpbGxtZXQpID0+IHsKICAgICAgZnVsZmlsbG1ldC5zdGF0ZSA9IHsKICAgICAgICBkZXNjcmlwdG9yOiB7CiAgICAgICAgICBjb2RlOiAiUGVuZGluZyIsCiAgICAgICAgfSwKICAgICAgfTsKICAgICAgZnVsZmlsbG1ldC50YWdzLnB1c2goewogICAgICAgIGNvZGU6ICJ3ZWF0aGVyX2NoZWNrIiwKICAgICAgICBsaXN0OiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJyYWluaW5nIiwKICAgICAgICAgICAgdmFsdWU6ICJubyIsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGZ1bGZpbGxtZXQ7CiAgICB9KTsKICBkZWZhdWx0UGF5bG9hZCA9IHBvcHVsYXRlRnVsZmlsbG1lbnRDb25maW0oZGVmYXVsdFBheWxvYWQsIHNlc3Npb25EYXRhKTsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlID0gc2Vzc2lvbkRhdGEucXVvdGVbMF07CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KCiAgaWYgKAogICAgc2Vzc2lvbkRhdGEucGF5bWVudF90eXBlID09PSAiT04tT1JERVIiICYmCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQuY29sbGVjdGVkX2J5ID09PSAiQlBQIgogICkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50LnBhcmFtcyA9IHsKICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICB0cmFuc2FjdGlvbl9pZDogInR4bjEyMzQiLAogICAgICBhbW91bnQ6IGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUucHJpY2UudmFsdWUsCiAgICB9OwogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50LnN0YXR1cyA9PT0gIlBBSUQiOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlcikgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlclsiQG9uZGMvb3JnL2xpbmtlZF9vcmRlciJdID0KICAgICAgc2Vzc2lvbkRhdGEubGlua2VkX29yZGVyWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLmNvbmZpcm1fdGFncykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci50YWdzID0gc2Vzc2lvbkRhdGEuY29uZmlybV90YWdzWzBdCiAgfQoKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_confirm
          timestamp: '2026-02-15T12:12:22.442Z'
          transaction_id: 84770f59-155f-4a91-85f0-2a97ecb314b5
          message_id: 9bef97cf-81a2-40a7-bc3d-b4b80b77af54
          bap_id: sample-bap-id
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            id: 0dfdb5d1971e42bfb85d0c77e5035239
            state: Accepted
            provider:
              id: Delhivery
            items:
              - descriptor:
                  code: P2H2P
                category_id: Standard Delivery
                id: 4e017417-9784-4e05-bc66-502fb2d3fa72
                fulfillment_id: '1'
                time:
                  label: TAT
                  duration: P1D
                  timestamp: '2024-02-03'
            quote:
              price:
                currency: INR
                value: '42.48'
              breakup:
                - '@ondc/org/item_id': 4e017417-9784-4e05-bc66-502fb2d3fa72
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '36.00'
                - '@ondc/org/item_id': 4e017417-9784-4e05-bc66-502fb2d3fa72
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '6.48'
            payment:
              type: ON-ORDER
              status: PAID
              collected_by: BAP
              '@ondc/org/settlement_details':
                - settlement_ifsc_code: IFSCTEST1234
                  beneficiary_name: DELHIVERY LIMITED
                  settlement_bank_account_no: ACCTEST1234
                  settlement_counterparty: seller-app
                  settlement_type: neft
              '@ondc/org/collection_amount': '0.0'
            fulfillments:
              - id: '1'
                type: Delivery
                state:
                  descriptor:
                    code: Searching-for-Agent
                '@ondc/org/awb_no': '6421710001606'
                tracking: true
                start:
                  instructions:
                    long_desc: Status For Pickup
                    short_desc: '0001'
                  person:
                    name: Sangeetha Mobiles
                  location:
                    gps: '28.4554726,77.0219019'
                    address:
                      name: Sangeetha Mobiles
                      building: 'below Sangeetha mobiles,'
                      city: Bangalore
                      state: Karnataka
                      country: IND
                      area_code: '400005'
                      locality: Banashankari
                  contact:
                    phone: '8197759422'
                    email: anirban@sangeethamobiles.com
                  time:
                    range:
                      start: '2024-02-03T02:38:00.000Z'
                      end: '2024-02-03T07:38:00.000Z'
                end:
                  instructions:
                    long_desc: Status For Drop
                    short_desc: '0001'
                  person:
                    name: sellerapp
                  location:
                    gps: '21,78'
                    address:
                      name: sellerapp
                      building: indiranagar
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '110017'
                      locality: '12,san jose'
                  contact:
                    phone: '9809557809'
                    email: prasanth.m@sellerapp.com
            billing:
              address:
                door: '1, 621/A'
                country: India
                city: Bangalore
                area_code: '560038'
                name: '12th main road , Hal 2nd stage'
                locality: Indiranagar Bangalore
                state: Karnataka
                building: san jose
              updated_at: '2024-02-02T12:46:04.914Z'
              phone: '9650439777'
              tax_number: 29ABDCS3411L1Z7
              name: SELLMETRIC PRIVATE LIMITED
              created_at: '2024-02-02T12:46:04.914Z'
              email: ondc-billing@sellerapp.com
            '@ondc/org/linked_order':
              items:
                - descriptor:
                    name: Samsung Galaxy A03s Blue 3GB 32GB
                  category_id: Mobiles
                  quantity:
                    count: 1
                    measure:
                      value: 10
                      unit: gram
                  price:
                    currency: INR
                    value: '13499'
              provider:
                descriptor:
                  name: Sangeetha mobiles
                address:
                  name: Sangeetha Mobiles
                  building: 'below Sangeetha mobiles,'
                  city: Bangalore
                  state: Karnataka
                  country: IND
                  area_code: '400005'
                  locality: Banashankari
              order:
                id: SLRP-2914
                weight:
                  value: 11
                  unit: gram
                dimensions:
                  length:
                    value: 10
                    unit: centimeter
                  breadth:
                    value: 10
                    unit: centimeter
                  height:
                    value: 10
                    unit: centimeter
            created_at: '2024-02-02T12:46:05.420Z'
            updated_at: '2024-02-02T12:46:05.420Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_confirm_tags: $.message.order.tags
        on_confirm_fulfillments: $.message.order.fulfillments
      inputs: {}
  - api: on_status
    action_id: on_status_agent_assigned
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLnByb3ZpZGVyX2lkWzBdOwogIGlmIChzZXNzaW9uRGF0YT8ub25fY29uZmlybV9mdWxmaWxsbWVudHNbMF0pIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0gc2Vzc2lvbkRhdGEub25fY29uZmlybV9mdWxmaWxsbWVudHNbMF07CiAgfQogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuc3RhdGUgPSAiSW4tcHJvZ3Jlc3MiOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cy5tYXAoKGZ1bGZpbGxtZW50KSA9PiB7CiAgICAgIGZ1bGZpbGxtZW50LnN0YXRlLmRlc2NyaXB0b3IuY29kZSA9ICJBZ2VudC1hc3NpZ25lZCI7CgoKICAgICAgZnVsZmlsbG1lbnQuYWdlbnQgPSB7CiAgICAgICAgbmFtZTogImFnZW50X25hbWUiLAogICAgICAgIHBob25lOiAiOTg4NjA5ODg2MCIsCiAgICAgIH07CiAgICAgIGZ1bGZpbGxtZW50LnZlaGljbGUgPSB7CiAgICAgICAgcmVnaXN0cmF0aW9uOiAiM0xWSjk0NSIsCiAgICAgIH07CgogICAgICBmdWxmaWxsbWVudC50YWdzID0gWwogICAgICAgIC4uLnJlbW92ZVRhZ3NCeUNvZGVzKGZ1bGZpbGxtZW50LnRhZ3MsIFsKICAgICAgICAgICJ3ZWF0aGVyX2NoZWNrIiwKICAgICAgICAgICJydG9fYWN0aW9uIiwKICAgICAgICAgICJzdGF0ZSIsCiAgICAgICAgXSksCiAgICAgIF07CgogICAgICByZXR1cm4gZnVsZmlsbG1lbnQ7CiAgICB9KTsKCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci51cGRhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUgPSBzZXNzaW9uRGF0YS5xdW90ZVswXTsKICBpZiAoCiAgICBBcnJheS5pc0FycmF5KHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcykgJiYKICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcy5sZW5ndGggPiAwCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbl90ZXJtcyA9CiAgICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtc1swXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50LnN0YXR1cyA9IGdldFBheW1lbnRTdGF0dXMoCiAgICBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUsCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnN0YXRlCiAgKTsKCiAgaWYgKHNlc3Npb25EYXRhPy5pdGVtc1swXSkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlc3Npb25EYXRhLml0ZW1zWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlclswXSkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlclsiQG9uZGMvb3JnL2xpbmtlZF9vcmRlciJdID0KICAgICAgc2Vzc2lvbkRhdGEubGlua2VkX29yZGVyWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLm9uX2NvbmZpcm1fdGFncykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci50YWdzID0gc2Vzc2lvbkRhdGEub25fY29uZmlybV90YWdzWzBdCiAgfQogIAoKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          action: on_status
          bap_id: staging-automation.ondc.org
          bap_uri: 'https://dev-automation.ondc.org/api-service/ONDC:LOG10/1.2.5/buyer'
          bpp_id: staging-automation.ondc.org
          bpp_uri: 'https://dev-automation.ondc.org/api-service/ONDC:LOG10/1.2.5/seller'
          city: 'std:080'
          core_version: 1.2.0
          country: IND
          domain: 'nic2004:60232'
          message_id: 9dfb5950-c519-40eb-afd1-0c3dbd0cfca8
          timestamp: '2026-02-15T12:51:04.050Z'
          transaction_id: 8544228f-a14f-4bca-81e5-a720286b5233
        message:
          order:
            '@ondc/org/linked_order':
              items:
                - category_id: F&B
                  descriptor:
                    name: Item1
                  price:
                    currency: INR
                    value: '70.00'
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 1
                - category_id: F&B
                  descriptor:
                    name: Item2
                  price:
                    currency: INR
                    value: '160.00'
                  quantity:
                    count: 1
                    measure:
                      unit: kilogram
                      value: 1
              order:
                dimensions:
                  breadth:
                    unit: centimeter
                    value: 1
                  height:
                    unit: centimeter
                    value: 1
                  length:
                    unit: centimeter
                    value: 1
                id: O1
                weight:
                  unit: kilogram
                  value: 3
              provider:
                address:
                  area_code: '560001'
                  building: My building name 1
                  city: my city 1
                  locality: My street name 1
                  name: My store name 1
                  state: my state 1
                descriptor:
                  name: Seller1
            billing:
              address:
                area_code: '560076'
                building: My house or building name
                city: Bengaluru
                country: India
                locality: Jayanagar
                name: My house or building no
                state: Karnataka
              created_at: '2026-02-15T12:51:02.655Z'
              email: abcd.efgh@gmail.com
              name: ONDC Logistics Buyer NP
              phone: '9886098860'
              tax_number: AS34234HKJ342KH
              updated_at: '2026-02-15T12:51:02.655Z'
            fulfillments:
              - agent:
                  name: agent_name
                  phone: '9886098860'
                end:
                  contact:
                    email: xyz.qweq@gmail.com
                    phone: '9123426789'
                  location:
                    address:
                      area_code: '560001'
                      building: My building name 2
                      city: my city name 2
                      country: India
                      locality: My street name 2
                      name: 'My house or building #'
                      state: my state 2
                    gps: '12.4535,77.9283'
                  person:
                    name: person_name_2
                  time:
                    range:
                      end: '2026-02-18T00:51:03.425Z'
                      start: '2026-02-16T00:51:03.425Z'
                id: '1'
                start:
                  contact:
                    email: abcd.efgh@gmail.com
                    phone: '9886098860'
                  location:
                    address:
                      area_code: '560001'
                      building: My building name 1
                      city: my city 1
                      country: India
                      locality: My street name 1
                      name: My store name 1
                      state: my state 1
                    gps: '12.4535,77.9283'
                    id: S1
                  person:
                    name: person_name_1
                  time:
                    duration: PT12H
                    range:
                      end: '2026-02-16T00:51:03.425Z'
                      start: '2026-02-15T12:51:03.425Z'
                state:
                  descriptor:
                    code: Agent-assigned
                tracking: true
                type: Delivery
                vehicle:
                  registration: 3LVJ945
            id: 989bb323-e5f5-4374-808f-45ebaad83472
            items:
              - category_id: Standard Delivery
                fulfillment_id: '1'
                id: I1
                time:
                  duration: P2D
                  label: TAT
                  timestamp: '2026-02-17'
            payment:
              '@ondc/org/settlement_basis': invoicing
              '@ondc/org/settlement_details':
                - beneficiary_name: xxxxx
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_counterparty: lsp
                  settlement_ifsc_code: XXXXXXXXX
                  settlement_type: upi
                  upi_address: gft@oksbi
              '@ondc/org/settlement_window': P15D
              collected_by: BAP
              status: NOT-PAID
              type: POST-FULFILLMENT
            provider:
              id: P1
            quote:
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
              price:
                currency: INR
                value: '59.00'
            state: In-progress
            tags:
              - code: bap_terms
                list:
                  - code: accept_bpp_terms
                    value: 'yes'
            updated_at: '2026-02-15T12:51:04.050Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_status_agent_assigned_fulfillments: $.message.order.fulfillments
      inputs: {}
  - api: on_status
    action_id: on_status_order_picked_up
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLnByb3ZpZGVyX2lkWzBdOwogIGlmIChzZXNzaW9uRGF0YT8ub25fc3RhdHVzX2FnZW50X2Fzc2lnbmVkX2Z1bGZpbGxtZW50c1swXSkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPSBzZXNzaW9uRGF0YS5vbl9zdGF0dXNfYWdlbnRfYXNzaWduZWRfZnVsZmlsbG1lbnRzWzBdOwogIH0KCiAgCiAgICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuc3RhdGUgPSAiSW4tcHJvZ3Jlc3MiOwogICAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9CiAgICAgICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWVudCkgPT4gewogICAgICAgICAgaWYgKGZ1bGZpbGxtZW50LnR5cGUgPT09ICJEZWxpdmVyeSIpIHsKICAgICAgICAgICAgZnVsZmlsbG1lbnQuc3RhdGUuZGVzY3JpcHRvci5jb2RlID0gIk9yZGVyLXBpY2tlZC11cCI7CiAgICAgICAgICAgIGZ1bGZpbGxtZW50LnN0YXJ0LnRpbWUgPSB7CiAgICAgICAgICAgICAgLi4uZnVsZmlsbG1lbnQuc3RhcnQudGltZSwKICAgICAgICAgICAgICB0aW1lc3RhbXA6IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQ/LnRpbWVzdGFtcCwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IHAyaDJwTGlzdCA9IFsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb2RlOiAiZ3BzX2VuYWJsZWQiLAogICAgICAgICAgICAgICAgdmFsdWU6ICJubyIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb2RlOiAidXJsX2VuYWJsZWQiLAogICAgICAgICAgICAgICAgdmFsdWU6ICJ5ZXMiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29kZTogInVybCIsCiAgICAgICAgICAgICAgICB2YWx1ZTogImh0dHBzOi8vdHJhY2tpbmdfdXJsLmNvbSIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXTsKCiAgICAgICAgICAgIGZ1bGZpbGxtZW50LnRhZ3MucHVzaCh7CiAgICAgICAgICAgICAgY29kZTogInRyYWNraW5nIiwKICAgICAgICAgICAgICBsaXN0OiBwMmgycExpc3QsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZ1bGZpbGxtZW50OwogICAgICAgIH0pOwoKICBpZiAoc2Vzc2lvbkRhdGE/LmJpbGxpbmcpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuYmlsbGluZyA9IHNlc3Npb25EYXRhLmJpbGxpbmdbMF07CiAgfQoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnVwZGF0ZWRfYXQgPSBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LnRpbWVzdGFtcDsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSA9IHNlc3Npb25EYXRhLnF1b3RlWzBdOwogIGlmICgKICAgIEFycmF5LmlzQXJyYXkoc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zKSAmJgogICAgc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zLmxlbmd0aCA+IDAKICApIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuY2FuY2VsbGF0aW9uX3Rlcm1zID0KICAgICAgc2Vzc2lvbkRhdGEuY2FuY2VsbGF0aW9uX3Rlcm1zWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLnBheW1lbnQpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudCA9IHNlc3Npb25EYXRhLnBheW1lbnRbMF07CiAgfQoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQuc3RhdHVzID0gZ2V0UGF5bWVudFN0YXR1cygKICAgIHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSwKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuc3RhdGUKICApOwoKICBpZiAoCiAgICBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUgPT09ICJPTi1GVUxGSUxMTUVOVCIgJiYKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuc3RhdGUgPT09ICJDb21wbGV0ZWQiCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRbIkBvbmRjL29yZy9zZXR0bGVtZW50X2RldGFpbHMiXSA9IFsKICAgICAgewogICAgICAgIC4uLmRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudFsKICAgICAgICAiQG9uZGMvb3JnL3NldHRsZW1lbnRfZGV0YWlscyIKICAgICAgICBdWzBdLAogICAgICAgIHNldHRsZW1lbnRfc3RhdHVzOiAiUEFJRCIsCiAgICAgICAgc2V0dGxlbWVudF9yZWZlcmVuY2U6ICJYWFhYWFhYWFgiLAogICAgICAgIHNldHRsZW1lbnRfdGltZXN0YW1wOiBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LnRpbWVzdGFtcCwKICAgICAgfSwKICAgIF07CiAgfQoKICBpZiAoc2Vzc2lvbkRhdGE/Lml0ZW1zKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLml0ZW1zID0gc2Vzc2lvbkRhdGEuaXRlbXNbMF07CiAgfQoKCiAgaWYgKHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlcikgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlclsiQG9uZGMvb3JnL2xpbmtlZF9vcmRlciJdID0KICAgICAgc2Vzc2lvbkRhdGEubGlua2VkX29yZGVyWzBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhLm9uX2NvbmZpcm1fdGFncykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci50YWdzID0gc2Vzc2lvbkRhdGEub25fY29uZmlybV90YWdzWzBdCiAgfQoKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_status
          timestamp: '2026-02-15T15:45:25.073Z'
          transaction_id: 84770f59-155f-4a91-85f0-2a97ecb314b5
          message_id: fb3fad91-32d2-42d8-81c9-c7533885d794
          bap_id: sample-bap-id
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            id: 8355a0472eee42c8b470d4c2ae803104
            state: In-progress
            provider:
              id: DTDC
            items:
              - id: B2C SMART EXPRESS
                category_id: Standard Delivery
                fulfillment_id: '1'
                descriptor:
                  code: P2H2P
                time:
                  label: TAT
                  duration: P2D
                  timestamp: '2024-09-04'
            quote:
              price:
                currency: INR
                value: '77.00'
              breakup:
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '63.14'
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '13.86'
            billing:
              name: Bizom
              email: ondchelp@mobisy.com
              phone: '9886193962'
              address:
                name: Bizom
                locality: Bellandur Main Rd
                city: Bengaluru
                state: Karnataka
                country: India
                building: Sri Arunachaleshwara Building
                area_code: '560103'
              tax_number: 29AAFCM4341L1Z6
              created_at: '2024-09-02T09:58:13.462Z'
              updated_at: '2024-09-02T09:58:13.462Z'
            payment:
              type: POST-FULFILLMENT
              collected_by: BAP
              '@ondc/org/settlement_details':
                - settlement_counterparty: seller-app
                  settlement_type: upi
                  upi_address: gft@oksbi
                  settlement_bank_account_no: '123456789123456'
                  settlement_ifsc_code: ICIC00001234
              status: NOT-PAID
            '@ondc/org/linked_order':
              items:
                - category_id: Grocery
                  descriptor:
                    name: >-
                      Surya Pickle Mirchi (Red Chilli) Powder 500g |Suitable for
                      Pickling
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 0.5
                  price:
                    currency: INR
                    value: '70.0'
              provider:
                address:
                  name: Shailja Rajput
                  locality: Central Jail Road Sarjapur
                  city: Bangalore
                  state: Karnataka
                  country: IND
                  building: Silverwood Regency Apartment
                  area_code: '560103'
                descriptor:
                  name: Bizom Mart
              order:
                id: 2024-09-02-361761
                weight:
                  unit: kilogram
                  value: 1
                dimensions:
                  length:
                    unit: centimeter
                    value: 8
                  breadth:
                    unit: centimeter
                    value: 10
                  height:
                    unit: centimeter
                    value: 12
            created_at: '2024-09-02T09:58:23.392Z'
            updated_at: '2024-09-02T11:40:55.610Z'
            fulfillments:
              - id: '1'
                type: Delivery
                '@ondc/org/awb_no': 7D2321487
                tracking: true
                start:
                  person:
                    name: Shailja Rajput
                  location:
                    gps: '12.927341,77.671691'
                    address:
                      name: Shailja Rajput
                      locality: Central Jail Road Sarjapur
                      city: Bangalore
                      state: Karnataka
                      country: IND
                      building: Silverwood Regency Apartment
                      area_code: '560103'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  time:
                    range:
                      start: '2024-09-02T10:05:00.639Z'
                      end: '2024-09-02T17:30:00.639Z'
                    timestamp: '2024-09-02T11:40:53.614Z'
                  instructions:
                    name: Proof Of Pickup
                    images:
                      - >-
                        https://shipsy-demo.s3.amazonaws.com/1/poc/2024-09-02/pickupcompleted/poc_z71y3c_1725277255498
                end:
                  person:
                    name: Delhi Address
                  location:
                    gps: '28.516106,77.114037'
                    address:
                      name: Delhi Address
                      locality: Avenue Jacaranda
                      city: New Delhi
                      state: Delhi
                      country: IND
                      building: Maheshwari Apartment
                      area_code: '110038'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  time:
                    range:
                      start: '2024-09-04T10:05:00.639Z'
                      end: '2024-09-04T17:30:00.639Z'
                tags:
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'yes'
                      - code: url
                        value: >-
                          https://testtrack.dtdc.com/ctbs-tracking/customerInterface.tr?submitName=showCITrackingDetails&cType=Consignment&cnNo=7D2321487
                state:
                  descriptor:
                    code: Order-picked-up
                vehicle:
                  registration: HR1234
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_status_order_picked_up_fulfillments: $.message.order.fulfillments
      inputs: {}
  - api: on_status
    action_id: on_status_out_for_delivery
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLnByb3ZpZGVyX2lkWzBdOwogIGlmIChzZXNzaW9uRGF0YT8ub25fc3RhdHVzX29yZGVyX3BpY2tlZF91cF9mdWxmaWxsbWVudHNbMF0pIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuZnVsZmlsbG1lbnRzID0gc2Vzc2lvbkRhdGEub25fc3RhdHVzX29yZGVyX3BpY2tlZF91cF9mdWxmaWxsbWVudHNbMF07CiAgfQoKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5zdGF0ZSA9ICJJbi1wcm9ncmVzcyI7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWVudCkgPT4gewogICAgICBpZiAoZnVsZmlsbG1lbnQudHlwZSA9PT0gIkRlbGl2ZXJ5IikgewogICAgICAgIGZ1bGZpbGxtZW50LnN0YXRlLmRlc2NyaXB0b3IuY29kZSA9ICJPdXQtZm9yLWRlbGl2ZXJ5IjsKICAgICAgICBmdWxmaWxsbWVudC5zdGFydC50aW1lID0gewogICAgICAgICAgLi4uZnVsZmlsbG1lbnQuc3RhcnQudGltZSwKICAgICAgICAgIHRpbWVzdGFtcDogZGVmYXVsdFBheWxvYWQuY29udGV4dD8udGltZXN0YW1wLAogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIGZ1bGZpbGxtZW50OwogICAgfSk7CgogIGlmIChzZXNzaW9uRGF0YT8uYmlsbGluZykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5iaWxsaW5nID0gc2Vzc2lvbkRhdGEuYmlsbGluZ1swXTsKICB9CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIudXBkYXRlZF9hdCA9IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnF1b3RlID0gc2Vzc2lvbkRhdGEucXVvdGVbMF07CiAgaWYgKAogICAgQXJyYXkuaXNBcnJheShzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXMpICYmCiAgICBzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXMubGVuZ3RoID4gMAogICkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5jYW5jZWxsYXRpb25fdGVybXMgPQogICAgICBzZXNzaW9uRGF0YS5jYW5jZWxsYXRpb25fdGVybXNbMF07CiAgfQoKICBpZiAoc2Vzc2lvbkRhdGEucGF5bWVudCkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50ID0gc2Vzc2lvbkRhdGEucGF5bWVudFswXTsKICB9CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudC5zdGF0dXMgPSBnZXRQYXltZW50U3RhdHVzKAogICAgc2Vzc2lvbkRhdGEucGF5bWVudF90eXBlLAogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5zdGF0ZQogICk7CgogIGlmICgKICAgIHNlc3Npb25EYXRhLnBheW1lbnRfdHlwZSA9PT0gIk9OLUZVTEZJTExNRU5UIiAmJgogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5zdGF0ZSA9PT0gIkNvbXBsZXRlZCIKICApIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucGF5bWVudFsiQG9uZGMvb3JnL3NldHRsZW1lbnRfZGV0YWlscyJdID0gWwogICAgICB7CiAgICAgICAgLi4uZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50WwogICAgICAgICJAb25kYy9vcmcvc2V0dGxlbWVudF9kZXRhaWxzIgogICAgICAgIF1bMF0sCiAgICAgICAgc2V0dGxlbWVudF9zdGF0dXM6ICJQQUlEIiwKICAgICAgICBzZXR0bGVtZW50X3JlZmVyZW5jZTogIlhYWFhYWFhYWCIsCiAgICAgICAgc2V0dGxlbWVudF90aW1lc3RhbXA6IGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wLAogICAgICB9LAogICAgXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YT8uaXRlbXMpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSBzZXNzaW9uRGF0YS5pdGVtc1swXTsKICB9CgoKICBpZiAoc2Vzc2lvbkRhdGEubGlua2VkX29yZGVyKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyWyJAb25kYy9vcmcvbGlua2VkX29yZGVyIl0gPQogICAgICBzZXNzaW9uRGF0YS5saW5rZWRfb3JkZXJbMF07CiAgfQoKICBpZiAoc2Vzc2lvbkRhdGEub25fY29uZmlybV90YWdzKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnRhZ3MgPSBzZXNzaW9uRGF0YS5vbl9jb25maXJtX3RhZ3NbMF0KICB9CgogIHJldHVybiBkZWZhdWx0UGF5bG9hZDsKfQ==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_status
          timestamp: '2026-02-15T16:11:32.615Z'
          transaction_id: 84770f59-155f-4a91-85f0-2a97ecb314b5
          message_id: 0210df37-5962-4530-84e1-b760f7b7110d
          bap_id: sample-bap-id
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            id: 8355a0472eee42c8b470d4c2ae803104
            state: In-progress
            provider:
              id: DTDC
            items:
              - id: B2C SMART EXPRESS
                category_id: Standard Delivery
                fulfillment_id: '1'
                descriptor:
                  code: P2H2P
                time:
                  label: TAT
                  duration: P2D
                  timestamp: '2024-09-04'
            quote:
              price:
                currency: INR
                value: '77.00'
              breakup:
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '63.14'
                - '@ondc/org/item_id': B2C SMART EXPRESS
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '13.86'
            billing:
              name: Bizom
              email: ondchelp@mobisy.com
              phone: '9886193962'
              address:
                name: Bizom
                locality: Bellandur Main Rd
                city: Bengaluru
                state: Karnataka
                country: India
                building: Sri Arunachaleshwara Building
                area_code: '560103'
              tax_number: 29AAFCM4341L1Z6
              created_at: '2024-09-02T09:58:13.462Z'
              updated_at: '2024-09-02T09:58:13.462Z'
            payment:
              type: POST-FULFILLMENT
              collected_by: BAP
              '@ondc/org/settlement_details':
                - settlement_counterparty: seller-app
                  settlement_type: upi
                  upi_address: gft@oksbi
                  settlement_bank_account_no: '123456789123456'
                  settlement_ifsc_code: ICIC00001234
              status: NOT-PAID
            '@ondc/org/linked_order':
              items:
                - category_id: Grocery
                  descriptor:
                    name: >-
                      Surya Pickle Mirchi (Red Chilli) Powder 500g |Suitable for
                      Pickling
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 0.5
                  price:
                    currency: INR
                    value: '70.0'
              provider:
                address:
                  name: Shailja Rajput
                  locality: Central Jail Road Sarjapur
                  city: Bangalore
                  state: Karnataka
                  country: IND
                  building: Silverwood Regency Apartment
                  area_code: '560103'
                descriptor:
                  name: Bizom Mart
              order:
                id: 2024-09-02-361761
                weight:
                  unit: kilogram
                  value: 1
                dimensions:
                  length:
                    unit: centimeter
                    value: 8
                  breadth:
                    unit: centimeter
                    value: 10
                  height:
                    unit: centimeter
                    value: 12
            created_at: '2024-09-02T09:58:23.392Z'
            updated_at: '2024-09-02T11:50:39.079Z'
            fulfillments:
              - id: '1'
                type: Delivery
                '@ondc/org/awb_no': 7D2321487
                tracking: true
                start:
                  person:
                    name: Shailja Rajput
                  location:
                    gps: '12.927341,77.671691'
                    address:
                      name: Shailja Rajput
                      locality: Central Jail Road Sarjapur
                      city: Bangalore
                      state: Karnataka
                      country: IND
                      building: Silverwood Regency Apartment
                      area_code: '560103'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  time:
                    range:
                      start: '2024-09-02T10:05:00.639Z'
                      end: '2024-09-02T17:30:00.639Z'
                    timestamp: '2024-09-02T11:40:53.614Z'
                  instructions:
                    name: Proof Of Pickup
                    images:
                      - >-
                        https://shipsy-demo.s3.amazonaws.com/1/poc/2024-09-02/pickupcompleted/poc_z71y3c_1725277255498
                end:
                  person:
                    name: Delhi Address
                  location:
                    gps: '28.516106,77.114037'
                    address:
                      name: Delhi Address
                      locality: Avenue Jacaranda
                      city: New Delhi
                      state: Delhi
                      country: IND
                      building: Maheshwari Apartment
                      area_code: '110038'
                  contact:
                    phone: '7829222119'
                    email: shailja.rajput@mobisy.com
                  time:
                    range:
                      start: '2024-09-04T10:05:00.639Z'
                      end: '2024-09-04T17:30:00.639Z'
                tags:
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'yes'
                      - code: url
                        value: >-
                          https://testtrack.dtdc.com/ctbs-tracking/customerInterface.tr?submitName=showCITrackingDetails&cType=Consignment&cnNo=7D2321487
                state:
                  descriptor:
                    code: Out-for-delivery
                vehicle:
                  registration: HR1234
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        on_status_out_for_delivery_fulfillments: $.message.order.fulfillments
        order_updated_at_timestamp: $.message.order.updated_at
      inputs: {}
  - api: on_status
    action_id: on_status_order_delivered
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmlkID0gc2Vzc2lvbkRhdGEub3JkZXJfaWRbMF07CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wcm92aWRlci5pZCA9IHNlc3Npb25EYXRhLnByb3ZpZGVyX2lkWzBdOwogIGlmIChzZXNzaW9uRGF0YT8ub25fc3RhdHVzX291dF9mb3JfZGVsaXZlcnlfZnVsZmlsbG1lbnRzWzBdKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9IHNlc3Npb25EYXRhLm9uX3N0YXR1c19vdXRfZm9yX2RlbGl2ZXJ5X2Z1bGZpbGxtZW50c1swXTsKICB9CgoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnN0YXRlID0gIkNvbXBsZXRlZCI7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMgPQogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5mdWxmaWxsbWVudHMubWFwKChmdWxmaWxsbWVudCkgPT4gewogICAgICBpZiAoZnVsZmlsbG1lbnQudHlwZSA9PT0gIkRlbGl2ZXJ5IikgewogICAgICAgIGZ1bGZpbGxtZW50LnN0YXRlLmRlc2NyaXB0b3IuY29kZSA9ICJPcmRlci1kZWxpdmVyZWQiOwoKICAgICAgICBpZiAoIWZ1bGZpbGxtZW50LmVuZC50aW1lKSB7CiAgICAgICAgICBmdWxmaWxsbWVudC5lbmQudGltZSA9IHsKICAgICAgICAgICAgdGltZXN0YW1wOiBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LnRpbWVzdGFtcCwKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZ1bGZpbGxtZW50LmVuZC50aW1lLnRpbWVzdGFtcCA9CiAgICAgICAgICAgIGRlZmF1bHRQYXlsb2FkLmNvbnRleHQudGltZXN0YW1wOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZnVsZmlsbG1lbnQ7CiAgICB9KTsKCiAgaWYgKHNlc3Npb25EYXRhPy5iaWxsaW5nKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmJpbGxpbmcgPSBzZXNzaW9uRGF0YS5iaWxsaW5nWzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci51cGRhdGVkX2F0ID0gZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXA7CgogIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGUgPSBzZXNzaW9uRGF0YS5xdW90ZVswXTsKICBpZiAoCiAgICBBcnJheS5pc0FycmF5KHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcykgJiYKICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtcy5sZW5ndGggPiAwCiAgKSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmNhbmNlbGxhdGlvbl90ZXJtcyA9CiAgICAgIHNlc3Npb25EYXRhLmNhbmNlbGxhdGlvbl90ZXJtc1swXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YS5wYXltZW50KSB7CiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnQgPSBzZXNzaW9uRGF0YS5wYXltZW50WzBdOwogIH0KCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50LnN0YXR1cyA9IGdldFBheW1lbnRTdGF0dXMoCiAgICBzZXNzaW9uRGF0YS5wYXltZW50X3R5cGUsCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnN0YXRlCiAgKTsKCiAgaWYgKAogICAgc2Vzc2lvbkRhdGEucGF5bWVudF90eXBlID09PSAiT04tRlVMRklMTE1FTlQiICYmCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnN0YXRlID09PSAiQ29tcGxldGVkIgogICkgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50WyJAb25kYy9vcmcvc2V0dGxlbWVudF9kZXRhaWxzIl0gPSBbCiAgICAgIHsKICAgICAgICAuLi5kZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRbCiAgICAgICAgIkBvbmRjL29yZy9zZXR0bGVtZW50X2RldGFpbHMiCiAgICAgICAgXVswXSwKICAgICAgICBzZXR0bGVtZW50X3N0YXR1czogIlBBSUQiLAogICAgICAgIHNldHRsZW1lbnRfcmVmZXJlbmNlOiAiWFhYWFhYWFhYIiwKICAgICAgICBzZXR0bGVtZW50X3RpbWVzdGFtcDogZGVmYXVsdFBheWxvYWQuY29udGV4dC50aW1lc3RhbXAsCiAgICAgIH0sCiAgICBdOwogIH0KCiAgaWYgKHNlc3Npb25EYXRhPy5pdGVtcykgewogICAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlc3Npb25EYXRhLml0ZW1zWzBdOwogIH0KCgogIGlmIChzZXNzaW9uRGF0YS5saW5rZWRfb3JkZXIpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXJbIkBvbmRjL29yZy9saW5rZWRfb3JkZXIiXSA9CiAgICAgIHNlc3Npb25EYXRhLmxpbmtlZF9vcmRlclswXTsKICB9CgogIGlmIChzZXNzaW9uRGF0YS5vbl9jb25maXJtX3RhZ3MpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIudGFncyA9IHNlc3Npb25EYXRhLm9uX2NvbmZpcm1fdGFnc1swXQogIH0KCiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'nic2004:60232'
          action: on_status
          timestamp: '2026-02-15T17:26:00.759Z'
          transaction_id: 84770f59-155f-4a91-85f0-2a97ecb314b5
          message_id: 3a9c0368-dee1-4fa9-8762-b57f9d0ab1bd
          bap_id: sample-bap-id
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          order:
            '@ondc/org/linked_order':
              items:
                - category_id: F&B
                  descriptor:
                    name: Item1
                  price:
                    currency: INR
                    value: '70.00'
                  quantity:
                    count: 2
                    measure:
                      unit: kilogram
                      value: 1
                - category_id: F&B
                  descriptor:
                    name: Item2
                  price:
                    currency: INR
                    value: '160.00'
                  quantity:
                    count: 1
                    measure:
                      unit: kilogram
                      value: 1
              order:
                dimensions:
                  breadth:
                    unit: centimeter
                    value: 1
                  height:
                    unit: centimeter
                    value: 1
                  length:
                    unit: centimeter
                    value: 1
                id: O1
                weight:
                  unit: kilogram
                  value: 3
              provider:
                address:
                  area_code: '560001'
                  building: My building name 1
                  city: my city 1
                  locality: My street name 1
                  name: My store name 1
                  state: my state 1
                descriptor:
                  name: Seller1
            billing:
              address:
                area_code: '560076'
                building: My house or building name
                city: Bengaluru
                country: India
                locality: Jayanagar
                name: My house or building no
                state: Karnataka
              created_at: '2026-02-15T12:51:02.655Z'
              email: abcd.efgh@gmail.com
              name: ONDC Logistics Buyer NP
              phone: '9886098860'
              tax_number: AS34234HKJ342KH
              updated_at: '2026-02-15T12:51:02.655Z'
            fulfillments:
              - agent:
                  name: agent_name
                  phone: '9886098860'
                end:
                  contact:
                    email: xyz.qweq@gmail.com
                    phone: '9123426789'
                  location:
                    address:
                      area_code: '560001'
                      building: My building name 2
                      city: my city name 2
                      country: India
                      locality: My street name 2
                      name: 'My house or building #'
                      state: my state 2
                    gps: '12.4535,77.9283'
                  person:
                    name: person_name_2
                  time:
                    range:
                      end: '2026-02-18T00:51:03.425Z'
                      start: '2026-02-16T00:51:03.425Z'
                    timestamp: '2026-02-15T12:51:13.297Z'
                id: '1'
                start:
                  contact:
                    email: abcd.efgh@gmail.com
                    phone: '9886098860'
                  location:
                    address:
                      area_code: '560001'
                      building: My building name 1
                      city: my city 1
                      country: India
                      locality: My street name 1
                      name: My store name 1
                      state: my state 1
                    gps: '12.4535,77.9283'
                    id: S1
                  person:
                    name: person_name_1
                  time:
                    duration: PT12H
                    range:
                      end: '2026-02-16T00:51:03.425Z'
                      start: '2026-02-15T12:51:03.425Z'
                    timestamp: '2026-02-15T12:51:09.353Z'
                state:
                  descriptor:
                    code: Order-delivered
                tracking: true
                type: Delivery
                vehicle:
                  registration: 3LVJ945
            id: 989bb323-e5f5-4374-808f-45ebaad83472
            items:
              - category_id: Standard Delivery
                fulfillment_id: '1'
                id: I1
                time:
                  duration: P2D
                  label: TAT
                  timestamp: '2026-02-17'
            payment:
              '@ondc/org/settlement_basis': invoicing
              '@ondc/org/settlement_details':
                - beneficiary_name: xxxxx
                  settlement_bank_account_no: XXXXXXXXXX
                  settlement_counterparty: lsp
                  settlement_ifsc_code: XXXXXXXXX
                  settlement_type: upi
                  upi_address: gft@oksbi
              '@ondc/org/settlement_window': P15D
              collected_by: BAP
              status: NOT-PAID
              type: POST-FULFILLMENT
            provider:
              id: P1
            quote:
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': I1
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
              price:
                currency: INR
                value: '59.00'
            state: Completed
            tags:
              - code: bap_terms
                list:
                  - code: accept_bpp_terms
                    value: 'yes'
            updated_at: '2026-02-15T12:51:13.297Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
      inputs: {}
transaction_history:
  - action_id: search_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: search
        timestamp: '2026-02-17T10:33:43.322Z'
        transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
        message_id: 4b460cee-8fab-466d-b2f3-4095aae88ff0
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        intent:
          category:
            id: Immediate Delivery
          payment:
            type: POST-FULFILLMENT
          '@ondc/org/payload_details':
            weight:
              unit: kilogram
              value: 1
            value:
              currency: INR
              value: '388.5'
            dimensions:
              length:
                unit: meter
                value: 0.1
              breadth:
                unit: meter
                value: 0.1
              height:
                unit: meter
                value: 0.1
            category: F&B
          fulfillment:
            type: Delivery
            start:
              location:
                gps: '12.4535,77.9283'
                address:
                  area_code: '560001'
            end:
              location:
                gps: '12.4535,77.9283'
                address:
                  area_code: '560001'
          provider:
            time:
              days: '1,2,3,4,5,6,7'
              range:
                start: '0700'
                end: '2355'
              schedule:
                holidays:
                  - '2026-02-27'
                  - '2026-03-04'
              duration: PT10M
    action: search
    saved_info: {}
  - action_id: on_search_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: on_search
        timestamp: '2026-02-17T10:33:43.398Z'
        transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
        message_id: 4b460cee-8fab-466d-b2f3-4095aae88ff0
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        catalog:
          bpp/descriptor:
            name: LSP Aggregator Inc
            tags:
              - code: bpp_terms
                list:
                  - code: static_terms
                    value: ''
                  - code: static_terms_new
                    value: >-
                      https://github.com/ONDC-Official/NP-Static-Terms/lspNP_LSP/1.0/tc.pdf
                  - code: effective_date
                    value: '2026-02-17T10:33:43.398Z'
          bpp/providers:
            - id: P1
              descriptor:
                name: LSP Courier Inc
                short_desc: LSP Courier Inc
                long_desc: LSP Courier Inc
              categories:
                - id: Immediate Delivery
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-17'
              fulfillments:
                - id: '1'
                  type: Delivery
                  start:
                    time:
                      duration: PT15M
                  tags:
                    - code: distance
                      list:
                        - code: motorable_distance_type
                          value: kilometer
                        - code: motorable_distance
                          value: '1.8'
                - id: '2'
                  type: RTO
              locations:
                - id: L1
                  gps: '12.967555,77.749666'
                  address:
                    street: Jayanagar 4th Block
                    city: Bengaluru
                    area_code: '560076'
                    state: KA
              items:
                - id: I1
                  parent_item_id: ''
                  category_id: Immediate Delivery
                  fulfillment_id: '1'
                  descriptor:
                    code: P2P
                    name: Fast delivery
                    short_desc: Fast delivery
                    long_desc: Fast delivery
                  price:
                    currency: INR
                    value: '59.00'
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-17'
                - id: I2
                  parent_item_id: I1
                  category_id: Immediate Delivery
                  fulfillment_id: '2'
                  descriptor:
                    code: P2P
                    name: RTO quote
                    short_desc: RTO quote
                    long_desc: RTO quote
                  price:
                    currency: INR
                    value: '23.60'
                  time:
                    label: TAT
                    duration: PT60M
                    timestamp: '2026-02-17'
    action: on_search
    saved_info: {}
  - action_id: init_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: init
        timestamp: '2026-02-17T10:33:43.490Z'
        transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
        message_id: bfb73321-27be-47ea-ae6d-0ad1a47a9333
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        order:
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              category_id: Immediate Delivery
              descriptor:
                code: P2P
          fulfillments:
            - id: '1'
              type: Delivery
              start:
                location:
                  id: S1
                  gps: '12.4535,77.9283'
                  address:
                    name: My store name 1
                    building: My building name 1
                    locality: My street name 1
                    city: my city 1
                    state: my state 1
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: 'My house or building #'
                    building: My building name 2
                    locality: My street name 2
                    city: my city name 2
                    state: my state 2
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9123426789'
                  email: xyz.qweq@gmail.com
              tags: []
          billing:
            name: ONDC Logistics Buyer NP
            address:
              name: My house or building no
              building: My house or building name
              locality: Jayanagar
              city: Bengaluru
              state: Karnataka
              country: India
              area_code: '560076'
            tax_number: XXXXXXXXXXXXXXX
            phone: '9886098860'
            email: abcd.efgh@gmail.com
            created_at: '2026-02-17T10:33:43.490Z'
            updated_at: '2026-02-17T10:33:43.490Z'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
    action: init
    saved_info: {}
  - action_id: on_init_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: on_init
        timestamp: '2026-02-17T10:33:43.575Z'
        transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
        message_id: bfb73321-27be-47ea-ae6d-0ad1a47a9333
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.0
      message:
        order:
          provider:
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              descriptor:
                code: P2P
          fulfillments:
            - id: '1'
              type: Delivery
              start:
                location:
                  id: S1
                  gps: '12.4535,77.9283'
                  address:
                    name: My store name 1
                    building: My building name 1
                    locality: My street name 1
                    city: my city 1
                    state: my state 1
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: 'My house or building #'
                    building: My building name 2
                    locality: My street name 2
                    city: my city name 2
                    state: my state 2
                    country: India
                    area_code: '560001'
                contact:
                  phone: '9123426789'
                  email: xyz.qweq@gmail.com
              tags:
                - code: rider_check
                  list:
                    - code: inline_check_for_rider
                      value: 'yes'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '50.00'
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': tax
                price:
                  currency: INR
                  value: '9.00'
            ttl: PT15M
            price:
              currency: INR
              value: '59.00'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
          cancellation_terms:
            - fulfillment_state:
                descriptor:
                  code: Pending
                  short_desc: 008
              cancellation_fee:
                percentage: '0.00'
                amount:
                  currency: INR
                  value: '0.00'
            - fulfillment_state:
                descriptor:
                  code: Agent-assigned
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Order-picked-up
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Out-for-delivery
                  short_desc: '011,012,013,014,015'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
          tags:
            - code: bpp_terms
              list:
                - code: max_liability
                  value: '2'
                - code: max_liability_cap
                  value: '10000'
                - code: mandatory_arbitration
                  value: 'false'
                - code: court_jurisdiction
                  value: Bengaluru
                - code: delay_interest
                  value: '1000'
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/protocol-network-extension/discussions/79
    action: on_init
    saved_info: {}
  - action_id: confirm_1
    payload:
      context:
        domain: 'nic2004:60232'
        action: confirm
        timestamp: '2026-02-17T10:33:43.680Z'
        transaction_id: 9a0df1d8-b9cd-4864-9e30-d31021a53282
        message_id: 4a7438f6-b442-4c7e-92ab-8fbd1bc8a27b
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        order:
          id: fc9f2f9c-208e-4c8f-8a8b-10928f23913a
          state: Created
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: '1'
              category_id: Immediate Delivery
              descriptor:
                code: P2P
              time:
                label: TAT
                duration: PT60M
                timestamp: '2026-02-17'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '50.00'
              - '@ondc/org/item_id': I1
                '@ondc/org/title_type': tax
                price:
                  currency: INR
                  value: '9.00'
            price:
              currency: INR
              value: '59.00'
          fulfillments:
            - id: '1'
              type: Delivery
              '@ondc/org/awb_no': '1227262193237777'
              start:
                time:
                  duration: PT15M
                person:
                  name: person_name_1
                location:
                  gps: '12.4535445,77.9283792'
                  address:
                    name: Store name
                    building: House or building name
                    locality: Locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560041'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '2'
                  short_desc: '123123'
                  long_desc: additional instructions for pickup
                  additional_desc:
                    content_type: text/html
                    url: 'http://description.com'
              end:
                person:
                  name: person_name_2
                location:
                  gps: '12.453544,77.928379'
                  address:
                    name: 'My house #'
                    building: My house or building name
                    locality: locality
                    city: Bengaluru
                    state: Karnataka
                    country: India
                    area_code: '560076'
                contact:
                  phone: '9886098860'
                  email: abcd.efgh@gmail.com
                instructions:
                  code: '2'
                  short_desc: '987657'
                  long_desc: additional instructions for delivery
                  additional_desc:
                    content_type: text/html
                    url: 'http://description.com'
              tags:
                - code: state
                  list:
                    - code: ready_to_ship
                      value: 'yes'
                - code: rto_action
                  list:
                    - code: return_to_origin
                      value: 'yes'
          billing:
            name: ONDC Logistics Buyer NP
            address:
              name: My house or building no
              building: My house or building name
              locality: Jayanagar
              city: Bengaluru
              state: Karnataka
              country: India
              area_code: '560076'
            tax_number: XXXXXXXXXXXXXXX
            phone: '9886098860'
            email: abcd.efgh@gmail.com
            created_at: '2026-02-17T10:33:43.490Z'
            updated_at: '2026-02-17T10:33:43.490Z'
          payment:
            type: POST-FULFILLMENT
            collected_by: BAP
            '@ondc/org/settlement_basis': invoicing
            '@ondc/org/settlement_window': P15D
          '@ondc/org/linked_order':
            items:
              - category_id: F&B
                descriptor:
                  name: Item1
                quantity:
                  count: 2
                  measure:
                    unit: kilogram
                    value: 1
                price:
                  currency: INR
                  value: '70.00'
            provider:
              descriptor:
                name: Seller1
              address:
                name: My store name 1
                building: My building name 1
                locality: My street name 1
                city: my city 1
                state: my state 1
                area_code: '560001'
            order:
              id: O1
              weight:
                unit: kilogram
                value: 3
              dimensions:
                length:
                  unit: centimeter
                  value: 1
                breadth:
                  unit: centimeter
                  value: 1
                height:
                  unit: centimeter
                  value: 1
          tags:
            - code: bpp_terms
              list:
                - code: max_liability
                  value: '2'
                - code: max_liability_cap
                  value: '10000'
                - code: mandatory_arbitration
                  value: 'false'
                - code: court_jurisdiction
                  value: Bengaluru
                - code: delay_interest
                  value: '1000'
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/protocol-network-extension/discussions/79
            - code: bap_terms
              list:
                - code: accept_bpp_terms
                  value: 'Y'
          created_at: '2026-02-17T10:33:43.680Z'
          updated_at: '2026-02-17T10:33:43.680Z'
          cancellation_terms:
            - fulfillment_state:
                descriptor:
                  code: Pending
                  short_desc: 008
              cancellation_fee:
                percentage: '0.00'
                amount:
                  currency: INR
                  value: '0.00'
            - fulfillment_state:
                descriptor:
                  code: Agent-assigned
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Order-picked-up
                  short_desc: '001,003'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
            - fulfillment_state:
                descriptor:
                  code: Out-for-delivery
                  short_desc: '011,012,013,014,015'
              cancellation_fee:
                percentage: '100.00'
                amount:
                  currency: INR
                  value: '50.00'
    action: confirm
    saved_info: {}
validationLib: ''
helperLib: >-
  LyoKICBDdXN0b20gaGVscGVyIGZ1bmN0aW9ucyBhdmFpbGFibGUgaW4gYWxsIG1vY2sgZ2VuZXJhdGlvbiBmdW5jdGlvbnMuCiAgdGhlc2UgYXJlIGFwcGVuZGVkIGJlbG93IHRoZSBnZW5lcmF0ZSBmdW5jdGlvbiBmb3IgZWFjaCBzdGVwLgoqLwoKLy8gR2VuZXJhdGVzIGEgVVVJRCB2NApmdW5jdGlvbiB1dWlkdjQoKSB7CiAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHsKICAgIGNvbnN0IHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwOwogICAgY29uc3QgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7CiAgICByZXR1cm4gdi50b1N0cmluZygxNik7CiAgfSk7Cn0KCi8vIEdlbmVyYXRlIGEgNiBkaWdpdCBzdHJpbmcgSUQKZnVuY3Rpb24gZ2VuZXJhdGU2RGlnaXRJZCgpIHsKICByZXR1cm4gTWF0aC5mbG9vcigxMDAwMDAgKyBNYXRoLnJhbmRvbSgpICogOTAwMDAwKS50b1N0cmluZygpOwp9CgovLyBSZXR1cm5zIHRoZSBjdXJyZW50IElTTyB0aW1lc3RhbXAKZnVuY3Rpb24gY3VycmVudFRpbWVzdGFtcCgpIHsKICByZXR1cm4gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOwp9CgovLyBDb252ZXJ0cyBJU08gODYwMSBkdXJhdGlvbiBzdHJpbmcgdG8gdG90YWwgc2Vjb25kcwpjb25zdCBpc29EdXJUb1NlYyA9IChkdXJhdGlvbikgPT4gewogIGNvbnN0IGR1clJFID0gL1AoKGQrKVkpPygoZCspTSk/KChkKylXKT8oKGQrKUQpP1Q/KChkKylIKT8oKGQrKU0pPygoZCspUyk/LzsKICBjb25zdCBzID0gZHVyUkUuZXhlYyhkdXJhdGlvbik7CiAgaWYgKCFzKSByZXR1cm4gMDsKCiAgcmV0dXJuIChOdW1iZXIocz8uWzJdKSB8fCAwKSAqIDMxNTM2MDAwICsKICAgIChOdW1iZXIocz8uWzRdKSB8fCAwKSAqIDI2MjgyODggKwogICAgKE51bWJlcihzPy5bNl0pIHx8IDApICogNjA0ODAwICsKICAgIChOdW1iZXIocz8uWzhdKSB8fCAwKSAqIDg2NDAwICsKICAgIChOdW1iZXIocz8uWzEwXSkgfHwgMCkgKiAzNjAwICsKICAgIChOdW1iZXIocz8uWzEyXSkgfHwgMCkgKiA2MCArCiAgICAoTnVtYmVyKHM/LlsxNF0pIHx8IDApOwp9OwoKCmZ1bmN0aW9uIGRlbGF5KG1zKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7Cn0KCmZ1bmN0aW9uIGdldFRpbWVzdGFtcEZyb21EdXJhdGlvbigKICBkYXRlLAogIGR1cmF0aW9uCikgewogIGNvbnNvbGUubG9nKCJkdXJhdGlvTiIsIGR1cmF0aW9uKTsKICBjb25zdCBkdXJhdGlvblJlZ2V4ID0gL1AoPzooXGQrKUQpPyg/OlQoPzooXGQrKUgpPyg/OihcZCspTSk/KD86KFxkKylTKT8pPy87CiAgY29uc3QgbWF0Y2ggPSBkdXJhdGlvbi5tYXRjaChkdXJhdGlvblJlZ2V4KTsKCiAgaWYgKCFtYXRjaCkgewogICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIElTTyA4NjAxIGR1cmF0aW9uIGZvcm1hdCIpOwogIH0KCiAgY29uc3QgZGF5cyA9IG1hdGNoWzFdID8gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKSB8fCAwIDogMDsKICBjb25zdCBob3VycyA9IG1hdGNoWzJdID8gcGFyc2VJbnQobWF0Y2hbMl0sIDEwKSB8fCAwIDogMDsKICBjb25zdCBtaW51dGVzID0gbWF0Y2hbM10gPyBwYXJzZUludChtYXRjaFszXSwgMTApIHx8IDAgOiAwOwogIGNvbnN0IHNlY29uZHMgPSBtYXRjaFs0XSA/IHBhcnNlSW50KG1hdGNoWzRdLCAxMCkgfHwgMCA6IDA7CgogIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZShkYXRlKTsKICBmdXR1cmVEYXRlLnNldERhdGUoZnV0dXJlRGF0ZS5nZXREYXRlKCkgKyBkYXlzKTsKICBmdXR1cmVEYXRlLnNldEhvdXJzKGZ1dHVyZURhdGUuZ2V0SG91cnMoKSArIGhvdXJzKTsKICBmdXR1cmVEYXRlLnNldE1pbnV0ZXMoZnV0dXJlRGF0ZS5nZXRNaW51dGVzKCkgKyBtaW51dGVzKTsKICBmdXR1cmVEYXRlLnNldFNlY29uZHMoZnV0dXJlRGF0ZS5nZXRTZWNvbmRzKCkgKyBzZWNvbmRzKTsKCiAgcmV0dXJuIGZ1dHVyZURhdGUudG9JU09TdHJpbmcoKTsKfQoKZnVuY3Rpb24gcmVtb3ZlVGFnc0J5Q29kZXModGFncywgY29kZXNUb1JlbW92ZSkgewogIHJldHVybiB0YWdzLmZpbHRlcigodGFnKSA9PiAhY29kZXNUb1JlbW92ZS5pbmNsdWRlcyh0YWcuY29kZSkpOwp9CgpmdW5jdGlvbiBnZXRGdXR1cmVEYXRlKGRheXNBaGVhZCkgewogIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZSgpOwogIGZ1dHVyZURhdGUuc2V0RGF0ZShmdXR1cmVEYXRlLmdldERhdGUoKSArIGRheXNBaGVhZCk7CgogIHJldHVybiBmdXR1cmVEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoIlQiKVswXTsKfQoKZnVuY3Rpb24gaXNFbXB0eShvYmopIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7Cn0KCmNvbnN0IGdldEZ1dHVyZURhdGVJbk1pbnV0ZXMgPSAobWludXRlcykgPT4gewogIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgY29uc3QgZnV0dXJlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSArIG1pbnV0ZXMgKiA2MCAqIDEwMDApOwogIHJldHVybiBmdXR1cmUudG9JU09TdHJpbmcoKTsKfTsKLy8gZnVuY3Rpb24gZ2V0T3JkZXJQcmVwVGltZShjYXRlZ29yeSkgewovLyAgIGNvbnN0IFRhdE1hcHBpbmcgPSB7Ci8vICAgICAiSW1tZWRpYXRlIERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUFQ2ME0iLAovLyAgICAgICBkYXk6IDAsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQVDE1TSIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDEwTSIsCi8vICAgICB9LAovLyAgICAgIlNhbWUgRGF5IERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUFQ0SCIsCi8vICAgICAgIGRheTogMCwKLy8gICAgICAgcGlja3VwVGltZTogIlBUMUgiLAovLyAgICAgICBvcmRlclByZXBUaW1lOiAiUFQxSCIsCi8vICAgICB9LAovLyAgICAgIk5leHQgRGF5IERlbGl2ZXJ5IjogewovLyAgICAgICBjb2RlOiAiUDFEIiwKLy8gICAgICAgZGF5OiAxLAovLyAgICAgICBwaWNrdXBUaW1lOiAiUFQ0SCIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDRIIiwKLy8gICAgIH0sCi8vICAgICAiU3RhbmRhcmQgRGVsaXZlcnkiOiB7Ci8vICAgICAgIGNvZGU6ICJQMkQiLAovLyAgICAgICBkYXk6IDIsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQVDEySCIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDEySCIsCi8vICAgICB9LAovLyAgICAgIkV4cHJlc3MgRGVsaXZlcnkiOiB7Ci8vICAgICAgIGNvZGU6ICJQM0QiLAovLyAgICAgICBkYXk6IDIsCi8vICAgICAgIHBpY2t1cFRpbWU6ICJQMUQiLAovLyAgICAgICBvcmRlclByZXBUaW1lOiAiUDFEIiwKLy8gICAgIH0sCi8vICAgICAiSW5zdGFudCBEZWxpdmVyeSI6IHsKLy8gICAgICAgY29kZTogIlBUMTBNIiwKLy8gICAgICAgZGF5OiAwLAovLyAgICAgICBwaWNrdXBUaW1lOiAiUFQyTSIsCi8vICAgICAgIG9yZGVyUHJlcFRpbWU6ICJQVDJNIiwKLy8gICAgIH0sCi8vICAgfTsKLy8gICByZXR1cm4gVGF0TWFwcGluZ1tjYXRlZ29yeV0/Lm9yZGVyUHJlcFRpbWUgfHwgbnVsbDsKLy8gfTsKCgpjb25zdCBnZW5lcmF0ZVF1b3RlVHJhaWwgPSAoCiAgYnJlYWt1cCwKICBpdGVtcywKICBvcHRpb25zLAogIHBhcmVudEl0ZW1JZAopID0+IHsKICBjb25zdCB7CiAgICBmdWxmaWxsbWVudFN0YXRlID0gIlBSRSIsCiAgICBpc1JUTyA9IGZhbHNlLAogICAgcGFydENhbmNlbCA9IGZhbHNlLAogIH0gPSBvcHRpb25zOwogIGNvbnN0IHF1b3RlVHJhaWxUYWdzID0gW107CgogIGZ1bmN0aW9uIGV4dHJhY3RUeXBlKHRhZ3MpIHsKICAgIGNvbnN0IHR5cGVUYWcgPSB0YWdzLmZpbmQoKHRhZykgPT4gdGFnLmNvZGUgPT09ICJ0eXBlIik7CiAgICBpZiAoIXR5cGVUYWcgfHwgIXR5cGVUYWcubGlzdCkgcmV0dXJuIG51bGw7CgogICAgY29uc3QgdHlwZUl0ZW0gPSB0eXBlVGFnLmxpc3QuZmluZCgoaXRlbSkgPT4gaXRlbS5jb2RlID09PSAidHlwZSIpOwogICAgcmV0dXJuIHR5cGVJdGVtID8gdHlwZUl0ZW0udmFsdWUgOiBudWxsOwogIH0KCiAgYnJlYWt1cC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICBpZiAoCiAgICAgIGl0ZW1bIkBvbmRjL29yZy90aXRsZV90eXBlIl0gPT09ICJkZWxpdmVyeSIgfHwKICAgICAgaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSA9PT0gInBhY2tpbmciCiAgICApIHsKICAgICAgaWYgKGZ1bGZpbGxtZW50U3RhdGUgPT09ICJQUkUiICYmICFwYXJ0Q2FuY2VsKSB7CiAgICAgICAgcXVvdGVUcmFpbFRhZ3MucHVzaCh7CiAgICAgICAgICBjb2RlOiAicXVvdGVfdHJhaWwiLAogICAgICAgICAgbGlzdDogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogInR5cGUiLAogICAgICAgICAgICAgIHZhbHVlOiBpdGVtWyJAb25kYy9vcmcvdGl0bGVfdHlwZSJdLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogImlkIiwKICAgICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL2l0ZW1faWQiXSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgICAgICAgICAgICAgdmFsdWU6ICJJTlIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29kZTogInZhbHVlIiwKICAgICAgICAgICAgICB2YWx1ZTogYC0ke2l0ZW0ucHJpY2UudmFsdWV9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSA9PT0gIm9mZmVyIikgewogICAgICBxdW90ZVRyYWlsVGFncy5wdXNoKHsKICAgICAgICBjb2RlOiAicXVvdGVfdHJhaWwiLAogICAgICAgIGxpc3Q6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogInR5cGUiLAogICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJpZCIsCiAgICAgICAgICAgIHZhbHVlOiBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogImN1cnJlbmN5IiwKICAgICAgICAgICAgdmFsdWU6ICJJTlIiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29kZTogInZhbHVlIiwKICAgICAgICAgICAgdmFsdWU6IGAke01hdGguYWJzKHBhcnNlSW50KGl0ZW0ucHJpY2UudmFsdWUpKX1gLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoCiAgICAgIHBhcnNlSW50KGl0ZW0ucHJpY2UudmFsdWUpICE9PSAwICYmCiAgICAgICghcGFyZW50SXRlbUlkIHx8IGl0ZW0/Lml0ZW0/LnBhcmVudF9pdGVtX2lkID09PSBwYXJlbnRJdGVtSWQpCiAgICApIHsKICAgICAgY29uc29sZS5sb2coIml0ZW1zOiIsIGl0ZW1zKTsKICAgICAgY29uc29sZS5sb2coIml0ZW17YXNkYXMiLCBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdKTsKCiAgICAgIGNvbnN0IHRhZ3MgPSBpdGVtcy5maW5kKAogICAgICAgIChhbGxJdGVtKSA9PiBhbGxJdGVtLmlkID09PSBpdGVtWyJAb25kYy9vcmcvaXRlbV9pZCJdCiAgICAgICkudGFnczsKICAgICAgY29uc3Qgc3ViVHlwZSA9IGV4dHJhY3RUeXBlKHRhZ3MpOwoKICAgICAgcXVvdGVUcmFpbFRhZ3MucHVzaCh7CiAgICAgICAgY29kZTogInF1b3RlX3RyYWlsIiwKICAgICAgICBsaXN0OiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJ0eXBlIiwKICAgICAgICAgICAgdmFsdWU6IGl0ZW1bIkBvbmRjL29yZy90aXRsZV90eXBlIl0sCiAgICAgICAgICB9LAogICAgICAgICAgLi4uKHN1YlR5cGUKICAgICAgICAgICAgPyBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29kZTogInN1YnR5cGUiLAogICAgICAgICAgICAgICAgdmFsdWU6IHN1YlR5cGUsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXQogICAgICAgICAgICA6IFtdKSwKCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJwYXJlbnRfaXRlbV9pZCIsCiAgICAgICAgICAgIHZhbHVlOiBpdGVtLml0ZW0ucGFyZW50X2l0ZW1faWQsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBjb2RlOiAiaWQiLAogICAgICAgICAgICB2YWx1ZTogaXRlbVsiQG9uZGMvb3JnL2l0ZW1faWQiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgICAgICAgICAgIHZhbHVlOiAiSU5SIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJ2YWx1ZSIsCiAgICAgICAgICAgIHZhbHVlOiBgLSR7aXRlbS5wcmljZS52YWx1ZX1gLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9KTsKICAgIH0KICB9KTsKCiAgLy8gaWYgKGlzUlRPKSB7CiAgLy8gICBxdW90ZVRyYWlsVGFncy5wdXNoKHsKICAvLyAgICAgY29kZTogInF1b3RlX3RyYWlsIiwKICAvLyAgICAgbGlzdDogWwogIC8vICAgICAgIHsKICAvLyAgICAgICAgIGNvZGU6ICJ0eXBlIiwKICAvLyAgICAgICAgIHZhbHVlOiAiZGVsaXZlcnkiLAogIC8vICAgICAgIH0sCiAgLy8gICAgICAgewogIC8vICAgICAgICAgY29kZTogImlkIiwKICAvLyAgICAgICAgIHZhbHVlOiAiRjEtUlRPIiwKICAvLyAgICAgICB9LAogIC8vICAgICAgIHsKICAvLyAgICAgICAgIGNvZGU6ICJjdXJyZW5jeSIsCiAgLy8gICAgICAgICB2YWx1ZTogIklOUiIsCiAgLy8gICAgICAgfSwKICAvLyAgICAgICB7CiAgLy8gICAgICAgICBjb2RlOiAidmFsdWUiLAogIC8vICAgICAgICAgdmFsdWU6IGA1MGAsCiAgLy8gICAgICAgfSwKICAvLyAgICAgXSwKICAvLyAgIH0pOwogIC8vIH0KCiAgcmV0dXJuIHF1b3RlVHJhaWxUYWdzOwp9OwoKZnVuY3Rpb24gcmVzZXRRdW90ZVByaWNlcyhxdW90ZSkgewogIC8vIEEgaGVscGVyIHRvIGNvbnZlcnQgYW55IHByaWNlIHZhbHVlIGludG8gemVybyB3aXRoIHNhbWUgZGVjaW1hbCBmb3JtYXQKICBjb25zdCB0b1plcm9Gb3JtYXR0ZWQgPSAodmFsdWUpID0+IHsKICAgIGNvbnN0IGRlY2ltYWxzID0gdmFsdWUuaW5jbHVkZXMoIi4iKSA/IHZhbHVlLnNwbGl0KCIuIilbMV0ubGVuZ3RoIDogMDsKICAgIHJldHVybiAoMCkudG9GaXhlZChkZWNpbWFscyk7CiAgfTsKCiAgcmV0dXJuIHsKICAgIC4uLnF1b3RlLAogICAgYnJlYWt1cDogcXVvdGUuYnJlYWt1cC5tYXAoKGl0ZW0pID0+ICh7CiAgICAgIC4uLml0ZW0sCiAgICAgIHByaWNlOiB7CiAgICAgICAgLi4uaXRlbS5wcmljZSwKICAgICAgICB2YWx1ZTogdG9aZXJvRm9ybWF0dGVkKGl0ZW0ucHJpY2UudmFsdWUpCiAgICAgIH0KICAgIH0pKSwKICAgIHByaWNlOiB7CiAgICAgIC4uLnF1b3RlLnByaWNlLAogICAgICB2YWx1ZTogdG9aZXJvRm9ybWF0dGVkKHF1b3RlLnByaWNlLnZhbHVlKQogICAgfQogIH07Cn0KCmZ1bmN0aW9uIG1lcmdlRnVsZmlsbG1lbnRUYWdzKAogIGV4aXN0aW5nVGFncyA9IFtdLAogIG5ld1RhZ3MgPSBbXQopIHsKICBjb25zdCBtZXJnZWQgPSBbXTsKCiAgLy8gUGljayBMQVNUIG9jY3VycmVuY2UgZnJvbSBuZXdUYWdzIChhdXRob3JpdGF0aXZlKQogIGNvbnN0IG5ld0xpbmtlZE9yZGVyID0gWy4uLm5ld1RhZ3NdCiAgICAucmV2ZXJzZSgpCiAgICAuZmluZCh0ID0+IHQuY29kZSA9PT0gImxpbmtlZF9vcmRlciIpOwoKICBjb25zdCBuZXdMaW5rZWRQcm92aWRlciA9IFsuLi5uZXdUYWdzXQogICAgLnJldmVyc2UoKQogICAgLmZpbmQodCA9PiB0LmNvZGUgPT09ICJsaW5rZWRfcHJvdmlkZXIiKTsKCiAgbGV0IGxpbmtlZE9yZGVyQWRkZWQgPSBmYWxzZTsKICBsZXQgbGlua2VkUHJvdmlkZXJBZGRlZCA9IGZhbHNlOwoKICAvLyAx77iP4oOjIFByb2Nlc3MgZXhpc3RpbmcgdGFncwogIGZvciAoY29uc3QgdGFnIG9mIGV4aXN0aW5nVGFncykgewogICAgaWYgKHRhZy5jb2RlID09PSAibGlua2VkX29yZGVyIikgewogICAgICBpZiAoIWxpbmtlZE9yZGVyQWRkZWQpIHsKICAgICAgICBtZXJnZWQucHVzaChuZXdMaW5rZWRPcmRlciA/PyB0YWcpOwogICAgICAgIGxpbmtlZE9yZGVyQWRkZWQgPSB0cnVlOwogICAgICB9CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmICh0YWcuY29kZSA9PT0gImxpbmtlZF9wcm92aWRlciIpIHsKICAgICAgaWYgKCFsaW5rZWRQcm92aWRlckFkZGVkKSB7CiAgICAgICAgbWVyZ2VkLnB1c2gobmV3TGlua2VkUHJvdmlkZXIgPz8gdGFnKTsKICAgICAgICBsaW5rZWRQcm92aWRlckFkZGVkID0gdHJ1ZTsKICAgICAgfQogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBtZXJnZWQucHVzaCh0YWcpOwogIH0KCiAgLy8gMu+4j+KDoyBBZGQgbWlzc2luZyBzaW5nbGV0b24gdGFncwogIGlmIChuZXdMaW5rZWRPcmRlciAmJiAhbGlua2VkT3JkZXJBZGRlZCkgewogICAgbWVyZ2VkLnB1c2gobmV3TGlua2VkT3JkZXIpOwogIH0KCiAgaWYgKG5ld0xpbmtlZFByb3ZpZGVyICYmICFsaW5rZWRQcm92aWRlckFkZGVkKSB7CiAgICBtZXJnZWQucHVzaChuZXdMaW5rZWRQcm92aWRlcik7CiAgfQoKICAvLyAz77iP4oOjIEFkZCBOT04tc2luZ2xldG9uIG5ldyB0YWdzIChkZWR1cC1zYWZlKQogIGZvciAoY29uc3QgdGFnIG9mIG5ld1RhZ3MpIHsKICAgIGlmICgKICAgICAgdGFnLmNvZGUgIT09ICJsaW5rZWRfb3JkZXIiICYmCiAgICAgIHRhZy5jb2RlICE9PSAibGlua2VkX3Byb3ZpZGVyIgogICAgKSB7CiAgICAgIG1lcmdlZC5wdXNoKHRhZyk7CiAgICB9CiAgfQoKICByZXR1cm4gbWVyZ2VkOwp9Cgpjb25zdCBnZXRQYXltZW50U3RhdHVzID0gKHBheW1lbnRUeXBlLCBvcmRlclN0YXRlKSA9PiB7CiAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tRlVMRklMTE1FTlQiICYmIG9yZGVyU3RhdGUgPT09ICJDb21wbGV0ZWQiKSB7CiAgICByZXR1cm4gIlBBSUQiOwogIH0KCiAgaWYgKHBheW1lbnRUeXBlID09PSAiT04tT1JERVIiKSB7CiAgICByZXR1cm4gIlBBSUQiOwogIH0KCiAgaWYgKHBheW1lbnRUeXBlID09PSAiUE9TVC1GVUxGSUxMTUVOVCIpIHsKICAgIHJldHVybiAiTk9ULVBBSUQiOwogIH0KCiAgcmV0dXJuICJOT1QtUEFJRCI7Cn07CgpmdW5jdGlvbiByZXNldFF1b3RlUHJpY2VzKHF1b3RlKSB7CiAgLy8gQSBoZWxwZXIgdG8gY29udmVydCBhbnkgcHJpY2UgdmFsdWUgaW50byB6ZXJvIHdpdGggc2FtZSBkZWNpbWFsIGZvcm1hdAogIGNvbnN0IHRvWmVyb0Zvcm1hdHRlZCA9ICh2YWx1ZSkgPT4gewogICAgY29uc3QgZGVjaW1hbHMgPSB2YWx1ZS5pbmNsdWRlcygiLiIpID8gdmFsdWUuc3BsaXQoIi4iKVsxXS5sZW5ndGggOiAwOwogICAgcmV0dXJuICgwKS50b0ZpeGVkKGRlY2ltYWxzKTsKICB9OwoKICByZXR1cm4gewogICAgLi4ucXVvdGUsCiAgICBicmVha3VwOiBxdW90ZS5icmVha3VwLm1hcCgoaXRlbSkgPT4gKHsKICAgICAgLi4uaXRlbSwKICAgICAgcHJpY2U6IHsKICAgICAgICAuLi5pdGVtLnByaWNlLAogICAgICAgIHZhbHVlOiB0b1plcm9Gb3JtYXR0ZWQoaXRlbS5wcmljZS52YWx1ZSkKICAgICAgfQogICAgfSkpLAogICAgcHJpY2U6IHsKICAgICAgLi4ucXVvdGUucHJpY2UsCiAgICAgIHZhbHVlOiB0b1plcm9Gb3JtYXR0ZWQocXVvdGUucHJpY2UudmFsdWUpCiAgICB9CiAgfTsKfQoKZnVuY3Rpb24gY2FsY3VsYXRlUXVvdGVQcmljZShicmVha3VwKSB7CiAgbGV0IHRvdGFsUHJpY2UgPSAwOwogIGJyZWFrdXAuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgdG90YWxQcmljZSArPSBwYXJzZUZsb2F0KGl0ZW0ucHJpY2UudmFsdWUpIHx8IDA7CiAgfSk7CgogIHJldHVybiB0b3RhbFByaWNlLnRvRml4ZWQoMik7IC8vIHJldHVybnMgYSBzdHJpbmcgd2l0aCAyIGRlY2ltYWwgcGxhY2VzCn07Cg==
